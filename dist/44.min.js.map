{"version":3,"file":"44.min.js","sources":["webpack:///./src/pages/role-user/form/index.jsx"],"sourcesContent":["import _extends from \"@babel/runtime/helpers/extends\";\nimport \"@arco-design/web-react/es/Button/style\";\nimport _Button from \"@arco-design/web-react/es/Button\";\nimport \"@arco-design/web-react/es/Message/style\";\nimport _Message from \"@arco-design/web-react/es/Message\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport \"@arco-design/web-react/es/Select/style\";\nimport _Select from \"@arco-design/web-react/es/Select\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport \"@arco-design/web-react/es/Form/style\";\nimport _Form from \"@arco-design/web-react/es/Form\";\nvar _jsxFileName = \"/Users/mrhh/Desktop/gbs-admin/src/pages/role-user/form/index.jsx\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useRef, useEffect, useState } from 'react';\nimport { addGame, updateShop, regionsList } from '../../../api/drama.js';\nvar FormItem = _Form.Item;\nvar formItemLayout = {\n  labelCol: {\n    span: 7\n  },\n  wrapperCol: {\n    span: 17\n  }\n};\nvar noLabelLayout = {\n  wrapperCol: {\n    span: 17,\n    offset: 7\n  }\n};\n\nfunction FormDom(_ref) {\n  var closeModalAndReqTable = _ref.closeModalAndReqTable,\n      userListData = _ref.userListData,\n      clickItem = _ref.clickItem;\n  var formRef = useRef();\n\n  var _useState = useState('default'),\n      _useState2 = _slicedToArray(_useState, 2),\n      size = _useState2[0],\n      setSize = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      cascaderOptionsArr = _useState4[0],\n      setcascaderOptionsArr = _useState4[1];\n\n  console.log(clickItem);\n  useEffect(function () {\n    formRef.current.setFieldsValue(clickItem);\n  }, []);\n  console.log(userListData);\n\n  var onValuesChange = function onValuesChange(changeValue, values) {\n    console.log('onValuesChange: ', changeValue, values);\n  };\n\n  useEffect(function () {\n    var regionsData = regionsList();\n    regionsData.then(function (res) {\n      console.log('res: ', res);\n      var data = res.data;\n\n      var mapTree = function mapTree(org) {\n        var haveChildren = Array.isArray(org.region_children) && org.region_children.length > 0;\n        return {\n          key: String(org.region_id),\n          value: String(org.region_id),\n          label: org.region_name,\n          children: haveChildren ? org.region_children.map(function (i) {\n            return mapTree(i);\n          }) : []\n        };\n      };\n\n      var arr = [];\n      arr = data.map(function (org) {\n        return mapTree(org);\n      });\n      console.log(arr);\n      setcascaderOptionsArr(arr);\n    });\n  }, []); // regionsList\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      maxWidth: 650\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(_Form, _extends({\n    ref: formRef\n  }, formItemLayout, {\n    size: size,\n    onSubmit: function onSubmit(e) {\n      console.log(e);\n    },\n    onValuesChange: onValuesChange,\n    scrollToFirstError: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(FormItem, {\n    field: \"user_list\",\n    label: \"\\u6DFB\\u52A0\\u7528\\u6237\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(_Select, {\n    filterOption: function filterOption(inputValue, option) {\n      return option.props.value.toLowerCase().indexOf(inputValue.toLowerCase()) >= 0 || option.props.children.toLowerCase().indexOf(inputValue.toLowerCase()) >= 0;\n    },\n    showSearch: true,\n    allowClear: true,\n    mode: \"multiple\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 11\n    }\n  }, userListData.map(function (item) {\n    return /*#__PURE__*/React.createElement(_Select.Option, {\n      key: item.user_account,\n      value: item.user_account,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 17\n      }\n    }, item.user_name);\n  }))), /*#__PURE__*/React.createElement(FormItem, _extends({}, noLabelLayout, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(_Button, {\n    onClick: /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var data, param;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (!formRef.current) {\n                _context.next = 25;\n                break;\n              }\n\n              _context.prev = 1;\n              _context.next = 4;\n              return formRef.current.validate();\n\n            case 4:\n              if (!(clickItem === null)) {\n                _context.next = 11;\n                break;\n              }\n\n              console.log(formRef.current.getFields());\n              _context.next = 8;\n              return addGame(formRef.current.getFields());\n\n            case 8:\n              data = _context.sent;\n              _context.next = 17;\n              break;\n\n            case 11:\n              param = formRef.current.getFields();\n              console.log('param: ', param);\n              param.store_code = clickItem.store_code;\n              _context.next = 16;\n              return updateShop(param);\n\n            case 16:\n              data = _context.sent;\n\n            case 17:\n              if (data.code === 200) {\n                _Message.success('添加成功');\n\n                closeModalAndReqTable();\n              }\n\n              _context.next = 25;\n              break;\n\n            case 20:\n              _context.prev = 20;\n              _context.t0 = _context[\"catch\"](1);\n              console.log(_context.t0);\n              console.log(formRef.current.getFieldsError());\n\n              _Message.error('校验失败，请检查字段！');\n\n            case 25:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[1, 20]]);\n    })),\n    type: \"primary\",\n    style: {\n      marginRight: 24\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 11\n    }\n  }, \"\\u63D0\\u4EA4\"), /*#__PURE__*/React.createElement(_Button, {\n    onClick: function onClick() {\n      formRef.current.resetFields();\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 11\n    }\n  }, \"\\u91CD\\u7F6E\"))));\n}\n\nexport default FormDom;"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}