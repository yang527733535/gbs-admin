(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{184:function(e,r,n){"use strict";n.r(r);n(111);var t=n(45),a=n(5),l=n.n(a),c=(n(154),n(82)),u=(n(64),n(24)),m=n(653),o=(n(112),n(39)),i=(n(326),n(247)),s=(n(155),n(74)),b=(n(244),n(96)),f=(n(190),n(89)),N=n(65),_=n.n(N),d=n(22),p=n.n(d),g=(n(243),n(73)),h=n(44),E=n.n(h),y=n(0),v=n.n(y),O=n(242),j=n(83),w=n(173),k=n.n(w),S="/Users/mrhh/Desktop/gbs-admin/src/pages/store-game/form/index.jsx",x=g.a.Item,C={labelCol:{span:7},wrapperCol:{span:17}},I={wrapperCol:{span:17,offset:7}};r.default=function(e){var r=e.closeModalAndReqTable,n=e.clickItem,a=Object(y.useRef)(),N=Object(y.useState)([]),d=p()(N,2),h=d[0],w=d[1],F=Object(y.useState)(!0),q=p()(F,2),D=q[0],P=q[1],R=Object(y.useState)([]),V=p()(R,2),z=(V[0],V[1]),L=Object(y.useState)([]),A=p()(L,2),H=A[0],J=A[1],M=Object(y.useState)(!1),T=p()(M,2),W=T[0],B=T[1],U=Object(y.useState)([]),G=p()(U,2),K=G[0],Q=G[1],X=Object(y.useState)(!1),Y=p()(X,2),Z=Y[0],$=Y[1],ee=Object(y.useState)([]),re=p()(ee,2),ne=re[0],te=re[1],ae=Object(y.useState)(!1),le=p()(ae,2),ce=le[0],ue=le[1],me=Object(y.useRef)(null);Object(y.useEffect)((function(){a.current.setFieldsValue(n)}),[]),Object(y.useEffect)((function(){Object(O.u)().then((function(e){var r,n=e.data;r=n.map((function(e){return function e(r){var n=Array.isArray(r.region_children)&&r.region_children.length>0;return{key:String(r.region_id),value:String(r.region_id),label:r.region_name,children:n?r.region_children.map((function(r){return e(r)})):[]}}(e)})),z(r)}))}),[]);var oe=function(){var e=_()(E.a.mark((function e(){var r,n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(O.I)();case 2:r=e.sent,n=r.data,P(!1),w(n);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(y.useEffect)((function(){oe()}),[]);var ie=Object(y.useCallback)(k()((function(e){me.current=Date.now(),B(!0),J([]);var r={gb_title:e};Object(O.n)(r).then((function(e){var r=e.data.map((function(e){return{label:v.a.createElement("div",{style:{display:"flex",alignItems:"center"},__source:{fileName:S,lineNumber:107,columnNumber:13}},v.a.createElement(f.a,{shape:"square",size:24,style:{marginLeft:6,marginRight:12},__source:{fileName:S,lineNumber:108,columnNumber:15}},v.a.createElement("img",{alt:"avatar",src:e.gb_cover,__source:{fileName:S,lineNumber:109,columnNumber:17}})),"".concat(e.gb_title)),value:e.gb_code}}));B(!1),J(r)}))}),500),[]),se=Object(y.useCallback)(k()((function(e){me.current=Date.now(),$(!0),J([]);var r={user_nick:e};Object(j.b)(r).then((function(e){var r=e.data.map((function(e){return{label:v.a.createElement("div",{style:{display:"flex",alignItems:"center"},__source:{fileName:S,lineNumber:132,columnNumber:13}},v.a.createElement(f.a,{size:24,style:{marginLeft:6,marginRight:12},__source:{fileName:S,lineNumber:133,columnNumber:15}},v.a.createElement("img",{alt:"avatar",src:e.user_photo,__source:{fileName:S,lineNumber:134,columnNumber:17}})),"".concat(e.user_nick)),value:e.user_account}}));$(!1),Q(r)}))}),500),[]),be=Object(y.useCallback)(k()((function(e){me.current=Date.now(),B(!0),J([]);var r={member_name:e};Object(j.e)(r).then((function(e){console.log("data: ",e);var r=e.data.map((function(e){return{label:v.a.createElement("div",{style:{display:"flex",alignItems:"center"},__source:{fileName:S,lineNumber:158,columnNumber:13}},v.a.createElement(f.a,{size:24,style:{marginLeft:6,marginRight:12},__source:{fileName:S,lineNumber:159,columnNumber:15}},v.a.createElement("img",{alt:"avatar",src:e.member_face,__source:{fileName:S,lineNumber:160,columnNumber:17}})),"".concat(e.member_name)),value:e.member_account}}));ue(!1),console.log("options",r),te(r)}))}),500),[]);return Object(y.useEffect)((function(){ie(),be(),se()}),[]),v.a.createElement("div",{style:{maxWidth:650},__source:{fileName:S,lineNumber:183,columnNumber:5}},v.a.createElement(g.a,l()({ref:a},C,{size:"default",onSubmit:function(e){console.log(e)},onValuesChange:function(e,r){console.log("onValuesChange: ",e,r)},scrollToFirstError:!0,__source:{fileName:S,lineNumber:184,columnNumber:7}}),v.a.createElement(x,{label:"选择店铺",field:"store_code",rules:[{required:!0,message:"请填写店铺编码"}],__source:{fileName:S,lineNumber:194,columnNumber:9}},v.a.createElement(b.a,{loading:D,placeholder:"请选择店铺",__source:{fileName:S,lineNumber:199,columnNumber:11}},null==h?void 0:h.map((function(e){return v.a.createElement(b.a.Option,{key:e.store_code,value:e.store_code,__source:{fileName:S,lineNumber:202,columnNumber:17}},e.store_name)})))),v.a.createElement(x,{label:"剧本",field:"gb_code",rules:[{required:!0,message:"请选择剧本"}],__source:{fileName:S,lineNumber:209,columnNumber:9}},v.a.createElement(b.a,{style:{width:345},options:H,placeholder:"请输入要搜索的剧本",filterOption:!1,renderFormat:function(e){return e.children.props.children[1]},notFoundContent:W?v.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},__source:{fileName:S,lineNumber:220,columnNumber:17}},v.a.createElement(s.a,{style:{margin:12},__source:{fileName:S,lineNumber:221,columnNumber:19}})):null,showSearch:!0,onSearch:ie,__source:{fileName:S,lineNumber:210,columnNumber:11}})),v.a.createElement(x,{label:"剧本价格",field:"gb_price",rules:[{required:!0,message:"请填写剧本价格"}],__source:{fileName:S,lineNumber:229,columnNumber:9}},v.a.createElement(i.a,{min:0,placeholder:"请填写剧本价格...",__source:{fileName:S,lineNumber:234,columnNumber:11}})),v.a.createElement(x,{label:"玩家人数",field:"game_people",rules:[{required:!0,message:"请填写玩家人数"}],__source:{fileName:S,lineNumber:236,columnNumber:9}},v.a.createElement(i.a,{min:2,placeholder:"请填写玩家人数...",__source:{fileName:S,lineNumber:241,columnNumber:11}})),v.a.createElement(x,{label:"主持人",field:"dm_user",rules:[{required:!0,message:"请填写主持人"}],__source:{fileName:S,lineNumber:243,columnNumber:9}},v.a.createElement(b.a,{style:{width:345},options:K,placeholder:"请选择主持人",filterOption:!1,renderFormat:function(e){return e.children.props.children[1]},notFoundContent:Z?v.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},__source:{fileName:S,lineNumber:258,columnNumber:17}},v.a.createElement(s.a,{style:{margin:12},__source:{fileName:S,lineNumber:259,columnNumber:19}})):null,showSearch:!0,onSearch:se,__source:{fileName:S,lineNumber:248,columnNumber:11}})),v.a.createElement(g.a.List,{field:"game_player",__source:{fileName:S,lineNumber:268,columnNumber:9}},(function(e,r){var n=r.add,t=r.remove;r.move;return v.a.createElement("div",{__source:{fileName:S,lineNumber:271,columnNumber:15}},e.map((function(e,r){return v.a.createElement("div",{key:e.key,__source:{fileName:S,lineNumber:274,columnNumber:21}},v.a.createElement(g.a.Item,{label:"玩家".concat(1+r),__source:{fileName:S,lineNumber:275,columnNumber:23}},v.a.createElement(c.a,{__source:{fileName:S,lineNumber:276,columnNumber:25}},v.a.createElement(g.a.Item,{field:"".concat(e.field,".player_user"),rules:[{required:!0}],noStyle:!0,__source:{fileName:S,lineNumber:277,columnNumber:27}},v.a.createElement(b.a,{style:{width:145},options:ne,placeholder:"请选择玩家",filterOption:!1,renderFormat:function(e){return e.children.props.children[1]},notFoundContent:ce?v.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},__source:{fileName:S,lineNumber:292,columnNumber:35}},v.a.createElement(s.a,{style:{margin:12},__source:{fileName:S,lineNumber:299,columnNumber:37}})):null,showSearch:!0,onSearch:be,__source:{fileName:S,lineNumber:282,columnNumber:29}})),v.a.createElement(g.a.Item,{field:"".concat(e.field,".player_type"),rules:[{required:!0}],noStyle:!0,__source:{fileName:S,lineNumber:307,columnNumber:27}},v.a.createElement(b.a,{placeholder:"玩家类型",__source:{fileName:S,lineNumber:312,columnNumber:29}},v.a.createElement(b.a.Option,{value:"player",__source:{fileName:S,lineNumber:313,columnNumber:31}},"player"),v.a.createElement(b.a.Option,{value:"worker",__source:{fileName:S,lineNumber:314,columnNumber:31}},"worker"))),v.a.createElement(g.a.Item,{field:"".concat(e.field,".player_name"),rules:[{required:!0}],noStyle:!0,__source:{fileName:S,lineNumber:318,columnNumber:27}},v.a.createElement(o.a,{placeholder:"玩家名称",__source:{fileName:S,lineNumber:323,columnNumber:29}})),v.a.createElement(g.a.Item,{field:"".concat(e.field,".player_note"),rules:[{required:!0}],noStyle:!0,__source:{fileName:S,lineNumber:325,columnNumber:27}},v.a.createElement(o.a,{placeholder:"玩家备注",__source:{fileName:S,lineNumber:330,columnNumber:29}})),v.a.createElement(u.a,{icon:v.a.createElement(m.a,{__source:{fileName:S,lineNumber:333,columnNumber:35}}),shape:"circle",status:"danger",onClick:function(){return t(r)},__source:{fileName:S,lineNumber:332,columnNumber:27}}))))})),v.a.createElement(g.a.Item,l()({},I,{__source:{fileName:S,lineNumber:343,columnNumber:17}}),v.a.createElement(u.a,{onClick:function(){n()},__source:{fileName:S,lineNumber:344,columnNumber:19}},"添加玩家")))})),v.a.createElement(x,l()({},I,{__source:{fileName:S,lineNumber:370,columnNumber:9}}),v.a.createElement(u.a,{onClick:_()(E.a.mark((function e(){var l,c;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.current){e.next=25;break}return e.prev=1,e.next=4,a.current.validate();case 4:if(null!==n){e.next=11;break}return console.log(a.current.getFields()),e.next=8,Object(O.g)(a.current.getFields());case 8:l=e.sent,e.next=17;break;case 11:return c=a.current.getFields(),console.log("param: ",c),c.store_code=n.store_code,e.next=16,Object(O.J)(c);case 16:l=e.sent;case 17:200===l.code&&(t.a.success("添加成功"),r()),e.next=25;break;case 20:e.prev=20,e.t0=e.catch(1),console.log(e.t0),console.log(a.current.getFieldsError()),t.a.error("校验失败，请检查字段！");case 25:case"end":return e.stop()}}),e,null,[[1,20]])}))),type:"primary",style:{marginRight:24},__source:{fileName:S,lineNumber:371,columnNumber:11}},"提交"),v.a.createElement(u.a,{onClick:function(){a.current.resetFields()},__source:{fileName:S,lineNumber:402,columnNumber:11}},"重置"))))}},653:function(e,r,n){"use strict";var t=n(5),a=n.n(t),l=n(4),c=n.n(l),u=n(0),m=n.n(u),o=n(6);function i(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function s(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?i(Object(n),!0).forEach((function(r){c()(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}function b(e,r){var n=Object(u.useContext)(o.a).prefixCls,t=e.spin,l=e.className,c=s(s({ref:r},e),{},{className:"".concat(l?l+" ":"").concat(n,"-icon ").concat(n,"-icon-delete")});return t&&(c.className="".concat(c.className," ").concat(n,"-icon-loading")),delete c.spin,delete c.isIcon,m.a.createElement("svg",a()({fill:"none",stroke:"currentColor",strokeWidth:"4",viewBox:"0 0 48 48",width:"1em",height:"1em"},c),m.a.createElement("path",{d:"M5 11h5.5m0 0v29a1 1 0 0 0 1 1h25a1 1 0 0 0 1-1V11m-27 0H16m21.5 0H43m-5.5 0H32m-16 0V7h16v4m-16 0h16M20 18v15m8-15v15"}))}var f=m.a.forwardRef(b);f.defaultProps={isIcon:!0},f.displayName="IconDelete",r.a=f}}]);