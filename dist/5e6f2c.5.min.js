(window.webpackJsonp=window.webpackJsonp||[]).push([[5,91],{162:function(e,r,l){"use strict";l.r(r);l(151);var a=l(69),n=(l(150),l(79)),t=(l(77),l(30)),u=(l(149),l(52)),m=l(78),o=l.n(m),c=(l(619),l(620)),i=(l(597),l(598)),s=(l(225),l(89)),N=(l(148),l(51)),b=l(24),f=l.n(b),_=(l(227),l(152)),d=(l(305),l(104)),p=l(53),E=l.n(p),g=l(0),y=l.n(g),v=l(224),x="/Users/mrhh/Desktop/gbs-admin/src/pages/stocks-drama/DramaDetail/roleDetail/AddRoleDetailForm/index.tsx",h=d.a.Item,k=_.a.Row,O=_.a.Col;r.default=function(e){var r=e.clickItem,l=e.modalType,m=e.getInitFormData,b=e.saveEditItem,_=e.closeModal,p=e.role_array,C=Object(g.useRef)(),w=Object(g.useState)(""),j=f()(w,2),P=j[0],I=j[1];return Object(g.useEffect)((function(){"edit"===l&&(I(b.role_cover),C.current.setFieldsValue(b))}),[]),y.a.createElement(a.a,{style:{width:"100%"},__source:{fileName:x,lineNumber:43,columnNumber:5}},y.a.createElement("div",{__source:{fileName:x,lineNumber:44,columnNumber:7}},y.a.createElement(d.a,{ref:C,onValuesChange:function(e,r){console.log("onValuesChange: ",e,r)},scrollToFirstError:!0,__source:{fileName:x,lineNumber:45,columnNumber:9}},y.a.createElement(k,{className:"grid-demo",style:{marginBottom:10},__source:{fileName:x,lineNumber:46,columnNumber:11}},y.a.createElement(O,{xs:24,sm:24,md:24,lg:24,xl:24,xxl:24,__source:{fileName:x,lineNumber:47,columnNumber:13}},y.a.createElement("div",{__source:{fileName:x,lineNumber:48,columnNumber:15}},y.a.createElement(h,{label:"角色名称",field:"role_name",rules:[{required:!0,message:"请填写角色名称"}],__source:{fileName:x,lineNumber:49,columnNumber:17}},y.a.createElement(N.a,{placeholder:"请填写角色名称...",__source:{fileName:x,lineNumber:54,columnNumber:19}})))),y.a.createElement(O,{xs:24,sm:24,md:24,lg:24,xl:24,xxl:24,__source:{fileName:x,lineNumber:58,columnNumber:13}},y.a.createElement("div",{__source:{fileName:x,lineNumber:59,columnNumber:15}},y.a.createElement(h,{label:"角色简介",field:"role_brief",rules:[{required:!0,message:"请填写角色简介"}],__source:{fileName:x,lineNumber:60,columnNumber:17}},y.a.createElement(N.a,{placeholder:"请填写角色简介...",__source:{fileName:x,lineNumber:65,columnNumber:19}}))))),y.a.createElement(k,{__source:{fileName:x,lineNumber:70,columnNumber:11}},y.a.createElement(O,{xs:24,sm:24,md:24,lg:24,xl:24,xxl:24,__source:{fileName:x,lineNumber:71,columnNumber:13}},y.a.createElement("div",{__source:{fileName:x,lineNumber:72,columnNumber:15}},y.a.createElement(h,{label:"是否凶手",field:"is_murderer",rules:[{required:!1,message:"请选择是否凶手"}],__source:{fileName:x,lineNumber:73,columnNumber:17}},y.a.createElement(s.a,{placeholder:"请选择是否凶手",__source:{fileName:x,lineNumber:78,columnNumber:19}},y.a.createElement(s.a.Option,{value:"1",__source:{fileName:x,lineNumber:79,columnNumber:21}},"是"),y.a.createElement(s.a.Option,{value:"0",__source:{fileName:x,lineNumber:80,columnNumber:21}},"否"))))),y.a.createElement(O,{xs:24,sm:24,md:24,lg:24,xl:24,xxl:24,__source:{fileName:x,lineNumber:85,columnNumber:13}},y.a.createElement("div",{__source:{fileName:x,lineNumber:86,columnNumber:15}},y.a.createElement(h,{label:"角色备注",field:"role_remarks",rules:[{required:!1,message:"请填写角色备注"}],__source:{fileName:x,lineNumber:87,columnNumber:17}},y.a.createElement(N.a,{placeholder:"请填写角色备注...",__source:{fileName:x,lineNumber:92,columnNumber:19}}))))),y.a.createElement(k,{__source:{fileName:x,lineNumber:97,columnNumber:11}},y.a.createElement(O,{xs:24,sm:24,md:24,lg:24,xl:24,xxl:24,__source:{fileName:x,lineNumber:98,columnNumber:13}},y.a.createElement(d.a.Item,{rules:[{required:!0,message:"请上传角色封面"}],label:"角色封面",field:"role_cover",triggerPropName:"fileList",__source:{fileName:x,lineNumber:99,columnNumber:15}},y.a.createElement(c.a,{limit:1,renderUploadList:function(){return null},name:"role_cover",customRequest:function(e){var r=e.onProgress,l=e.onError,a=e.onSuccess,n=e.file,t=new XMLHttpRequest;t.upload&&(t.upload.onprogress=function(e){var l;e.total>0&&(l=e.loaded/e.total*100),r(parseInt(l,10),e)}),t.onerror=function(e){l(e)},t.onload=function(){t.status<200||t.status;var e=JSON.parse(t.responseText);I(e.data.file_url),a(e)};var u=new FormData;u.append("up_file",n),u.append("module","drama"),t.open("post","https://gbs.toptian.com/system/upload/image",!0),t.setRequestHeader("Authorization",localStorage.getItem("token")),t.send(u)},onPreview:function(e){i.a.info({title:"Preview",content:y.a.createElement("img",{src:e.url||URL.createObjectURL(e.originFile),style:{maxWidth:"100%"},__source:{fileName:x,lineNumber:143,columnNumber:25}})})},__source:{fileName:x,lineNumber:105,columnNumber:17}})))),""===P?null:y.a.createElement(k,{__source:{fileName:x,lineNumber:155,columnNumber:13}},y.a.createElement(d.a.Item,{label:"封面图片",__source:{fileName:x,lineNumber:156,columnNumber:15}},y.a.createElement("img",{style:{width:212,height:300},src:P,alt:"",__source:{fileName:x,lineNumber:157,columnNumber:17}}))),y.a.createElement(k,{__source:{fileName:x,lineNumber:162,columnNumber:11}},y.a.createElement(O,{style:{display:"flex",alignItems:"center",justifyContent:"center"},__source:{fileName:x,lineNumber:163,columnNumber:13}},y.a.createElement("div",{__source:{fileName:x,lineNumber:164,columnNumber:15}},y.a.createElement(h,{__source:{fileName:x,lineNumber:165,columnNumber:17}},y.a.createElement(n.a,{__source:{fileName:x,lineNumber:166,columnNumber:19}},y.a.createElement(t.a,{onClick:o()(E.a.mark((function e(){var a,n,t,o;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!C.current){e.next=30;break}return e.prev=1,e.next=4,C.current.validate();case 4:if((a=C.current.getFields()).role_cover=P,console.log("param",a),n=p.map((function(e){return e.role_code===a.role_code?a:e})),"add"!==l){e.next=17;break}return p.push(a),(t={}).role_array=p,t.gb_code=r.gb_code,e.next=15,Object(v.r)(t);case 15:200===e.sent.code&&(u.a.success("添加成功"),m(),_());case 17:if("edit"!==l){e.next=25;break}return(o={}).role_array=n,o.gb_code=r.gb_code,e.next=23,Object(v.r)(o);case 23:200===e.sent.code&&(u.a.success("修改成功"),m(),_());case 25:e.next=30;break;case 27:e.prev=27,e.t0=e.catch(1),u.a.error("校验失败，请检查字段！");case 30:case"end":return e.stop()}}),e,null,[[1,27]])}))),type:"primary",__source:{fileName:x,lineNumber:167,columnNumber:21}},"提交"),y.a.createElement(t.a,{onClick:function(){C.current.resetFields()},__source:{fileName:x,lineNumber:217,columnNumber:21}},"重置")))))))))}},163:function(e,r,l){"use strict";l.r(r),l.d(r,"default",(function(){return G}));var a=l(5),n=l.n(a),t=l(607),u=(l(225),l(89)),m=(l(148),l(51)),o=(l(105),l(33)),c=(l(155),l(63)),i=(l(150),l(79)),s=(l(16),l(77),l(337),l(639),l(0)),N=l.n(s),b=l(229),f=l(30),_=l(47),d=l(3),p=l(14),E=l(9),g=function(){return(g=Object.assign||function(e){for(var r,l=1,a=arguments.length;l<a;l++)for(var n in r=arguments[l])Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e}).apply(this,arguments)},y=function(e,r){var l={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&r.indexOf(a)<0&&(l[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)r.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(l[a[n]]=e[a[n]])}return l},v=function(e,r){var l="function"==typeof Symbol&&e[Symbol.iterator];if(!l)return e;var a,n,t=l.call(e),u=[];try{for(;(void 0===r||r-- >0)&&!(a=t.next()).done;)u.push(a.value)}catch(e){n={error:e}}finally{try{a&&!a.done&&(l=t.return)&&l.call(t)}finally{if(n)throw n.error}}return u},x={position:"top",okType:"primary",icon:N.a.createElement(_.a,null),blurToHide:!0,unmountOnExit:!0,trigger:"click",escToClose:!0};var h=Object(s.forwardRef)((function(e,r){var l,a=Object(s.useContext)(d.a),n=a.getPrefixCls,t=a.locale,u=a.componentConfig,m=Object(E.a)(e,x,null==u?void 0:u.Popconfirm),c=m.style,i=m.className,_=m.children,h=m.position,k=m.getPopupContainer,O=m.blurToHide,C=m.unmountOnExit,w=m.trigger,j=m.escToClose,P=m.onVisibleChange,I=m.triggerProps,T=m.title,S=m.icon,F=m.okText,V=m.cancelText,q=m.okType,D=m.okButtonProps,R=m.cancelButtonProps,H=m.autoFocus,L=m.focusLock,M=y(m,["style","className","children","position","getPopupContainer","blurToHide","unmountOnExit","trigger","escToClose","onVisibleChange","triggerProps","title","icon","okText","cancelText","okType","okButtonProps","cancelButtonProps","autoFocus","focusLock"]),B=v(Object(p.a)(!1,{defaultValue:m.defaultPopupVisible,value:m.popupVisible}),2),z=B[0],U=B[1],J=v(Object(s.useState)(!1),2),A=J[0],W=J[1],X=n("popconfirm"),G=function(e){"popupVisible"in m||U(e),I&&I.onVisibleChange&&I.onVisibleChange(e),P&&P(e)},K=function(){G(!1)},Q=function(){K(),m.onCancel&&m.onCancel()},Y=function(){var e,r=m.onOk||m.onConfirm;r&&(e=r()),e&&e.then&&(W(!0),e.then((function(){K()}),(function(e){W(!1),console.error(e)}))),e||K()};return Object(s.useEffect)((function(){return!z&&A&&W(!1),function(){W(!1)}}),[z]),N.a.createElement(o.a,g({},M,{ref:r,style:g({maxWidth:350},c),className:i,prefixCls:X,getPopupContainer:k,position:h,trigger:w,escToClose:j,popupVisible:z,content:(l=N.a.createElement(N.a.Fragment,null,N.a.createElement(f.a,g({onClick:Q,size:"mini"},R),V||t.Popconfirm.cancelText),N.a.createElement(f.a,g({loading:A,onClick:Y,size:"mini",type:q},D),F||t.Popconfirm.okText)),N.a.createElement("div",{className:X+"-wrapper"},N.a.createElement("div",{className:X+"-title"},S&&N.a.createElement("span",{className:X+"-title-icon"},S),N.a.createElement("div",{className:X+"-title-text"},T)),N.a.createElement("div",{className:X+"-btn"},L?N.a.createElement(b.a,{disabled:!z,autoFocus:!!H},l):l))),unmountOnExit:C,blurToHide:O,popupHoverStay:!0,triggerProps:I,onVisibleChange:G,childrenPrefix:X}),"string"==typeof _?N.a.createElement("span",null,_):_)}));h.displayName="Popconfirm";var k=h,O=(l(149),l(52)),C=l(78),w=l.n(C),j=(l(600),l(604)),P=(l(597),l(598)),I=l(24),T=l.n(I),S=(l(601),l(605)),F=(l(305),l(104)),V=(l(227),l(152)),q=l(53),D=l.n(q),R=l(574),H=l.n(R),L=l(32),M=l(224),B=l(162),z="/Users/mrhh/Desktop/gbs-admin/src/pages/stocks-drama/DramaDetail/roleDetail/index.tsx",U=V.a.Row,J=V.a.Col,A=F.a.Item,W=S.a.Meta,X={labelCol:{span:4},wrapperCol:{span:17}};function G(e){var r=e.getInitFormData,l=e.role_array,a=Object(s.useRef)(),b=Object(L.c)((function(e){return e.myState}));Object(s.useEffect)((function(){a.current.setFieldsValue({role_array:l})}),[l]);var _=Object(s.useState)(),d=T()(_,2),p=d[0],E=d[1],g=Object(s.useState)(),y=T()(g,2),v=y[0],x=y[1],h=Object(s.useState)(""),C=T()(h,2),I=C[0],V=C[1],q=b.clickItem,R=Object(s.useState)(!1),G=T()(R,2),K=G[0],Q=G[1];return N.a.createElement(N.a.Fragment,null,N.a.createElement(P.a,{onCancel:function(){Q(!1)},title:"add"===I?"添加角色":"修改角色",visible:K,footer:null,unmountOnExit:!0,__source:{fileName:z,lineNumber:58,columnNumber:7}},N.a.createElement(B.default,{getInitFormData:r,saveEditItem:v,modalType:I,closeModal:function(){Q(!1)},role_array:l,clickItem:q,__source:{fileName:z,lineNumber:67,columnNumber:9}})),N.a.createElement(f.a,{onClick:function(){Q(!0),V("add")},type:"primary",__source:{fileName:z,lineNumber:78,columnNumber:7}},"添加角色"),0===l.length&&N.a.createElement(j.a,{status:"404",subTitle:"该剧本还没有角色喔",__source:{fileName:z,lineNumber:87,columnNumber:35}}),N.a.createElement(U,{gutter:40,style:{display:"flex",padding:20},__source:{fileName:z,lineNumber:89,columnNumber:7}},l.map((function(e){return N.a.createElement(S.a,{key:e.role_code,className:H.a.Meta,hoverable:!0,style:{width:212,maxHeight:505,marginRight:20,marginBottom:20},extra:N.a.createElement(i.a,{__source:{fileName:z,lineNumber:98,columnNumber:17}},N.a.createElement(f.a,{onClick:function(){V("edit"),x(e),Q(!0)},size:"mini",type:"primary",__source:{fileName:z,lineNumber:99,columnNumber:19}},"修改角色"),N.a.createElement(k,{title:"确定删除这个角色?",onOk:w()(D.a.mark((function e(){var a,n;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=l.filter((function(e){return p.role_code===e.role_code})),n={gb_code:q.gb_code,role_array:a},e.next=4,Object(M.s)(n);case 4:200===e.sent.code&&(O.a.success("删除成功"),r());case 6:case"end":return e.stop()}}),e)}))),onCancel:function(){},__source:{fileName:z,lineNumber:110,columnNumber:19}},N.a.createElement(f.a,{size:"mini",onClick:function(){E(e)},status:"danger",__source:{fileName:z,lineNumber:128,columnNumber:21}},"删除角色"))),cover:N.a.createElement("div",{style:{height:300},__source:{fileName:z,lineNumber:141,columnNumber:17}},N.a.createElement("img",{style:{width:"100%",height:"100%"},alt:"dessert",src:e.role_cover,__source:{fileName:z,lineNumber:146,columnNumber:19}})),__source:{fileName:z,lineNumber:92,columnNumber:13}},N.a.createElement(W,{title:N.a.createElement("span",{style:{color:"white"},__source:{fileName:z,lineNumber:155,columnNumber:24}},e.role_name),description:N.a.createElement(N.a.Fragment,null,N.a.createElement(o.a,{content:e.role_brief,__source:{fileName:z,lineNumber:158,columnNumber:21}},N.a.createElement(c.a.Paragraph,{ellipsis:!0,style:{width:"100%",color:"white"},__source:{fileName:z,lineNumber:159,columnNumber:23}},e.role_brief))),__source:{fileName:z,lineNumber:154,columnNumber:15}}))}))),N.a.createElement(F.a,n()({style:{display:"none"},onValuesChange:function(e,r){console.log("onValuesChange: ",e,r)},layout:"vertical",ref:a},X,{__source:{fileName:z,lineNumber:173,columnNumber:7}}),N.a.createElement(F.a.List,{field:"role_array",__source:{fileName:z,lineNumber:180,columnNumber:9}},(function(e,r){var l=r.add,a=r.remove;return N.a.createElement("div",{__source:{fileName:z,lineNumber:183,columnNumber:15}},e.map((function(e,r){return N.a.createElement("div",{key:e.key,__source:{fileName:z,lineNumber:186,columnNumber:21}},N.a.createElement(F.a.Item,{label:"角色".concat(r+1),__source:{fileName:z,lineNumber:187,columnNumber:23}},N.a.createElement(i.a,{__source:{fileName:z,lineNumber:188,columnNumber:25}},N.a.createElement(U,{__source:{fileName:z,lineNumber:189,columnNumber:27}},N.a.createElement(F.a.Item,{label:"角色名称",field:"".concat(e.field,".role_name"),rules:[{required:!0}],noStyle:!0,__source:{fileName:z,lineNumber:190,columnNumber:29}},N.a.createElement(m.a,{placeholder:"角色名称",__source:{fileName:z,lineNumber:196,columnNumber:31}}))),N.a.createElement(F.a.Item,{label:"角色简介",field:"".concat(e.field,".role_brief"),rules:[{required:!0}],noStyle:!0,__source:{fileName:z,lineNumber:200,columnNumber:27}},N.a.createElement(m.a,{placeholder:"角色简介",__source:{fileName:z,lineNumber:206,columnNumber:29}})),N.a.createElement(F.a.Item,{label:"角色备注",field:"".concat(e.field,".role_remarks"),rules:[{required:!0}],noStyle:!0,__source:{fileName:z,lineNumber:208,columnNumber:27}},N.a.createElement(m.a,{placeholder:"角色备注",__source:{fileName:z,lineNumber:214,columnNumber:29}})),N.a.createElement(F.a.Item,{label:"是否凶手",field:"".concat(e.field,".is_murderer"),rules:[{required:!0}],noStyle:!0,__source:{fileName:z,lineNumber:216,columnNumber:27}},N.a.createElement(u.a,{placeholder:"是否凶手",__source:{fileName:z,lineNumber:222,columnNumber:29}},N.a.createElement(u.a.Option,{value:"1",__source:{fileName:z,lineNumber:223,columnNumber:31}},"是"),N.a.createElement(u.a.Option,{value:"0",__source:{fileName:z,lineNumber:224,columnNumber:31}},"否"))),N.a.createElement(F.a.Item,{label:"角色封面",field:"".concat(e.field,".role_cover"),rules:[{required:!0}],noStyle:!0,__source:{fileName:z,lineNumber:227,columnNumber:27}},N.a.createElement(m.a,{placeholder:"角色封面",__source:{fileName:z,lineNumber:241,columnNumber:29}})),N.a.createElement(f.a,{icon:N.a.createElement(t.a,{__source:{fileName:z,lineNumber:261,columnNumber:35}}),shape:"circle",status:"danger",onClick:function(){return a(r)},__source:{fileName:z,lineNumber:260,columnNumber:27}}))))})),N.a.createElement(F.a.Item,{__source:{fileName:z,lineNumber:271,columnNumber:17}},N.a.createElement(f.a,{type:"primary",onClick:function(){l()},__source:{fileName:z,lineNumber:272,columnNumber:19}},"添加角色")))})),N.a.createElement(U,{style:{width:"100%"},__source:{fileName:z,lineNumber:285,columnNumber:9}},N.a.createElement(J,{span:24,__source:{fileName:z,lineNumber:286,columnNumber:11}},N.a.createElement(A,{style:{display:"flex",justifyContent:"flex-end"},__source:{fileName:z,lineNumber:287,columnNumber:13}},N.a.createElement(i.a,{__source:{fileName:z,lineNumber:288,columnNumber:15}},N.a.createElement(f.a,{onClick:w()(D.a.mark((function e(){var r;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.current){e.next=16;break}return e.prev=1,e.next=4,a.current.validate();case 4:return e.next=6,a.current.validate();case 6:return(r=e.sent).gb_code=q.gb_code,e.next=10,Object(M.r)(r);case 10:200===e.sent.code&&O.a.info("提交成功！"),e.next=16;break;case 14:e.prev=14,e.t0=e.catch(1);case 16:case"end":return e.stop()}}),e,null,[[1,14]])}))),type:"primary",__source:{fileName:z,lineNumber:289,columnNumber:17}},"提交"),N.a.createElement(f.a,{onClick:function(){a.current.resetFields()},__source:{fileName:z,lineNumber:309,columnNumber:17}},"重置")))))))}},574:function(e,r,l){e.exports={Meta:"Meta-808b8975b7"}},639:function(e,r,l){}}]);