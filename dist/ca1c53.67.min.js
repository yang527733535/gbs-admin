(window.webpackJsonp=window.webpackJsonp||[]).push([[67],{345:function(e,r,t){"use strict";t.r(r),t.d(r,"default",(function(){return j}));t(65);var a=t(24),n=(t(112),t(45)),o=t(56),l=t.n(o),u=t(5),c=t.n(u),m=(t(691),t(692)),i=(t(333),t(252)),s=(t(251),t(96)),f=(t(113),t(40)),b=t(22),d=t.n(b),N=(t(250),t(73)),_=t(35),p=t.n(_),g=t(0),v=t.n(g),E=t(111),h=t(675),w="/Users/mrhh/Desktop/gbs-admin/src/pages/stocks-store/storeDetail/roomDetail/roomform.jsx",k=N.a.Item,x={labelCol:{span:5},wrapperCol:{span:17}},O={wrapperCol:{span:17,offset:5}};function j(e){var r=e.saveClickItem,t=e.store_code,o=e.modalType,u=e.closeModal,b=Object(g.useRef)(),_=Object(g.useState)(""),j=d()(_,2),y=j[0],C=j[1],F=Object(g.useState)([]),I=d()(F,2),R=I[0],S=I[1];Object(g.useEffect)((function(){JSON.parse(localStorage.getItem("dicts")).forEach((function(e){"app_room_style"===e.dict_code&&S(e.dict_label)}))}),[]),Object(g.useEffect)((function(){"edit"===o&&(b.current.setFieldsValue(r),C(r.room_image))}),[]);return v.a.createElement("div",{__source:{fileName:w,lineNumber:47,columnNumber:5}},v.a.createElement(N.a,c()({ref:b},x,{onValuesChange:function(e,r){console.log("onValuesChange: ",e,r)},scrollToFirstError:!0,__source:{fileName:w,lineNumber:48,columnNumber:7}}),v.a.createElement(k,{label:"房间名称",field:"room_name",rules:[{required:!0,message:"请输入房间名称"}],__source:{fileName:w,lineNumber:49,columnNumber:9}},v.a.createElement(f.a,{placeholder:"请输入房间名称",__source:{fileName:w,lineNumber:54,columnNumber:11}})),v.a.createElement(k,{label:"房间风格",field:"room_style",rules:[{required:!0,message:"请选择房间风格"}],__source:{fileName:w,lineNumber:56,columnNumber:9}},v.a.createElement(s.a,{__source:{fileName:w,lineNumber:61,columnNumber:11}},null==R?void 0:R.map((function(e){var r=e.label_value,t=e.label_zh;return v.a.createElement(s.a.Option,{value:r,__source:{fileName:w,lineNumber:63,columnNumber:22}},t)})))),v.a.createElement(k,{label:"房间备注",field:"room_note",rules:[{required:!0,message:"请输入房间备注"}],__source:{fileName:w,lineNumber:68,columnNumber:9}},v.a.createElement(f.a,{placeholder:"请输入房间备注",__source:{fileName:w,lineNumber:73,columnNumber:11}})),v.a.createElement(N.a.Item,{label:"房间照片",field:"room_image",triggerPropName:"fileList",__source:{fileName:w,lineNumber:76,columnNumber:9}},v.a.createElement(m.a,{limit:1,renderUploadList:function(){return null},name:"role_cover",customRequest:function(e){var r=e.onProgress,t=e.onError,a=e.onSuccess,n=e.file,o=new XMLHttpRequest;o.upload&&(o.upload.onprogress=function(e){var t;e.total>0&&(t=e.loaded/e.total*100),r(parseInt(t,10),e)}),o.onerror=function(e){t(e)},o.onload=function(){o.status<200||o.status;var e=JSON.parse(o.responseText);C(e.data.file_url),a(e)};var l=new FormData;l.append("up_file",n),l.append("module","drama"),o.open("post","".concat(h.a,"/system/upload/image"),!0),o.setRequestHeader("Authorization",localStorage.getItem("token")),o.send(l)},onPreview:function(e){i.a.info({title:"Preview",content:v.a.createElement("img",{src:e.url||URL.createObjectURL(e.originFile),style:{maxWidth:"100%"},__source:{fileName:w,lineNumber:114,columnNumber:19}})})},__source:{fileName:w,lineNumber:77,columnNumber:11}})),""===y?null:v.a.createElement(N.a.Item,c()({},O,{__source:{fileName:w,lineNumber:124,columnNumber:11}}),v.a.createElement("img",{style:{width:212,height:300},src:y,alt:"",__source:{fileName:w,lineNumber:125,columnNumber:13}})),v.a.createElement(k,c()({},O,{__source:{fileName:w,lineNumber:129,columnNumber:9}}),v.a.createElement(a.a,{onClick:l()(p.a.mark((function e(){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!b.current){e.next=25;break}return e.prev=1,e.next=4,b.current.validate();case 4:if((r=b.current.getFields()).room_image=y,r.store_code=t,console.log(r),"add"!==o){e.next=13;break}return e.next=11,Object(E.B)(r);case 11:200===e.sent.code&&(n.a.info("提交成功！"),u());case 13:if("edit"!==o){e.next=18;break}return e.next=16,Object(E.J)(r);case 16:200===e.sent.code&&(n.a.info("修改成功！"),u());case 18:e.next=25;break;case 20:e.prev=20,e.t0=e.catch(1),console.log(e.t0),console.log(b.current.getFieldsError()),n.a.error("校验失败，请检查字段！");case 25:case"end":return e.stop()}}),e,null,[[1,20]])}))),type:"primary",style:{marginRight:24},__source:{fileName:w,lineNumber:130,columnNumber:11}},"提交"),v.a.createElement(a.a,{onClick:function(){b.current.resetFields()},__source:{fileName:w,lineNumber:165,columnNumber:11}},"重置"))))}},675:function(e,r,t){"use strict";t.d(r,"a",(function(){return a}));var a="https://dev-service.mengmohmg.com"}}]);