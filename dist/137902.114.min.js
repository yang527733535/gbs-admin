(window.webpackJsonp=window.webpackJsonp||[]).push([[114],{376:function(e,r,a){"use strict";a.r(r),a.d(r,"default",(function(){return O}));a(65);var t=a(24),l=(a(112),a(45)),n=a(56),o=a.n(n),u=a(5),c=a.n(u),m=(a(697),a(698)),i=(a(335),a(254)),s=(a(253),a(96)),b=(a(113),a(40)),f=a(22),d=a.n(f),N=(a(252),a(73)),_=a(35),p=a.n(_),g=a(0),v=a.n(g),E=a(111),h="/Users/mrhh/Desktop/gbs-admin/src/pages/store-game/gameDetail/roomDetail/roomform.jsx",w=N.a.Item,k={labelCol:{span:5},wrapperCol:{span:17}},x={wrapperCol:{span:17,offset:5}};function O(e){var r=e.saveClickItem,a=e.store_code,n=e.modalType,u=e.closeModal;console.log("saveClickItem: ",r);var f=Object(g.useRef)(),_=Object(g.useState)(""),O=d()(_,2),j=O[0],y=O[1],C=Object(g.useState)([]),I=d()(C,2),F=I[0],R=I[1];Object(g.useEffect)((function(){var e=JSON.parse(localStorage.getItem("dicts"));console.log("data: ",e),e.forEach((function(e){"app_room_style"===e.dict_code&&(console.log("element.dict_label",e.dict_label),R(e.dict_label))}))}),[]),Object(g.useEffect)((function(){"edit"===n&&(f.current.setFieldsValue(r),y(r.room_image))}),[]);return v.a.createElement("div",{__source:{fileName:h,lineNumber:49,columnNumber:5}},v.a.createElement(N.a,c()({ref:f},k,{onValuesChange:function(e,r){console.log("onValuesChange: ",e,r)},scrollToFirstError:!0,__source:{fileName:h,lineNumber:50,columnNumber:7}}),v.a.createElement(w,{label:"房间名称",field:"room_name",rules:[{required:!0,message:"请输入房间名称"}],__source:{fileName:h,lineNumber:51,columnNumber:9}},v.a.createElement(b.a,{placeholder:"请输入房间名称",__source:{fileName:h,lineNumber:56,columnNumber:11}})),v.a.createElement(w,{label:"房间风格",field:"room_style",rules:[{required:!0,message:"请选择房间风格"}],__source:{fileName:h,lineNumber:58,columnNumber:9}},v.a.createElement(s.a,{__source:{fileName:h,lineNumber:63,columnNumber:11}},null==F?void 0:F.map((function(e){var r=e.label_value,a=e.label_zh;return v.a.createElement(s.a.Option,{value:r,__source:{fileName:h,lineNumber:65,columnNumber:22}},a)})))),v.a.createElement(w,{label:"房间备注",field:"room_note",rules:[{required:!0,message:"请输入房间备注"}],__source:{fileName:h,lineNumber:70,columnNumber:9}},v.a.createElement(b.a,{placeholder:"请输入房间备注",__source:{fileName:h,lineNumber:75,columnNumber:11}})),v.a.createElement(N.a.Item,{label:"房间照片",field:"room_image",triggerPropName:"fileList",__source:{fileName:h,lineNumber:78,columnNumber:9}},v.a.createElement(m.a,{limit:1,renderUploadList:function(){return null},name:"role_cover",customRequest:function(e){var r=e.onProgress,a=e.onError,t=e.onSuccess,l=e.file,n=new XMLHttpRequest;n.upload&&(n.upload.onprogress=function(e){var a;e.total>0&&(a=e.loaded/e.total*100),r(parseInt(a,10),e)}),n.onerror=function(e){a(e)},n.onload=function(){n.status<200||n.status;var e=JSON.parse(n.responseText);y(e.data.file_url),t(e)};var o=new FormData;o.append("up_file",l),o.append("module","drama"),n.open("post","https://gbs.toptian.com/system/upload/image",!0),n.setRequestHeader("Authorization",localStorage.getItem("token")),n.send(o)},onPreview:function(e){i.a.info({title:"Preview",content:v.a.createElement("img",{src:e.url||URL.createObjectURL(e.originFile),style:{maxWidth:"100%"},__source:{fileName:h,lineNumber:116,columnNumber:19}})})},__source:{fileName:h,lineNumber:79,columnNumber:11}})),""===j?null:v.a.createElement(N.a.Item,c()({},x,{__source:{fileName:h,lineNumber:126,columnNumber:11}}),v.a.createElement("img",{style:{width:212,height:300},src:j,alt:"",__source:{fileName:h,lineNumber:127,columnNumber:13}})),v.a.createElement(w,c()({},x,{__source:{fileName:h,lineNumber:131,columnNumber:9}}),v.a.createElement(t.a,{onClick:o()(p.a.mark((function e(){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!f.current){e.next=25;break}return e.prev=1,e.next=4,f.current.validate();case 4:if((r=f.current.getFields()).room_image=j,r.store_code=a,console.log(r),"add"!==n){e.next=13;break}return e.next=11,Object(E.A)(r);case 11:200===e.sent.code&&(l.a.info("提交成功！"),u());case 13:if("edit"!==n){e.next=18;break}return e.next=16,Object(E.I)(r);case 16:200===e.sent.code&&(l.a.info("修改成功！"),u());case 18:e.next=25;break;case 20:e.prev=20,e.t0=e.catch(1),console.log(e.t0),console.log(f.current.getFieldsError()),l.a.error("校验失败，请检查字段！");case 25:case"end":return e.stop()}}),e,null,[[1,20]])}))),type:"primary",style:{marginRight:24},__source:{fileName:h,lineNumber:132,columnNumber:11}},"提交"),v.a.createElement(t.a,{onClick:function(){f.current.resetFields()},__source:{fileName:h,lineNumber:167,columnNumber:11}},"重置"))))}}}]);