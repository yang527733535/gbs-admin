(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{160:function(e,r,l){"use strict";l.r(r);l(151);var a=l(68),u=l(7),t=l.n(u),n=(l(77),l(28)),m=(l(149),l(59)),c=(l(591),l(589)),o=(l(607),l(611)),i=(l(295),l(220)),s=(l(219),l(89)),b=(l(608),l(610)),_=(l(576),l(579)),N=(l(148),l(49)),d=l(5),f=l.n(d),p=l(78),g=l.n(p),E=l(24),v=l.n(E),h=(l(294),l(106)),O=l(50),y=l.n(O),j=l(0),w=l.n(j),q=l(218),x="/Users/mrhh/Desktop/gbs-admin/src/pages/stocks-drama/form/index.jsx";function k(e,r){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),l.push.apply(l,a)}return l}function S(e){for(var r=1;r<arguments.length;r++){var l=null!=arguments[r]?arguments[r]:{};r%2?k(Object(l),!0).forEach((function(r){f()(e,r,l[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):k(Object(l)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(l,r))}))}return e}var P=h.a.Item,F={labelCol:{span:7},wrapperCol:{span:17}},R={wrapperCol:{span:17,offset:7}};r.default=function(e){var r,l,u,d,f=e.labelData,p=e.clickItem,E=e.modalType,O=e.closeModalAndRequest,k=Object(j.useRef)(),C=Object(j.useState)(null),D=v()(C,2),T=(D[0],D[1]),z=Object(j.useState)(!1),I=v()(z,2),J=I[0],L=I[1],H=Object(j.useState)("default"),U=v()(H,2),V=U[0],A=(U[1],Object(j.useState)([])),M=v()(A,2),W=M[0],X=M[1],B=Object(j.useState)([]),G=v()(B,2),K=G[0],Q=G[1],Y=Object(j.useState)([]),Z=v()(Y,2),$=(Z[0],Z[1]),ee=Object(j.useState)([]),re=v()(ee,2),le=re[0],ae=re[1],ue=Object(j.useState)([]),te=v()(ue,2),ne=te[0],me=te[1];Object(j.useEffect)((function(){"edit"===E&&ce()}),[]);var ce=function(){var e=g()(y.a.mark((function e(){var r,l;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return L(!0),e.next=3,Object(q.h)({gb_code:p.gb_code});case 3:r=e.sent,l=r.data,L(!1),k.current.setFieldsValue(S(S({},l),{},{gb_cover:[{uid:"1",url:l.gb_cover,name:"20200717"}]}));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(j.useEffect)((function(){for(var e=0;e<f.length;e++){var r=f[e];"app_gb_type"===r.dict_code&&X(r),"app_gb_level"===r.dict_code&&Q(r),"app_gb_people"===r.dict_code&&$(r),"app_gb_text_tag"===r.dict_code&&ae(r),"app_gb_status"===r.dict_code&&me(r)}}),[]),w.a.createElement(a.a,{style:{width:"100%"},loading:J,__source:{fileName:x,lineNumber:94,columnNumber:5}},w.a.createElement("div",{style:{maxWidth:650},__source:{fileName:x,lineNumber:95,columnNumber:7}},w.a.createElement(h.a,t()({ref:k},F,{size:V,onSubmit:function(e){console.log(param)},onValuesChange:function(e,r){console.log("onValuesChange: ",e,r)},scrollToFirstError:!0,__source:{fileName:x,lineNumber:96,columnNumber:9}}),w.a.createElement(P,{label:"剧本名称",field:"gb_title",rules:[{required:!0,message:"请填写剧本名称"}],__source:{fileName:x,lineNumber:110,columnNumber:11}},w.a.createElement(N.a,{placeholder:"请填写剧本名称...",__source:{fileName:x,lineNumber:115,columnNumber:13}})),w.a.createElement(h.a.Item,{rules:[{required:!0,message:"请上传剧本封面"}],label:"剧本封面",field:"gb_cover",triggerPropName:"fileList",__source:{fileName:x,lineNumber:117,columnNumber:11}},w.a.createElement(b.a,{limit:1,listType:"picture-card",name:"gb_cover",customRequest:function(e){var r=e.onProgress,l=e.onError,a=e.onSuccess,u=e.file,t=new XMLHttpRequest;t.upload&&(t.upload.onprogress=function(e){var l;e.total>0&&(l=e.loaded/e.total*100),r(parseInt(l,10),e)}),t.onerror=function(e){l(e)},t.onload=function(){if(t.status<200||t.status>=300)return l(t.responseText);T(JSON.parse(t.responseText)),a(JSON.parse(t.responseText),t)};var n=new FormData;n.append("up_file",u),n.append("module","drama"),t.open("post","https://gbs.toptian.com/system/upload/image",!0),t.setRequestHeader("Authorization",localStorage.getItem("token")),t.send(n)},onPreview:function(e){_.a.info({title:"Preview",content:w.a.createElement("img",{src:e.url||URL.createObjectURL(e.originFile),style:{maxWidth:"100%"},__source:{fileName:x,lineNumber:160,columnNumber:21}})})},__source:{fileName:x,lineNumber:123,columnNumber:13}})),w.a.createElement(P,{label:"剧本类型",field:"gb_type",rules:[{required:!0,message:"请填写剧本类型"}],__source:{fileName:x,lineNumber:169,columnNumber:11}},w.a.createElement(s.a,{placeholder:"请选择剧本类型",__source:{fileName:x,lineNumber:174,columnNumber:13}},null==W||null===(r=W.dict_label)||void 0===r?void 0:r.map((function(e){return w.a.createElement(s.a.Option,{key:e.label_value,value:e.label_value,__source:{fileName:x,lineNumber:177,columnNumber:19}},e.label_zh)})))),w.a.createElement(P,{label:"剧本难度",field:"gb_level",rules:[{required:!0,message:"请选中剧本难度"}],__source:{fileName:x,lineNumber:184,columnNumber:11}},w.a.createElement(s.a,{placeholder:"请选择剧本难度",__source:{fileName:x,lineNumber:189,columnNumber:13}},null==K||null===(l=K.dict_label)||void 0===l?void 0:l.map((function(e){return w.a.createElement(s.a.Option,{key:e.label_value,value:e.label_value,__source:{fileName:x,lineNumber:192,columnNumber:19}},e.label_zh)})))),w.a.createElement(P,{label:"玩家人数",field:"gb_people",rules:[{required:!0,message:"请填写玩家说明"}],__source:{fileName:x,lineNumber:199,columnNumber:11}},w.a.createElement(i.a,{placeholder:"请填写玩家说明...",__source:{fileName:x,lineNumber:204,columnNumber:13}})),w.a.createElement(P,{label:"剧本状态",field:"gb_status",rules:[{required:!1,message:"请选择剧本状态"}],__source:{fileName:x,lineNumber:206,columnNumber:11}},w.a.createElement(s.a,{placeholder:"请选择剧本状态",__source:{fileName:x,lineNumber:211,columnNumber:13}},null==ne||null===(u=ne.dict_label)||void 0===u?void 0:u.map((function(e){return w.a.createElement(s.a.Option,{key:e.label_value,value:e.label_value,__source:{fileName:x,lineNumber:214,columnNumber:19}},e.label_zh)})))),w.a.createElement(P,{label:"玩家说明",field:"gb_people_note",rules:[{required:!0,message:"请填写玩家说明"}],__source:{fileName:x,lineNumber:221,columnNumber:11}},w.a.createElement(N.a,{placeholder:"请填写玩家说明...",__source:{fileName:x,lineNumber:226,columnNumber:13}})),w.a.createElement(P,{label:"剧本标签",field:"gb_text_tag_arr",rules:[{required:!0,message:"请选择剧本标签"}],__source:{fileName:x,lineNumber:228,columnNumber:11}},w.a.createElement(s.a,{mode:"multiple",allowClear:!0,placeholder:"请选择剧本标签",__source:{fileName:x,lineNumber:233,columnNumber:13}},null==le||null===(d=le.dict_label)||void 0===d?void 0:d.map((function(e){return w.a.createElement(s.a.Option,{key:e.label_value,value:e.label_value,__source:{fileName:x,lineNumber:236,columnNumber:19}},e.label_zh)})))),w.a.createElement(P,{label:"剧本时长/小时",field:"gb_hour",rules:[{type:"number",required:!0}],__source:{fileName:x,lineNumber:243,columnNumber:11}},w.a.createElement(i.a,{min:1,placeholder:"请输入参考价格",__source:{fileName:x,lineNumber:248,columnNumber:13}})),w.a.createElement(P,{label:"工作日价格",field:"gb_price",rules:[{type:"number",required:!0}],__source:{fileName:x,lineNumber:250,columnNumber:11}},w.a.createElement(i.a,{min:1,placeholder:"请输入工作日价格",__source:{fileName:x,lineNumber:255,columnNumber:13}})),w.a.createElement(P,{label:"周末价格",field:"gb_price2",rules:[{type:"number",required:!0}],__source:{fileName:x,lineNumber:257,columnNumber:11}},w.a.createElement(i.a,{min:1,placeholder:"请输入工作日价格",__source:{fileName:x,lineNumber:258,columnNumber:13}})),w.a.createElement(P,{label:"推荐星级",field:"gb_star_lev",rules:[{required:!0,type:"number"}],__source:{fileName:x,lineNumber:260,columnNumber:11}},w.a.createElement(o.a,{allowHalf:!0,__source:{fileName:x,lineNumber:270,columnNumber:13}})),w.a.createElement(P,{label:"剧本概要",field:"gb_text_brief",rules:[{required:!0,message:"请填写剧本概要"}],__source:{fileName:x,lineNumber:272,columnNumber:11}},w.a.createElement(N.a,{placeholder:"请填写剧本概要...",__source:{fileName:x,lineNumber:277,columnNumber:13}})),w.a.createElement(P,{label:"剧本描述",field:"gb_text_content",rules:[{required:!1,message:"请填写剧本描述"}],__source:{fileName:x,lineNumber:279,columnNumber:11}},w.a.createElement(N.a,{placeholder:"请填写剧本描述...",__source:{fileName:x,lineNumber:284,columnNumber:13}})),w.a.createElement(P,{label:"上架时间",field:"gb_add_time",rules:[{required:!1,message:"gb_add_time is required"}],__source:{fileName:x,lineNumber:287,columnNumber:11}},w.a.createElement(c.a,{showTime:!0,__source:{fileName:x,lineNumber:297,columnNumber:13}})),w.a.createElement(P,{label:"是否新本",field:"is_new",rules:[{required:!1,message:"请填写版权信息"}],__source:{fileName:x,lineNumber:299,columnNumber:11}},w.a.createElement(s.a,{placeholder:"是否新本",__source:{fileName:x,lineNumber:304,columnNumber:13}},w.a.createElement(s.a.Option,{value:1,__source:{fileName:x,lineNumber:305,columnNumber:15}},"是"),w.a.createElement(s.a.Option,{value:0,__source:{fileName:x,lineNumber:306,columnNumber:15}},"否"))),w.a.createElement(P,{label:"是否热门",field:"is_hot",rules:[{required:!1,message:"请填写版权信息"}],__source:{fileName:x,lineNumber:309,columnNumber:11}},w.a.createElement(s.a,{placeholder:"是否热门",__source:{fileName:x,lineNumber:314,columnNumber:13}},w.a.createElement(s.a.Option,{value:1,__source:{fileName:x,lineNumber:315,columnNumber:15}},"是"),w.a.createElement(s.a.Option,{value:0,__source:{fileName:x,lineNumber:316,columnNumber:15}},"否"))),w.a.createElement(P,{label:"版权信息",field:"gb_producer",rules:[{required:!0,message:"请填写版权信息"}],__source:{fileName:x,lineNumber:319,columnNumber:11}},w.a.createElement(N.a,{placeholder:"请填写版权信息...",__source:{fileName:x,lineNumber:324,columnNumber:13}})),w.a.createElement(P,{label:"备注说明",field:"gb_remarks",rules:[{required:!1,message:"请填写备注说明"}],__source:{fileName:x,lineNumber:327,columnNumber:11}},w.a.createElement(N.a,{placeholder:"请填写备注说明...",__source:{fileName:x,lineNumber:332,columnNumber:13}})),w.a.createElement(P,t()({},R,{__source:{fileName:x,lineNumber:335,columnNumber:11}}),w.a.createElement(n.a,{onClick:g()(y.a.mark((function e(){var r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!k.current){e.next=27;break}return console.log(k.current.getFields()),e.prev=2,e.next=5,k.current.validate();case 5:if(console.log(k.current.getFields()),(r=k.current.getFields()).gb_cover=r.gb_cover[0].url||r.gb_cover[0].response.data.file_url,"edit"!==E){e.next=16;break}return e.next=11,Object(q.j)(r);case 11:return 200===e.sent.code&&(m.a.success("修改成功"),O()),e.abrupt("return");case 16:return e.next=18,Object(q.b)(r);case 18:200===e.sent.code&&(m.a.success("添加成功"),O());case 20:e.next=27;break;case 22:e.prev=22,e.t0=e.catch(2),console.log(e.t0),console.log("formRef.current.getFieldsError()",k.current.getFieldsError()),m.a.error("校验失败，请检查字段！");case 27:case"end":return e.stop()}}),e,null,[[2,22]])}))),type:"primary",style:{marginRight:24},__source:{fileName:x,lineNumber:336,columnNumber:13}},"Submit"),w.a.createElement(n.a,{onClick:function(){k.current.resetFields()},__source:{fileName:x,lineNumber:376,columnNumber:13}},"Reset"))))," ")}}}]);