(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{187:function(e,r,n){"use strict";n.r(r);n(112);var t=n(45),a=n(5),l=n.n(a),c=(n(155),n(82)),u=(n(65),n(24)),o=n(673),m=(n(113),n(40)),i=(n(331),n(251)),s=(n(156),n(74)),b=(n(248),n(96)),f=(n(174),n(85)),N=n(56),_=n.n(N),d=n(22),p=n.n(d),g=(n(247),n(73)),h=n(35),v=n.n(h),E=n(0),y=n.n(E),O=n(111),j=n(83),w=n(167),k=n.n(w),S="/Users/mrhh/Desktop/gbs-admin/src/pages/store-game/form/index.jsx",x=g.a.Item,C={labelCol:{span:7},wrapperCol:{span:17}},I={wrapperCol:{span:17,offset:7}};r.default=function(e){var r=e.closeModalAndReqTable,n=e.clickItem,a=Object(E.useRef)(),N=Object(E.useState)([]),d=p()(N,2),h=d[0],w=d[1],F=Object(E.useState)(!0),q=p()(F,2),P=q[0],D=q[1],R=Object(E.useState)([]),V=p()(R,2),z=(V[0],V[1]),L=Object(E.useState)([]),A=p()(L,2),H=A[0],M=A[1],J=Object(E.useState)(localStorage.getItem("nowshop")),T=p()(J,2),W=T[0],B=T[1],U=Object(E.useState)([]),G=p()(U,2),K=G[0],Q=G[1],X=Object(E.useState)(!1),Y=p()(X,2),Z=Y[0],$=Y[1],ee=Object(E.useState)([]),re=p()(ee,2),ne=re[0],te=re[1],ae=Object(E.useState)(!1),le=p()(ae,2),ce=le[0],ue=le[1],oe=Object(E.useState)(""),me=p()(oe,2),ie=me[0],se=me[1],be=Object(E.useState)(""),fe=p()(be,2),Ne=fe[0],_e=fe[1],de=Object(E.useState)([]),pe=p()(de,2),ge=pe[0],he=pe[1],ve=Object(E.useState)(!1),Ee=p()(ve,2),ye=Ee[0],Oe=Ee[1],je=Object(E.useRef)(null);Object(E.useEffect)((function(){console.log("clickItem",n)}),[]),Object(E.useEffect)((function(){Object(O.x)().then((function(e){var r,n=e.data;r=n.map((function(e){return function e(r){var n=Array.isArray(r.region_children)&&r.region_children.length>0;return{key:String(r.region_id),value:String(r.region_id),label:r.region_name,children:n?r.region_children.map((function(r){return e(r)})):[]}}(e)})),z(r)}))}),[]);var we=function(){var e=_()(v.a.mark((function e(){var r,n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(O.N)();case 2:r=e.sent,n=r.data,D(!1),w(n);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(E.useEffect)((function(){we()}),[]),Object(E.useEffect)((function(){a.current.setFieldsValue({store_code:localStorage.getItem("nowshop")})}),[]);var ke=Object(E.useCallback)(k()((function(e){je.current=Date.now(),$(!0),Q([]);var r={gb_title:e};Object(O.p)(r).then((function(e){var r=e.data.map((function(e){return{label:y.a.createElement("div",{style:{display:"flex",alignItems:"center"},__source:{fileName:S,lineNumber:120,columnNumber:13}},y.a.createElement(f.a,{shape:"square",size:24,style:{marginLeft:6,marginRight:12},__source:{fileName:S,lineNumber:121,columnNumber:15}},y.a.createElement("img",{alt:"avatar",src:e.gb_cover,__source:{fileName:S,lineNumber:122,columnNumber:17}})),"".concat(e.gb_title)),value:e.gb_code}}));$(!1),Q(r)}))}),500),[]),Se=Object(E.useCallback)(k()((function(e){je.current=Date.now(),ue(!0),Q([]);var r={user_nick:e};Object(j.b)(r).then((function(e){var r=e.data.map((function(e){return{label:y.a.createElement("div",{style:{display:"flex",alignItems:"center"},__source:{fileName:S,lineNumber:145,columnNumber:13}},y.a.createElement(f.a,{size:24,style:{marginLeft:6,marginRight:12},__source:{fileName:S,lineNumber:146,columnNumber:15}},y.a.createElement("img",{alt:"avatar",src:e.user_photo,__source:{fileName:S,lineNumber:147,columnNumber:17}})),"".concat(e.user_nick)),value:e.user_account}}));ue(!1),te(r)}))}),500),[]),xe=Object(E.useCallback)(k()((function(e){je.current=Date.now(),$(!0),Q([]);var r={member_name:e};Object(j.e)(r).then((function(e){console.log("data: ",e);var r=e.data.map((function(e){return{label:y.a.createElement("div",{style:{display:"flex",alignItems:"center"},__source:{fileName:S,lineNumber:171,columnNumber:13}},y.a.createElement(f.a,{size:24,style:{marginLeft:6,marginRight:12},__source:{fileName:S,lineNumber:172,columnNumber:15}},y.a.createElement("img",{alt:"avatar",src:e.member_face,__source:{fileName:S,lineNumber:173,columnNumber:17}})),"".concat(e.member_name)),value:e.member_account}}));Oe(!1),console.log("options",r),he(r)}))}),500),[]);Object(E.useEffect)((function(){ke(),xe(),Se()}),[]);var Ce=function(){var e=_()(v.a.mark((function e(){var r,n,t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={store_code:W},e.next=3,Object(O.g)(r);case 3:n=e.sent,t=n.data.store_room,M(t);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(E.useEffect)((function(){Ce()}),[W]),y.a.createElement("div",{style:{maxWidth:650},__source:{fileName:S,lineNumber:208,columnNumber:5}},y.a.createElement(g.a,l()({ref:a},C,{size:"default",onSubmit:function(e){console.log(e)},onValuesChange:function(e,r){console.log("onValuesChange: ",e,r)},scrollToFirstError:!0,__source:{fileName:S,lineNumber:209,columnNumber:7}}),y.a.createElement(x,{label:"选择店铺",field:"store_code",rules:[{required:!0,message:"请填写店铺编码"}],__source:{fileName:S,lineNumber:219,columnNumber:9}},y.a.createElement(b.a,{onChange:function(){var e=_()(v.a.mark((function e(r){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:B(r);case 1:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),loading:P,placeholder:"请选择店铺",__source:{fileName:S,lineNumber:224,columnNumber:11}},null==h?void 0:h.map((function(e){return y.a.createElement(b.a.Option,{key:e.store_code,value:e.store_code,__source:{fileName:S,lineNumber:233,columnNumber:17}},e.store_name)})))),y.a.createElement(x,{label:"选择房间",field:"room_code",rules:[{required:!0,message:"请填写店铺编码"}],__source:{fileName:S,lineNumber:240,columnNumber:9}},y.a.createElement(b.a,{placeholder:"请选择房间",__source:{fileName:S,lineNumber:245,columnNumber:11}},H.map((function(e){return y.a.createElement(b.a.Option,{key:e.room_code,value:e.room_code,__source:{fileName:S,lineNumber:248,columnNumber:17}},e.room_name)})))),y.a.createElement(x,{label:"剧本",field:"gb_code",rules:[{required:!0,message:"请选择剧本"}],__source:{fileName:S,lineNumber:256,columnNumber:9}},y.a.createElement(b.a,{onChange:function(){var e=_()(v.a.mark((function e(r){var n,t,l,c,u;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={gb_code:r,store_code:W},e.next=3,Object(O.t)(n);case 3:t=e.sent,l=t.data,c=l.gb_price,u=l.gb_price2,se(c),_e(u),a.current.setFieldsValue({gb_price:0===l.is_leisure?l.gb_price:l.gb_price2}),console.log("data: ",l);case 10:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),style:{width:345},options:K,placeholder:"请输入要搜索的剧本",filterOption:!1,renderFormat:function(e){return e.children.props.children[1]},notFoundContent:Z?y.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},__source:{fileName:S,lineNumber:286,columnNumber:17}},y.a.createElement(s.a,{style:{margin:12},__source:{fileName:S,lineNumber:287,columnNumber:19}})):null,showSearch:!0,onSearch:ke,__source:{fileName:S,lineNumber:257,columnNumber:11}})),ie&&y.a.createElement(x,{label:"参考价格",__source:{fileName:S,lineNumber:296,columnNumber:11}},y.a.createElement("span",{__source:{fileName:S,lineNumber:297,columnNumber:13}},"工作日:¥",ie),"    ",y.a.createElement("span",{__source:{fileName:S,lineNumber:298,columnNumber:13}},"周末:¥",Ne)),y.a.createElement(x,{label:"剧本价格",field:"gb_price",rules:[{required:!0,message:"请填写剧本价格"}],__source:{fileName:S,lineNumber:302,columnNumber:9}},y.a.createElement(i.a,{min:0,placeholder:"请填写剧本价格...",__source:{fileName:S,lineNumber:307,columnNumber:11}})),y.a.createElement(x,{label:"玩家人数",field:"game_people",rules:[{required:!0,message:"请填写玩家人数"}],__source:{fileName:S,lineNumber:310,columnNumber:9}},y.a.createElement(i.a,{min:2,placeholder:"请填写玩家人数...",__source:{fileName:S,lineNumber:315,columnNumber:11}})),y.a.createElement(x,{label:"主持人",field:"dm_user",rules:[{required:!0,message:"请填写主持人"}],__source:{fileName:S,lineNumber:317,columnNumber:9}},y.a.createElement(b.a,{style:{width:345},options:ne,placeholder:"请选择主持人",filterOption:!1,renderFormat:function(e){return e.children.props.children[1]},notFoundContent:ce?y.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},__source:{fileName:S,lineNumber:332,columnNumber:17}},y.a.createElement(s.a,{style:{margin:12},__source:{fileName:S,lineNumber:333,columnNumber:19}})):null,showSearch:!0,onSearch:Se,__source:{fileName:S,lineNumber:322,columnNumber:11}})),y.a.createElement(g.a.List,{field:"game_player",__source:{fileName:S,lineNumber:342,columnNumber:9}},(function(e,r){var n=r.add,t=r.remove;r.move;return y.a.createElement("div",{__source:{fileName:S,lineNumber:345,columnNumber:15}},e.map((function(e,r){return y.a.createElement("div",{key:e.key,__source:{fileName:S,lineNumber:348,columnNumber:21}},y.a.createElement(g.a.Item,{label:"玩家".concat(1+r),__source:{fileName:S,lineNumber:349,columnNumber:23}},y.a.createElement(c.a,{__source:{fileName:S,lineNumber:350,columnNumber:25}},y.a.createElement(g.a.Item,{field:"".concat(e.field,".player_user"),rules:[{required:!0}],noStyle:!0,__source:{fileName:S,lineNumber:351,columnNumber:27}},y.a.createElement(b.a,{style:{width:145},options:ge,placeholder:"请选择玩家",filterOption:!1,renderFormat:function(e){return e.children.props.children[1]},notFoundContent:ye?y.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},__source:{fileName:S,lineNumber:366,columnNumber:35}},y.a.createElement(s.a,{style:{margin:12},__source:{fileName:S,lineNumber:373,columnNumber:37}})):null,showSearch:!0,onSearch:xe,__source:{fileName:S,lineNumber:356,columnNumber:29}})),y.a.createElement(g.a.Item,{field:"".concat(e.field,".player_type"),rules:[{required:!0}],noStyle:!0,__source:{fileName:S,lineNumber:381,columnNumber:27}},y.a.createElement(b.a,{placeholder:"玩家类型",__source:{fileName:S,lineNumber:386,columnNumber:29}},y.a.createElement(b.a.Option,{value:"player",__source:{fileName:S,lineNumber:387,columnNumber:31}},"player"),y.a.createElement(b.a.Option,{value:"worker",__source:{fileName:S,lineNumber:388,columnNumber:31}},"worker"))),y.a.createElement(g.a.Item,{field:"".concat(e.field,".player_name"),rules:[{required:!0}],noStyle:!0,__source:{fileName:S,lineNumber:392,columnNumber:27}},y.a.createElement(m.a,{placeholder:"玩家名称",__source:{fileName:S,lineNumber:397,columnNumber:29}})),y.a.createElement(g.a.Item,{field:"".concat(e.field,".player_note"),rules:[{required:!0}],noStyle:!0,__source:{fileName:S,lineNumber:399,columnNumber:27}},y.a.createElement(m.a,{placeholder:"玩家备注",__source:{fileName:S,lineNumber:404,columnNumber:29}})),y.a.createElement(u.a,{icon:y.a.createElement(o.a,{__source:{fileName:S,lineNumber:407,columnNumber:35}}),shape:"circle",status:"danger",onClick:function(){return t(r)},__source:{fileName:S,lineNumber:406,columnNumber:27}}))))})),y.a.createElement(g.a.Item,l()({},I,{__source:{fileName:S,lineNumber:417,columnNumber:17}}),y.a.createElement(u.a,{onClick:function(){n()},__source:{fileName:S,lineNumber:418,columnNumber:19}},"添加玩家")))})),y.a.createElement(x,l()({},I,{__source:{fileName:S,lineNumber:444,columnNumber:9}}),y.a.createElement(u.a,{onClick:_()(v.a.mark((function e(){var l,c,u;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.current){e.next=26;break}return e.prev=1,e.next=4,a.current.validate();case 4:if(null!==n){e.next=12;break}return null!==(l=a.current.getFields()).game_player&&void 0!==l.game_player||(l.game_player=[]),e.next=9,Object(O.i)(l);case 9:c=e.sent,e.next=18;break;case 12:return u=a.current.getFields(),console.log("param: ",u),u.store_code=n.store_code,e.next=17,Object(O.P)(u);case 17:c=e.sent;case 18:200===c.code&&(t.a.success("添加成功"),r()),e.next=26;break;case 21:e.prev=21,e.t0=e.catch(1),console.log(e.t0),console.log(a.current.getFieldsError()),t.a.error("校验失败，请检查字段！");case 26:case"end":return e.stop()}}),e,null,[[1,21]])}))),type:"primary",style:{marginRight:24},__source:{fileName:S,lineNumber:445,columnNumber:11}},"提交"),y.a.createElement(u.a,{onClick:function(){a.current.resetFields()},__source:{fileName:S,lineNumber:479,columnNumber:11}},"重置"))))}},673:function(e,r,n){"use strict";var t=n(5),a=n.n(t),l=n(4),c=n.n(l),u=n(0),o=n.n(u),m=n(6);function i(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function s(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?i(Object(n),!0).forEach((function(r){c()(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}function b(e,r){var n=Object(u.useContext)(m.a).prefixCls,t=e.spin,l=e.className,c=s(s({ref:r},e),{},{className:"".concat(l?l+" ":"").concat(n,"-icon ").concat(n,"-icon-delete")});return t&&(c.className="".concat(c.className," ").concat(n,"-icon-loading")),delete c.spin,delete c.isIcon,o.a.createElement("svg",a()({fill:"none",stroke:"currentColor",strokeWidth:"4",viewBox:"0 0 48 48",width:"1em",height:"1em"},c),o.a.createElement("path",{d:"M5 11h5.5m0 0v29a1 1 0 0 0 1 1h25a1 1 0 0 0 1-1V11m-27 0H16m21.5 0H43m-5.5 0H32m-16 0V7h16v4m-16 0h16M20 18v15m8-15v15"}))}var f=o.a.forwardRef(b);f.defaultProps={isIcon:!0},f.displayName="IconDelete",r.a=f}}]);