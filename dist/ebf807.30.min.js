(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{160:function(e,l,r){"use strict";r.r(l);var a=r(7),u=r.n(a),t=(r(77),r(28)),n=(r(149),r(59)),m=r(78),c=r.n(m),o=(r(591),r(589)),i=(r(607),r(611)),s=(r(295),r(220)),b=(r(219),r(89)),_=(r(608),r(610)),N=(r(576),r(579)),d=(r(148),r(49)),f=r(5),p=r.n(f),g=r(24),E=r.n(g),v=(r(294),r(106)),h=r(50),O=r.n(h),y=r(0),w=r.n(y),q=r(218),j="/Users/mrhh/Desktop/gbs-admin/src/pages/stocks-drama/form/index.jsx";function k(e,l){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);l&&(a=a.filter((function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable}))),r.push.apply(r,a)}return r}function x(e){for(var l=1;l<arguments.length;l++){var r=null!=arguments[l]?arguments[l]:{};l%2?k(Object(r),!0).forEach((function(l){p()(e,l,r[l])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(l){Object.defineProperty(e,l,Object.getOwnPropertyDescriptor(r,l))}))}return e}var S=v.a.Item,P={labelCol:{span:7},wrapperCol:{span:17}},R={wrapperCol:{span:17,offset:7}};l.default=function(e){var l,r,a,m,f=e.labelData,p=e.closeModalAndRequest,g=Object(y.useRef)(),h=Object(y.useState)(null),k=E()(h,2),C=(k[0],k[1]),D=Object(y.useState)("default"),F=E()(D,2),z=F[0],T=(F[1],Object(y.useState)([])),I=E()(T,2),J=I[0],L=I[1],H=Object(y.useState)([]),U=E()(H,2),V=U[0],A=U[1],M=Object(y.useState)([]),W=E()(M,2),X=(W[0],W[1]),B=Object(y.useState)([]),G=E()(B,2),K=G[0],Q=G[1],Y=Object(y.useState)([]),Z=E()(Y,2),$=Z[0],ee=Z[1];return Object(y.useEffect)((function(){for(var e=0;e<f.length;e++){var l=f[e];"app_gb_type"===l.dict_code&&L(l),"app_gb_level"===l.dict_code&&A(l),"app_gb_people"===l.dict_code&&X(l),"app_gb_text_tag"===l.dict_code&&Q(l),"app_gb_status"===l.dict_code&&ee(l)}}),[]),w.a.createElement("div",{style:{maxWidth:650},__source:{fileName:j,lineNumber:75,columnNumber:5}},w.a.createElement(v.a,u()({ref:g},P,{size:z,onSubmit:function(e){var l=x(x({},e),{},{gb_cover:e.gb_cover.response.data.file_url});console.log(l)},onValuesChange:function(e,l){console.log("onValuesChange: ",e,l)},scrollToFirstError:!0,__source:{fileName:j,lineNumber:76,columnNumber:7}}),w.a.createElement(S,{label:"剧本名称",field:"gb_title",rules:[{required:!0,message:"请填写剧本名称"}],__source:{fileName:j,lineNumber:90,columnNumber:9}},w.a.createElement(d.a,{placeholder:"请填写剧本名称...",__source:{fileName:j,lineNumber:95,columnNumber:11}})),w.a.createElement(v.a.Item,{rules:[{required:!0,message:"请上传剧本封面"}],label:"剧本封面",field:"gb_cover",triggerPropName:"fileList",initialValue:[{uid:"1",url:"//p1-arco.byteimg.com/tos-cn-i-uwbnlip3yd/e278888093bef8910e829486fb45dd69.png~tplv-uwbnlip3yd-webp.webp",name:"20200717"}],__source:{fileName:j,lineNumber:97,columnNumber:9}},w.a.createElement(_.a,{limit:1,listType:"picture-card",multiple:!0,name:"gb_cover",customRequest:function(e){var l=e.onProgress,r=e.onError,a=e.onSuccess,u=e.file,t=new XMLHttpRequest;t.upload&&(t.upload.onprogress=function(e){var r;e.total>0&&(r=e.loaded/e.total*100),l(parseInt(r,10),e)}),t.onerror=function(e){r(e)},t.onload=function(){if(t.status<200||t.status>=300)return r(t.responseText);C(JSON.parse(t.responseText)),a(JSON.parse(t.responseText),t)};var n=new FormData;n.append("up_file",u),n.append("module","drama"),t.open("post","https://gbs.toptian.com/system/upload/image",!0),t.setRequestHeader("Authorization",localStorage.getItem("token")),t.send(n)},onPreview:function(e){N.a.info({title:"Preview",content:w.a.createElement("img",{src:e.url||URL.createObjectURL(e.originFile),style:{maxWidth:"100%"},__source:{fileName:j,lineNumber:149,columnNumber:19}})})},__source:{fileName:j,lineNumber:111,columnNumber:11}})),w.a.createElement(S,{label:"剧本类型",field:"gb_type",rules:[{required:!0,message:"请填写剧本类型"}],__source:{fileName:j,lineNumber:158,columnNumber:9}},w.a.createElement(b.a,{placeholder:"请选择剧本类型",__source:{fileName:j,lineNumber:163,columnNumber:11}},null==J||null===(l=J.dict_label)||void 0===l?void 0:l.map((function(e){return w.a.createElement(b.a.Option,{key:e.label_value,value:e.label_value,__source:{fileName:j,lineNumber:166,columnNumber:17}},e.label_zh)})))),w.a.createElement(S,{label:"剧本难度",field:"gb_level",rules:[{required:!0,message:"请选中剧本难度"}],__source:{fileName:j,lineNumber:173,columnNumber:9}},w.a.createElement(b.a,{placeholder:"请选择剧本难度",__source:{fileName:j,lineNumber:178,columnNumber:11}},null==V||null===(r=V.dict_label)||void 0===r?void 0:r.map((function(e){return w.a.createElement(b.a.Option,{key:e.label_value,value:e.label_value,__source:{fileName:j,lineNumber:181,columnNumber:17}},e.label_zh)})))),w.a.createElement(S,{label:"玩家人数",field:"gb_people",rules:[{required:!0,message:"请填写玩家说明"}],__source:{fileName:j,lineNumber:189,columnNumber:9}},w.a.createElement(s.a,{placeholder:"请填写玩家说明...",__source:{fileName:j,lineNumber:194,columnNumber:11}})),w.a.createElement(S,{label:"剧本状态",field:"gb_status",rules:[{required:!1,message:"请选择剧本状态"}],__source:{fileName:j,lineNumber:197,columnNumber:9}},w.a.createElement(b.a,{placeholder:"请选择剧本状态",__source:{fileName:j,lineNumber:202,columnNumber:11}},null==$||null===(a=$.dict_label)||void 0===a?void 0:a.map((function(e){return w.a.createElement(b.a.Option,{key:e.label_value,value:e.label_value,__source:{fileName:j,lineNumber:205,columnNumber:17}},e.label_zh)})))),w.a.createElement(S,{label:"玩家说明",field:"gb_people_note",rules:[{required:!0,message:"请填写玩家说明"}],__source:{fileName:j,lineNumber:214,columnNumber:9}},w.a.createElement(d.a,{placeholder:"请填写玩家说明...",__source:{fileName:j,lineNumber:219,columnNumber:11}})),w.a.createElement(S,{label:"剧本标签",field:"gb_text_tag_arr",rules:[{required:!0,message:"请选择剧本标签"}],__source:{fileName:j,lineNumber:221,columnNumber:9}},w.a.createElement(b.a,{mode:"multiple",allowClear:!0,placeholder:"请选择剧本标签",__source:{fileName:j,lineNumber:226,columnNumber:11}},null==K||null===(m=K.dict_label)||void 0===m?void 0:m.map((function(e){return w.a.createElement(b.a.Option,{key:e.label_value,value:e.label_value,__source:{fileName:j,lineNumber:229,columnNumber:17}},e.label_zh)})))),w.a.createElement(S,{label:"剧本时长/小时",field:"gb_hour",rules:[{type:"number",required:!0}],__source:{fileName:j,lineNumber:237,columnNumber:9}},w.a.createElement(s.a,{min:1,placeholder:"请输入参考价格",__source:{fileName:j,lineNumber:242,columnNumber:11}})),w.a.createElement(S,{label:"工作日价格",field:"gb_price",rules:[{type:"number",required:!0}],__source:{fileName:j,lineNumber:244,columnNumber:9}},w.a.createElement(s.a,{min:1,placeholder:"请输入工作日价格",__source:{fileName:j,lineNumber:245,columnNumber:11}})),w.a.createElement(S,{label:"周末价格",field:"gb_price2",rules:[{type:"number",required:!0}],__source:{fileName:j,lineNumber:247,columnNumber:9}},w.a.createElement(s.a,{min:1,placeholder:"请输入工作日价格",__source:{fileName:j,lineNumber:248,columnNumber:11}})),w.a.createElement(S,{label:"推荐星级",field:"gb_star_lev",rules:[{required:!0,type:"number"}],__source:{fileName:j,lineNumber:251,columnNumber:9}},w.a.createElement(i.a,{allowHalf:!0,__source:{fileName:j,lineNumber:261,columnNumber:11}})),w.a.createElement(S,{label:"剧本概要",field:"gb_text_brief",rules:[{required:!0,message:"请填写剧本概要"}],__source:{fileName:j,lineNumber:263,columnNumber:9}},w.a.createElement(d.a,{placeholder:"请填写剧本概要...",__source:{fileName:j,lineNumber:268,columnNumber:11}})),w.a.createElement(S,{label:"剧本描述",field:"gb_text_content",rules:[{required:!1,message:"请填写剧本描述"}],__source:{fileName:j,lineNumber:270,columnNumber:9}},w.a.createElement(d.a,{placeholder:"请填写剧本描述...",__source:{fileName:j,lineNumber:275,columnNumber:11}})),w.a.createElement(S,{label:"上架时间",field:"gb_add_time",rules:[{required:!1,message:"gb_add_time is required"}],__source:{fileName:j,lineNumber:278,columnNumber:9}},w.a.createElement(o.a,{showTime:!0,__source:{fileName:j,lineNumber:288,columnNumber:11}})),w.a.createElement(S,{label:"是否新本",field:"is_new",rules:[{required:!1,message:"请填写版权信息"}],__source:{fileName:j,lineNumber:290,columnNumber:9}},w.a.createElement(b.a,{placeholder:"是否新本",__source:{fileName:j,lineNumber:295,columnNumber:11}},w.a.createElement(b.a.Option,{value:1,__source:{fileName:j,lineNumber:296,columnNumber:13}},"是"),w.a.createElement(b.a.Option,{value:0,__source:{fileName:j,lineNumber:297,columnNumber:13}},"否"))),w.a.createElement(S,{label:"是否热门",field:"is_hot",rules:[{required:!1,message:"请填写版权信息"}],__source:{fileName:j,lineNumber:300,columnNumber:9}},w.a.createElement(b.a,{placeholder:"是否热门",__source:{fileName:j,lineNumber:305,columnNumber:11}},w.a.createElement(b.a.Option,{value:1,__source:{fileName:j,lineNumber:306,columnNumber:13}},"是"),w.a.createElement(b.a.Option,{value:0,__source:{fileName:j,lineNumber:307,columnNumber:13}},"否"))),w.a.createElement(S,{label:"版权信息",field:"gb_producer",rules:[{required:!0,message:"请填写版权信息"}],__source:{fileName:j,lineNumber:310,columnNumber:9}},w.a.createElement(d.a,{placeholder:"请填写版权信息...",__source:{fileName:j,lineNumber:315,columnNumber:11}})),w.a.createElement(S,{label:"备注说明",field:"gb_remarks",rules:[{required:!1,message:"请填写备注说明"}],__source:{fileName:j,lineNumber:318,columnNumber:9}},w.a.createElement(d.a,{placeholder:"请填写备注说明...",__source:{fileName:j,lineNumber:323,columnNumber:11}})),w.a.createElement(S,u()({},R,{__source:{fileName:j,lineNumber:392,columnNumber:9}}),w.a.createElement(t.a,{onClick:c()(O.a.mark((function e(){var l;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!g.current){e.next=17;break}return e.prev=1,e.next=4,g.current.validate();case 4:return console.log(g.current.getFields()),(l=g.current.getFields()).gb_cover=l.gb_cover[0].response.data.file_url,e.next=9,Object(q.b)(l);case 9:200===e.sent.code&&(n.a.success("添加成功"),p()),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),console.log(g.current.getFieldsError()),n.a.error("校验失败，请检查字段！");case 17:case"end":return e.stop()}}),e,null,[[1,13]])}))),type:"primary",style:{marginRight:24},__source:{fileName:j,lineNumber:393,columnNumber:11}},"Submit"),w.a.createElement(t.a,{onClick:function(){g.current.resetFields()},__source:{fileName:j,lineNumber:417,columnNumber:11}},"Reset"))))}}}]);