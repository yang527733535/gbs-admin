(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{172:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return x}));n(154);var a=n(82),r=(n(112),n(39)),l=(n(656),n(655)),o=(n(159),n(67)),c=(n(652),n(653)),u=(n(64),n(24)),i=(n(111),n(45)),s=n(65),m=n.n(s),b=(n(349),n(256)),d=n(22),f=n.n(d),p=(n(245),n(96)),_=n(44),g=n.n(_),N=n(0),v=n.n(N),h=n(243),y=n(675),E="/Users/mrhh/Desktop/gbs-admin/src/pages/stocks-store/storeDetail/storeDrama/index.tsx",O=p.a.Option;function x(e){var t=e.store_code,n=e.getStoreDetail,s=e.storeDetailInfo,d=s.store_drama,_=Object(N.useState)([]),x=f()(_,2),j=x[0],C=x[1],S=Object(N.useState)(!1),w=f()(S,2),k=w[0],I=w[1],P=Object(N.useState)({current:1,pageSize:10,total:1111}),T=f()(P,2),z=T[0],V=T[1],D=Object(N.useState)(d),B=f()(D,2),H=B[0],F=B[1],J=Object(N.useState)({}),L=f()(J,2),G=L[0],K=L[1],R=Object(N.useState)([]),U=f()(R,2),W=U[0],q=U[1],A=Object(N.useState)([]),M=f()(A,2),Q=M[0],X=M[1],Y=Object(N.useState)([]),Z=f()(Y,2),$=Z[0],ee=Z[1],te=Object(N.useState)([]),ne=f()(te,2),ae=ne[0],re=ne[1],le=Object(N.useState)(),oe=f()(le,2),ce=oe[0],ue=oe[1],ie=Object(N.useState)(),se=f()(ie,2),me=se[0],be=se[1],de=Object(N.useState)(),fe=f()(de,2),pe=fe[0],_e=fe[1],ge=Object(N.useState)(),Ne=f()(ge,2),ve=Ne[0],he=Ne[1],ye=Object(N.useState)(),Ee=f()(ye,2),Oe=Ee[0],xe=Ee[1],je=Object(N.useState)(),Ce=f()(je,2),Se=Ce[0],we=Ce[1];Object(N.useEffect)((function(){var e=Object(y.a)("app_gb_type"),t=new Object;e.forEach((function(e){t[e.label_value]=e.label_zh})),K(t)}),[]),Object(N.useEffect)((function(){JSON.parse(localStorage.getItem("dicts")).forEach((function(e){"app_gb_type"===e.dict_code&&q(e.dict_label),"app_gb_text_tag"===e.dict_code&&ee(e.dict_label),"app_gb_status"===e.dict_code&&X(e.dict_label),"app_gb_status"===e.dict_code&&X(e.dict_label),"app_gb_level"===e.dict_code&&re(e.dict_label)}))}),[]),Object(N.useEffect)((function(){var e=s.store_drama;F(e)}),[s]);var ke=Object(N.useState)([]),Ie=f()(ke,2),Pe=Ie[0],Te=Ie[1];Object(N.useEffect)((function(){var e=s.store_drama.reduce((function(e,t){return e.push(t.gb_code),e}),[]);Te(e)}),[n]),Object(N.useEffect)((function(){De()}),[]);var ze=[{title:"剧本标题",dataIndex:"gb_title"},{title:"剧本类型",dataIndex:"gb_type",render:function(e){return v.a.createElement("span",{__source:{fileName:E,lineNumber:102,columnNumber:16}},G[e])}},{title:"价格",dataIndex:"gb_price"},{title:"是否启用",dataIndex:"is_enable",render:function(e){return 1===parseInt(e)?v.a.createElement(b.a,{status:"success",text:"启用中",__source:{fileName:E,lineNumber:114,columnNumber:18}}):0===parseInt(e)?v.a.createElement(b.a,{status:"error",text:"未启用",__source:{fileName:E,lineNumber:117,columnNumber:18}}):void 0}},{title:"剧本标签",dataIndex:"gb_custom_tag"},{title:"是否新本",dataIndex:"is_new",render:function(e){return 1===parseInt(e)?"是":"否"}},{title:"是否热门",dataIndex:"is_hot",render:function(e){return 1===parseInt(e)?"是":"否"}},{title:"剧本难度",dataIndex:"gb_level"},{title:"剧本时长",dataIndex:"gb_hour",render:function(e){return e+"小时"}},{title:"玩家人数",dataIndex:"gb_people"},{title:"上架时间",dataIndex:"gb_add_time"},{title:"操作",render:function(e,a){return v.a.createElement(u.a,{disabled:Pe.includes(a.gb_code),onClick:m()(g.a.mark((function e(){var r,l;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new Object).store_code=t.store_code,r.drama_array=[{gb_code:a.gb_code,gb_price:a.gb_price}],e.next=5,Object(h.G)(r);case 5:l=e.sent,console.log("res: ",l),200===l.code&&(n(),i.a.success("添加成功"));case 8:case"end":return e.stop()}}),e)}))),size:"mini",type:"primary",__source:{fileName:E,lineNumber:170,columnNumber:11}},"添加")}}],Ve=[{title:"剧本标题",dataIndex:"gb_title"},{title:"剧本类型",dataIndex:"gb_type",render:function(e){return v.a.createElement("span",{__source:{fileName:E,lineNumber:209,columnNumber:16}},G[e])}},{title:"剧本标签",dataIndex:"gb_text_tag"},{title:"操作",render:function(e,a){return v.a.createElement(c.a,{title:"确定删除该剧本",onOk:m()(g.a.mark((function e(){var r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(a),r={store_code:t.store_code,gb_code:a.gb_code},e.next=4,Object(h.D)(r);case 4:200===e.sent.code&&(n(),i.a.success("删除成功"));case 6:case"end":return e.stop()}}),e)}))),__source:{fileName:E,lineNumber:220,columnNumber:11}},v.a.createElement(u.a,{size:"mini",status:"danger",__source:{fileName:E,lineNumber:235,columnNumber:13}},"删除"))}}];function De(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};console.log("params: ",n);var a=Object(h.n)({page:e,page_size:t,gb_title:ce,gb_people:me,gb_type:pe,gb_status:Se,gb_text_tag:ve,gb_level:Oe});I(!0),a.then((function(e){I(!1);var t=e.data,n=e.paginator;V({current:n.page,pageSize:n.page_size,total:n.total_count}),C(t)}))}return v.a.createElement("div",{__source:{fileName:E,lineNumber:274,columnNumber:5}},v.a.createElement("div",{__source:{fileName:E,lineNumber:275,columnNumber:7}},v.a.createElement(o.a.Title,{heading:4,__source:{fileName:E,lineNumber:276,columnNumber:9}},"已添加的剧本"),v.a.createElement(l.a,{size:"small",columns:Ve,data:H,__source:{fileName:E,lineNumber:277,columnNumber:9}})),v.a.createElement("div",{__source:{fileName:E,lineNumber:279,columnNumber:7}},v.a.createElement(o.a.Title,{heading:4,__source:{fileName:E,lineNumber:280,columnNumber:9}},"剧本库"),v.a.createElement("div",{style:{width:"100%",marginBottom:10,display:"flex",justifyContent:"flex-ends"},__source:{fileName:E,lineNumber:281,columnNumber:9}},v.a.createElement(a.a,{style:{flex:1},wrap:!0,__source:{fileName:E,lineNumber:284,columnNumber:11}},v.a.createElement(r.a,{value:ce,onChange:function(e){ue(e)},placeholder:"请输入剧本标题",style:{width:200},__source:{fileName:E,lineNumber:285,columnNumber:13}}),v.a.createElement(r.a,{onChange:function(e){be(e)},value:me,placeholder:"玩家人数",style:{width:200},__source:{fileName:E,lineNumber:293,columnNumber:13}}),v.a.createElement(p.a,{onChange:function(e){_e(e)},value:pe,placeholder:"剧本类型",style:{width:200},__source:{fileName:E,lineNumber:301,columnNumber:13}},W.map((function(e){return v.a.createElement(O,{key:e.label_value,value:e.label_value,__source:{fileName:E,lineNumber:311,columnNumber:19}},e.label_zh)}))),v.a.createElement(p.a,{onChange:function(e){xe(e)},value:Oe,placeholder:"剧本难度",style:{width:200},__source:{fileName:E,lineNumber:317,columnNumber:13}},ae.map((function(e){return v.a.createElement(O,{key:e.label_value,value:e.label_value,__source:{fileName:E,lineNumber:327,columnNumber:19}},e.label_zh)}))),v.a.createElement(p.a,{onChange:function(e){he(e)},value:ve,placeholder:"剧本标签",style:{width:200},__source:{fileName:E,lineNumber:333,columnNumber:13}},$.map((function(e){return v.a.createElement(O,{key:e.label_value,value:e.label_value,__source:{fileName:E,lineNumber:343,columnNumber:19}},e.label_zh)}))),v.a.createElement(p.a,{onChange:function(e){we(e)},value:Se,placeholder:"剧本状态",style:{width:200},__source:{fileName:E,lineNumber:349,columnNumber:13}},Q.map((function(e){return v.a.createElement(O,{key:e.label_value,value:e.label_value,__source:{fileName:E,lineNumber:359,columnNumber:19}},e.label_zh)}))),v.a.createElement(u.a,{onClick:function(){ue(null),_e(null),he(null),be(null),we(null),xe(null)},__source:{fileName:E,lineNumber:365,columnNumber:13}},"重置"),v.a.createElement(u.a,{onClick:function(){De()},type:"primary",__source:{fileName:E,lineNumber:377,columnNumber:13}},"搜索"))),v.a.createElement(l.a,{loading:k,onChange:function(e){var t=e.current,n=e.pageSize;V(e),De(t,n)},rowKey:"store_id",size:"mini",pagination:z,data:j,columns:ze,__source:{fileName:E,lineNumber:387,columnNumber:9}})))}},652:function(e,t,n){"use strict";n(17),n(64),n(113),n(329),n(664)},653:function(e,t,n){"use strict";var a=n(0),r=n.n(a),l=n(116),o=n(33),c=n(24),u=n(40),i=n(3),s=n(16),m=n(10),b=function(){return(b=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},d=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},f=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,l=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(a=l.next()).done;)o.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}return o},p={position:"top",okType:"primary",icon:r.a.createElement(u.a,null),blurToHide:!0,unmountOnExit:!0,trigger:"click",escToClose:!0};var _=Object(a.forwardRef)((function(e,t){var n,u=Object(a.useContext)(i.a),_=u.getPrefixCls,g=u.locale,N=u.componentConfig,v=Object(m.a)(e,p,null==N?void 0:N.Popconfirm),h=v.style,y=v.className,E=v.children,O=v.position,x=v.getPopupContainer,j=v.blurToHide,C=v.unmountOnExit,S=v.trigger,w=v.escToClose,k=v.onVisibleChange,I=v.triggerProps,P=v.title,T=v.icon,z=v.okText,V=v.cancelText,D=v.okType,B=v.okButtonProps,H=v.cancelButtonProps,F=v.autoFocus,J=v.focusLock,L=d(v,["style","className","children","position","getPopupContainer","blurToHide","unmountOnExit","trigger","escToClose","onVisibleChange","triggerProps","title","icon","okText","cancelText","okType","okButtonProps","cancelButtonProps","autoFocus","focusLock"]),G=f(Object(s.a)(!1,{defaultValue:v.defaultPopupVisible,value:v.popupVisible}),2),K=G[0],R=G[1],U=f(Object(a.useState)(!1),2),W=U[0],q=U[1],A=_("popconfirm"),M=function(e){"popupVisible"in v||R(e),I&&I.onVisibleChange&&I.onVisibleChange(e),k&&k(e)},Q=function(){M(!1)},X=function(){Q(),v.onCancel&&v.onCancel()},Y=function(){var e,t=v.onOk||v.onConfirm;t&&(e=t()),e&&e.then&&(q(!0),e.then((function(){Q()}),(function(e){q(!1),console.error(e)}))),e||Q()};return Object(a.useEffect)((function(){return!K&&W&&q(!1),function(){q(!1)}}),[K]),r.a.createElement(o.a,b({},L,{ref:t,style:b({maxWidth:350},h),className:y,prefixCls:A,getPopupContainer:x,position:O,trigger:S,escToClose:w,popupVisible:K,content:(n=r.a.createElement(r.a.Fragment,null,r.a.createElement(c.a,b({onClick:X,size:"mini"},H),V||g.Popconfirm.cancelText),r.a.createElement(c.a,b({loading:W,onClick:Y,size:"mini",type:D},B),z||g.Popconfirm.okText)),r.a.createElement("div",{className:A+"-wrapper"},r.a.createElement("div",{className:A+"-title"},T&&r.a.createElement("span",{className:A+"-title-icon"},T),r.a.createElement("div",{className:A+"-title-text"},P)),r.a.createElement("div",{className:A+"-btn"},J?r.a.createElement(l.a,{disabled:!K,autoFocus:!!F},n):n))),unmountOnExit:C,blurToHide:j,popupHoverStay:!0,triggerProps:I,onVisibleChange:M,childrenPrefix:A}),"string"==typeof E?r.a.createElement("span",null,E):E)}));_.displayName="Popconfirm",t.a=_},664:function(e,t,n){},675:function(e,t,n){"use strict";function a(e){var t=JSON.parse(localStorage.getItem("dicts")),n=null;return t.forEach((function(t){t.dict_code===e&&(n=t.dict_label)})),n}n.d(t,"a",(function(){return a}))}}]);