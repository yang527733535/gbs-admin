(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{186:function(e,r,n){"use strict";n.r(r);n(112);var t=n(45),a=n(5),l=n.n(a),c=(n(155),n(82)),u=(n(65),n(24)),m=n(664),o=(n(113),n(40)),i=(n(330),n(250)),s=(n(156),n(74)),b=(n(247),n(96)),f=(n(174),n(85)),N=n(56),_=n.n(N),d=n(22),p=n.n(d),g=(n(246),n(73)),h=n(35),y=n.n(h),v=n(0),E=n.n(v),O=n(111),j=n(83),w=n(167),k=n.n(w),S="/Users/mrhh/Desktop/gbs-admin/src/pages/store-game/form/index.jsx",x=g.a.Item,C={labelCol:{span:7},wrapperCol:{span:17}},I={wrapperCol:{span:17,offset:7}};r.default=function(e){var r=e.closeModalAndReqTable,n=e.clickItem,a=Object(v.useRef)(),N=Object(v.useState)([]),d=p()(N,2),h=d[0],w=d[1],q=Object(v.useState)(!0),F=p()(q,2),D=F[0],P=F[1],R=Object(v.useState)([]),z=p()(R,2),L=(z[0],z[1]),M=Object(v.useState)([]),V=p()(M,2),A=V[0],H=V[1],J=Object(v.useState)([]),T=p()(J,2),W=T[0],B=T[1],K=Object(v.useState)(!1),U=p()(K,2),G=U[0],Q=U[1],X=Object(v.useState)([]),Y=p()(X,2),Z=Y[0],$=Y[1],ee=Object(v.useState)(!1),re=p()(ee,2),ne=re[0],te=re[1],ae=Object(v.useState)([]),le=p()(ae,2),ce=le[0],ue=le[1],me=Object(v.useState)(!1),oe=p()(me,2),ie=oe[0],se=oe[1],be=Object(v.useRef)(null);Object(v.useEffect)((function(){console.log("clickItem",n)}),[]),Object(v.useEffect)((function(){Object(O.v)().then((function(e){var r,n=e.data;r=n.map((function(e){return function e(r){var n=Array.isArray(r.region_children)&&r.region_children.length>0;return{key:String(r.region_id),value:String(r.region_id),label:r.region_name,children:n?r.region_children.map((function(r){return e(r)})):[]}}(e)})),L(r)}))}),[]);var fe=function(){var e=_()(y.a.mark((function e(){var r,n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(O.K)();case 2:r=e.sent,n=r.data,P(!1),w(n);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(v.useEffect)((function(){fe()}),[]);var Ne=Object(v.useCallback)(k()((function(e){be.current=Date.now(),Q(!0),B([]);var r={gb_title:e};Object(O.o)(r).then((function(e){var r=e.data.map((function(e){return{label:E.a.createElement("div",{style:{display:"flex",alignItems:"center"},__source:{fileName:S,lineNumber:116,columnNumber:13}},E.a.createElement(f.a,{shape:"square",size:24,style:{marginLeft:6,marginRight:12},__source:{fileName:S,lineNumber:117,columnNumber:15}},E.a.createElement("img",{alt:"avatar",src:e.gb_cover,__source:{fileName:S,lineNumber:118,columnNumber:17}})),"".concat(e.gb_title)),value:e.gb_code}}));Q(!1),B(r)}))}),500),[]),_e=Object(v.useCallback)(k()((function(e){be.current=Date.now(),te(!0),B([]);var r={user_nick:e};Object(j.b)(r).then((function(e){var r=e.data.map((function(e){return{label:E.a.createElement("div",{style:{display:"flex",alignItems:"center"},__source:{fileName:S,lineNumber:141,columnNumber:13}},E.a.createElement(f.a,{size:24,style:{marginLeft:6,marginRight:12},__source:{fileName:S,lineNumber:142,columnNumber:15}},E.a.createElement("img",{alt:"avatar",src:e.user_photo,__source:{fileName:S,lineNumber:143,columnNumber:17}})),"".concat(e.user_nick)),value:e.user_account}}));te(!1),$(r)}))}),500),[]),de=Object(v.useCallback)(k()((function(e){be.current=Date.now(),Q(!0),B([]);var r={member_name:e};Object(j.e)(r).then((function(e){console.log("data: ",e);var r=e.data.map((function(e){return{label:E.a.createElement("div",{style:{display:"flex",alignItems:"center"},__source:{fileName:S,lineNumber:167,columnNumber:13}},E.a.createElement(f.a,{size:24,style:{marginLeft:6,marginRight:12},__source:{fileName:S,lineNumber:168,columnNumber:15}},E.a.createElement("img",{alt:"avatar",src:e.member_face,__source:{fileName:S,lineNumber:169,columnNumber:17}})),"".concat(e.member_name)),value:e.member_account}}));se(!1),console.log("options",r),ue(r)}))}),500),[]);return Object(v.useEffect)((function(){Ne(),de(),_e()}),[]),E.a.createElement("div",{style:{maxWidth:650},__source:{fileName:S,lineNumber:192,columnNumber:5}},E.a.createElement(g.a,l()({ref:a},C,{size:"default",onSubmit:function(e){console.log(e)},onValuesChange:function(e,r){console.log("onValuesChange: ",e,r)},scrollToFirstError:!0,__source:{fileName:S,lineNumber:193,columnNumber:7}}),E.a.createElement(x,{label:"选择店铺",field:"store_code",rules:[{required:!0,message:"请填写店铺编码"}],__source:{fileName:S,lineNumber:203,columnNumber:9}},E.a.createElement(b.a,{onChange:function(){var e=_()(y.a.mark((function e(r){var n,t,a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={store_code:r},e.next=3,Object(O.f)(n);case 3:t=e.sent,a=t.data.store_room,console.log("store_room: ",a),H(a);case 7:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),loading:D,placeholder:"请选择店铺",__source:{fileName:S,lineNumber:208,columnNumber:11}},null==h?void 0:h.map((function(e){return E.a.createElement(b.a.Option,{key:e.store_code,value:e.store_code,__source:{fileName:S,lineNumber:223,columnNumber:17}},e.store_name)})))),E.a.createElement(x,{label:"选择房间",field:"room_code",rules:[{required:!0,message:"请填写店铺编码"}],__source:{fileName:S,lineNumber:230,columnNumber:9}},E.a.createElement(b.a,{placeholder:"请选择房间",__source:{fileName:S,lineNumber:235,columnNumber:11}},A.map((function(e){return E.a.createElement(b.a.Option,{key:e.room_code,value:e.room_code,__source:{fileName:S,lineNumber:238,columnNumber:17}},e.room_name)})))),E.a.createElement(x,{label:"剧本",field:"gb_code",rules:[{required:!0,message:"请选择剧本"}],__source:{fileName:S,lineNumber:246,columnNumber:9}},E.a.createElement(b.a,{style:{width:345},options:W,placeholder:"请输入要搜索的剧本",filterOption:!1,renderFormat:function(e){return e.children.props.children[1]},notFoundContent:G?E.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},__source:{fileName:S,lineNumber:257,columnNumber:17}},E.a.createElement(s.a,{style:{margin:12},__source:{fileName:S,lineNumber:258,columnNumber:19}})):null,showSearch:!0,onSearch:Ne,__source:{fileName:S,lineNumber:247,columnNumber:11}})),E.a.createElement(x,{label:"剧本价格",field:"gb_price",rules:[{required:!0,message:"请填写剧本价格"}],__source:{fileName:S,lineNumber:266,columnNumber:9}},E.a.createElement(i.a,{min:0,placeholder:"请填写剧本价格...",__source:{fileName:S,lineNumber:271,columnNumber:11}})),E.a.createElement(x,{label:"玩家人数",field:"game_people",rules:[{required:!0,message:"请填写玩家人数"}],__source:{fileName:S,lineNumber:273,columnNumber:9}},E.a.createElement(i.a,{min:2,placeholder:"请填写玩家人数...",__source:{fileName:S,lineNumber:278,columnNumber:11}})),E.a.createElement(x,{label:"主持人",field:"dm_user",rules:[{required:!0,message:"请填写主持人"}],__source:{fileName:S,lineNumber:280,columnNumber:9}},E.a.createElement(b.a,{style:{width:345},options:Z,placeholder:"请选择主持人",filterOption:!1,renderFormat:function(e){return e.children.props.children[1]},notFoundContent:ne?E.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},__source:{fileName:S,lineNumber:295,columnNumber:17}},E.a.createElement(s.a,{style:{margin:12},__source:{fileName:S,lineNumber:296,columnNumber:19}})):null,showSearch:!0,onSearch:_e,__source:{fileName:S,lineNumber:285,columnNumber:11}})),E.a.createElement(g.a.List,{field:"game_player",__source:{fileName:S,lineNumber:305,columnNumber:9}},(function(e,r){var n=r.add,t=r.remove;r.move;return E.a.createElement("div",{__source:{fileName:S,lineNumber:308,columnNumber:15}},e.map((function(e,r){return E.a.createElement("div",{key:e.key,__source:{fileName:S,lineNumber:311,columnNumber:21}},E.a.createElement(g.a.Item,{label:"玩家".concat(1+r),__source:{fileName:S,lineNumber:312,columnNumber:23}},E.a.createElement(c.a,{__source:{fileName:S,lineNumber:313,columnNumber:25}},E.a.createElement(g.a.Item,{field:"".concat(e.field,".player_user"),rules:[{required:!0}],noStyle:!0,__source:{fileName:S,lineNumber:314,columnNumber:27}},E.a.createElement(b.a,{style:{width:145},options:ce,placeholder:"请选择玩家",filterOption:!1,renderFormat:function(e){return e.children.props.children[1]},notFoundContent:ie?E.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},__source:{fileName:S,lineNumber:329,columnNumber:35}},E.a.createElement(s.a,{style:{margin:12},__source:{fileName:S,lineNumber:336,columnNumber:37}})):null,showSearch:!0,onSearch:de,__source:{fileName:S,lineNumber:319,columnNumber:29}})),E.a.createElement(g.a.Item,{field:"".concat(e.field,".player_type"),rules:[{required:!0}],noStyle:!0,__source:{fileName:S,lineNumber:344,columnNumber:27}},E.a.createElement(b.a,{placeholder:"玩家类型",__source:{fileName:S,lineNumber:349,columnNumber:29}},E.a.createElement(b.a.Option,{value:"player",__source:{fileName:S,lineNumber:350,columnNumber:31}},"player"),E.a.createElement(b.a.Option,{value:"worker",__source:{fileName:S,lineNumber:351,columnNumber:31}},"worker"))),E.a.createElement(g.a.Item,{field:"".concat(e.field,".player_name"),rules:[{required:!0}],noStyle:!0,__source:{fileName:S,lineNumber:355,columnNumber:27}},E.a.createElement(o.a,{placeholder:"玩家名称",__source:{fileName:S,lineNumber:360,columnNumber:29}})),E.a.createElement(g.a.Item,{field:"".concat(e.field,".player_note"),rules:[{required:!0}],noStyle:!0,__source:{fileName:S,lineNumber:362,columnNumber:27}},E.a.createElement(o.a,{placeholder:"玩家备注",__source:{fileName:S,lineNumber:367,columnNumber:29}})),E.a.createElement(u.a,{icon:E.a.createElement(m.a,{__source:{fileName:S,lineNumber:370,columnNumber:35}}),shape:"circle",status:"danger",onClick:function(){return t(r)},__source:{fileName:S,lineNumber:369,columnNumber:27}}))))})),E.a.createElement(g.a.Item,l()({},I,{__source:{fileName:S,lineNumber:380,columnNumber:17}}),E.a.createElement(u.a,{onClick:function(){n()},__source:{fileName:S,lineNumber:381,columnNumber:19}},"添加玩家")))})),E.a.createElement(x,l()({},I,{__source:{fileName:S,lineNumber:407,columnNumber:9}}),E.a.createElement(u.a,{onClick:_()(y.a.mark((function e(){var l,c,u;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.current){e.next=26;break}return e.prev=1,e.next=4,a.current.validate();case 4:if(null!==n){e.next=12;break}return null!==(l=a.current.getFields()).game_player&&void 0!==l.game_player||(l.game_player=[]),e.next=9,Object(O.h)(l);case 9:c=e.sent,e.next=18;break;case 12:return u=a.current.getFields(),console.log("param: ",u),u.store_code=n.store_code,e.next=17,Object(O.M)(u);case 17:c=e.sent;case 18:200===c.code&&(t.a.success("添加成功"),r()),e.next=26;break;case 21:e.prev=21,e.t0=e.catch(1),console.log(e.t0),console.log(a.current.getFieldsError()),t.a.error("校验失败，请检查字段！");case 26:case"end":return e.stop()}}),e,null,[[1,21]])}))),type:"primary",style:{marginRight:24},__source:{fileName:S,lineNumber:408,columnNumber:11}},"提交"),E.a.createElement(u.a,{onClick:function(){a.current.resetFields()},__source:{fileName:S,lineNumber:442,columnNumber:11}},"重置"))))}},664:function(e,r,n){"use strict";var t=n(5),a=n.n(t),l=n(4),c=n.n(l),u=n(0),m=n.n(u),o=n(6);function i(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function s(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?i(Object(n),!0).forEach((function(r){c()(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}function b(e,r){var n=Object(u.useContext)(o.a).prefixCls,t=e.spin,l=e.className,c=s(s({ref:r},e),{},{className:"".concat(l?l+" ":"").concat(n,"-icon ").concat(n,"-icon-delete")});return t&&(c.className="".concat(c.className," ").concat(n,"-icon-loading")),delete c.spin,delete c.isIcon,m.a.createElement("svg",a()({fill:"none",stroke:"currentColor",strokeWidth:"4",viewBox:"0 0 48 48",width:"1em",height:"1em"},c),m.a.createElement("path",{d:"M5 11h5.5m0 0v29a1 1 0 0 0 1 1h25a1 1 0 0 0 1-1V11m-27 0H16m21.5 0H43m-5.5 0H32m-16 0V7h16v4m-16 0h16M20 18v15m8-15v15"}))}var f=m.a.forwardRef(b);f.defaultProps={isIcon:!0},f.displayName="IconDelete",r.a=f}}]);