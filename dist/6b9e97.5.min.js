(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{161:function(e,r,l){"use strict";l.r(r);l(151);var a=l(69),n=(l(150),l(79)),t=(l(77),l(30)),o=(l(149),l(52)),u=l(78),m=l.n(u),c=(l(617),l(618)),i=(l(595),l(596)),s=(l(225),l(89)),N=(l(148),l(51)),b=(l(227),l(152)),f=(l(305),l(104)),_=l(53),d=l.n(_),p=l(0),E=l.n(p),g=l(224),y="/Users/mrhh/Desktop/gbs-admin/src/pages/stocks-drama/DramaDetail/roleDetail/AddRoleDetailForm/index.tsx",v=f.a.Item,x=b.a.Row,h=b.a.Col;r.default=function(e){var r=e.clickItem,l=e.modalType,u=e.closeModal,b=e.role_array;console.log("modalType: ",l),console.log("clickItem: ",r);var _=Object(p.useRef)();return E.a.createElement(a.a,{style:{width:"100%"},__source:{fileName:y,lineNumber:33,columnNumber:5}},E.a.createElement("div",{__source:{fileName:y,lineNumber:34,columnNumber:7}},E.a.createElement(f.a,{ref:_,onValuesChange:function(e,r){console.log("onValuesChange: ",e,r)},scrollToFirstError:!0,__source:{fileName:y,lineNumber:35,columnNumber:9}},E.a.createElement(x,{className:"grid-demo",style:{marginBottom:10},__source:{fileName:y,lineNumber:36,columnNumber:11}},E.a.createElement(h,{xs:24,sm:24,md:24,lg:24,xl:24,xxl:24,__source:{fileName:y,lineNumber:37,columnNumber:13}},E.a.createElement("div",{__source:{fileName:y,lineNumber:38,columnNumber:15}},E.a.createElement(v,{label:"角色名称",field:"role_name",rules:[{required:!0,message:"请填写角色名称"}],__source:{fileName:y,lineNumber:39,columnNumber:17}},E.a.createElement(N.a,{placeholder:"请填写角色名称...",__source:{fileName:y,lineNumber:44,columnNumber:19}})))),E.a.createElement(h,{xs:24,sm:24,md:24,lg:24,xl:24,xxl:24,__source:{fileName:y,lineNumber:48,columnNumber:13}},E.a.createElement("div",{__source:{fileName:y,lineNumber:49,columnNumber:15}},E.a.createElement(v,{label:"角色简介",field:"role_brief",rules:[{required:!0,message:"请填写角色简介"}],__source:{fileName:y,lineNumber:50,columnNumber:17}},E.a.createElement(N.a,{placeholder:"请填写角色简介...",__source:{fileName:y,lineNumber:55,columnNumber:19}}))))),E.a.createElement(x,{__source:{fileName:y,lineNumber:60,columnNumber:11}},E.a.createElement(h,{xs:24,sm:24,md:24,lg:24,xl:24,xxl:24,__source:{fileName:y,lineNumber:61,columnNumber:13}},E.a.createElement("div",{__source:{fileName:y,lineNumber:62,columnNumber:15}},E.a.createElement(v,{label:"是否凶手",field:"is_murderer",rules:[{required:!1,message:"请选择是否凶手"}],__source:{fileName:y,lineNumber:63,columnNumber:17}},E.a.createElement(s.a,{placeholder:"请选择是否凶手",__source:{fileName:y,lineNumber:68,columnNumber:19}},E.a.createElement(s.a.Option,{value:"1",__source:{fileName:y,lineNumber:69,columnNumber:21}},"是"),E.a.createElement(s.a.Option,{value:"0",__source:{fileName:y,lineNumber:70,columnNumber:21}},"否"))))),E.a.createElement(h,{xs:24,sm:24,md:24,lg:24,xl:24,xxl:24,__source:{fileName:y,lineNumber:75,columnNumber:13}},E.a.createElement("div",{__source:{fileName:y,lineNumber:76,columnNumber:15}},E.a.createElement(v,{label:"角色备注",field:"role_remarks",rules:[{required:!1,message:"请填写角色备注"}],__source:{fileName:y,lineNumber:77,columnNumber:17}},E.a.createElement(N.a,{placeholder:"请填写角色备注...",__source:{fileName:y,lineNumber:82,columnNumber:19}}))))),E.a.createElement(x,{__source:{fileName:y,lineNumber:87,columnNumber:11}},E.a.createElement(h,{xs:24,sm:24,md:24,lg:24,xl:24,xxl:24,__source:{fileName:y,lineNumber:88,columnNumber:13}},E.a.createElement(f.a.Item,{rules:[{required:!0,message:"请上传角色封面"}],label:"角色封面",field:"role_cover",triggerPropName:"fileList",__source:{fileName:y,lineNumber:89,columnNumber:15}},E.a.createElement(c.a,{limit:1,name:"role_cover",customRequest:function(e){var r=e.onProgress,l=e.onError,a=e.onSuccess,n=e.file,t=new XMLHttpRequest;t.upload&&(t.upload.onprogress=function(e){var l;e.total>0&&(l=e.loaded/e.total*100),r(parseInt(l,10),e)}),t.onerror=function(e){l(e)},t.onload=function(){t.status<200||t.status,a(JSON.parse(t.responseText))};var o=new FormData;o.append("up_file",n),o.append("module","drama"),t.open("post","https://gbs.toptian.com/system/upload/image",!0),t.setRequestHeader("Authorization",localStorage.getItem("token")),t.send(o)},onPreview:function(e){i.a.info({title:"Preview",content:E.a.createElement("img",{src:e.url||URL.createObjectURL(e.originFile),style:{maxWidth:"100%"},__source:{fileName:y,lineNumber:130,columnNumber:25}})})},__source:{fileName:y,lineNumber:95,columnNumber:17}})))),E.a.createElement(x,{__source:{fileName:y,lineNumber:141,columnNumber:11}},E.a.createElement(h,{style:{display:"flex",alignItems:"center",justifyContent:"center"},__source:{fileName:y,lineNumber:142,columnNumber:13}},E.a.createElement("div",{__source:{fileName:y,lineNumber:143,columnNumber:15}},E.a.createElement(v,{__source:{fileName:y,lineNumber:144,columnNumber:17}},E.a.createElement(n.a,{__source:{fileName:y,lineNumber:145,columnNumber:19}},E.a.createElement(t.a,{onClick:m()(d.a.mark((function e(){var l,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!_.current){e.next=19;break}return e.prev=1,e.next=4,_.current.validate();case 4:return(l=_.current.getFields()).role_cover=l.role_cover[0].url||l.role_cover[0].response.data.file_url,b.push(l),(a={}).role_array=b,a.gb_code=r.gb_code,e.next=12,Object(g.q)(a);case 12:200===e.sent.code&&(o.a.success("修改成功"),u()),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(1),o.a.error("校验失败，请检查字段！");case 19:case"end":return e.stop()}}),e,null,[[1,16]])}))),type:"primary",__source:{fileName:y,lineNumber:146,columnNumber:21}},"提交"),E.a.createElement(t.a,{onClick:function(){_.current.resetFields()},__source:{fileName:y,lineNumber:174,columnNumber:21}},"重置")))))))))}},163:function(e,r,l){"use strict";l.r(r),l.d(r,"default",(function(){return A}));var a=l(5),n=l.n(a),t=l(605),o=(l(225),l(89)),u=(l(148),l(51)),m=(l(150),l(79)),c=(l(16),l(77),l(106),l(337),l(637),l(0)),i=l.n(c),s=l(229),N=l(33),b=l(30),f=l(47),_=l(3),d=l(14),p=l(9),E=function(){return(E=Object.assign||function(e){for(var r,l=1,a=arguments.length;l<a;l++)for(var n in r=arguments[l])Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e}).apply(this,arguments)},g=function(e,r){var l={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&r.indexOf(a)<0&&(l[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)r.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(l[a[n]]=e[a[n]])}return l},y=function(e,r){var l="function"==typeof Symbol&&e[Symbol.iterator];if(!l)return e;var a,n,t=l.call(e),o=[];try{for(;(void 0===r||r-- >0)&&!(a=t.next()).done;)o.push(a.value)}catch(e){n={error:e}}finally{try{a&&!a.done&&(l=t.return)&&l.call(t)}finally{if(n)throw n.error}}return o},v={position:"top",okType:"primary",icon:i.a.createElement(f.a,null),blurToHide:!0,unmountOnExit:!0,trigger:"click",escToClose:!0};var x=Object(c.forwardRef)((function(e,r){var l,a=Object(c.useContext)(_.a),n=a.getPrefixCls,t=a.locale,o=a.componentConfig,u=Object(p.a)(e,v,null==o?void 0:o.Popconfirm),m=u.style,f=u.className,x=u.children,h=u.position,k=u.getPopupContainer,C=u.blurToHide,O=u.unmountOnExit,w=u.trigger,j=u.escToClose,P=u.onVisibleChange,T=u.triggerProps,I=u.title,S=u.icon,q=u.okText,F=u.cancelText,V=u.okType,D=u.okButtonProps,R=u.cancelButtonProps,H=u.autoFocus,L=u.focusLock,B=g(u,["style","className","children","position","getPopupContainer","blurToHide","unmountOnExit","trigger","escToClose","onVisibleChange","triggerProps","title","icon","okText","cancelText","okType","okButtonProps","cancelButtonProps","autoFocus","focusLock"]),M=y(Object(d.a)(!1,{defaultValue:u.defaultPopupVisible,value:u.popupVisible}),2),U=M[0],z=M[1],J=y(Object(c.useState)(!1),2),A=J[0],W=J[1],X=n("popconfirm"),G=function(e){"popupVisible"in u||z(e),T&&T.onVisibleChange&&T.onVisibleChange(e),P&&P(e)},K=function(){G(!1)},Q=function(){K(),u.onCancel&&u.onCancel()},Y=function(){var e,r=u.onOk||u.onConfirm;r&&(e=r()),e&&e.then&&(W(!0),e.then((function(){K()}),(function(e){W(!1),console.error(e)}))),e||K()};return Object(c.useEffect)((function(){return!U&&A&&W(!1),function(){W(!1)}}),[U]),i.a.createElement(N.a,E({},B,{ref:r,style:E({maxWidth:350},m),className:f,prefixCls:X,getPopupContainer:k,position:h,trigger:w,escToClose:j,popupVisible:U,content:(l=i.a.createElement(i.a.Fragment,null,i.a.createElement(b.a,E({onClick:Q,size:"mini"},R),F||t.Popconfirm.cancelText),i.a.createElement(b.a,E({loading:A,onClick:Y,size:"mini",type:V},D),q||t.Popconfirm.okText)),i.a.createElement("div",{className:X+"-wrapper"},i.a.createElement("div",{className:X+"-title"},S&&i.a.createElement("span",{className:X+"-title-icon"},S),i.a.createElement("div",{className:X+"-title-text"},I)),i.a.createElement("div",{className:X+"-btn"},L?i.a.createElement(s.a,{disabled:!U,autoFocus:!!H},l):l))),unmountOnExit:O,blurToHide:C,popupHoverStay:!0,triggerProps:T,onVisibleChange:G,childrenPrefix:X}),"string"==typeof x?i.a.createElement("span",null,x):x)}));x.displayName="Popconfirm";var h=x,k=(l(149),l(52)),C=l(78),O=l.n(C),w=(l(598),l(602)),j=(l(595),l(596)),P=l(24),T=l.n(P),I=(l(599),l(603)),S=(l(305),l(104)),q=(l(227),l(152)),F=l(53),V=l.n(F),D=l(32),R=l(224),H=l(161),L="/Users/mrhh/Desktop/gbs-admin/src/pages/stocks-drama/DramaDetail/roleDetail/index.tsx",B=q.a.Row,M=q.a.Col,U=S.a.Item,z=I.a.Meta,J={labelCol:{span:4},wrapperCol:{span:17}};function A(e){var r=e.getInitFormData,l=e.role_array,a=Object(c.useRef)(),s=Object(D.c)((function(e){return e.myState}));Object(c.useEffect)((function(){a.current.setFieldsValue({role_array:l})}),[l]);var N=Object(c.useState)(),f=T()(N,2),_=f[0],d=f[1],p=Object(c.useState)(""),E=T()(p,2),g=E[0],y=E[1],v=s.clickItem,x=Object(c.useState)(!1),C=T()(x,2),P=C[0],q=C[1];return i.a.createElement(i.a.Fragment,null,i.a.createElement(j.a,{onCancel:function(){q(!1)},title:"add"===g?"添加角色":"修改角色",visible:P,footer:null,__source:{fileName:L,lineNumber:54,columnNumber:7}},i.a.createElement(H.default,{modalType:g,closeModal:function(){q(!1)},role_array:l,clickItem:v,__source:{fileName:L,lineNumber:62,columnNumber:9}})),i.a.createElement(b.a,{onClick:function(){q(!0),y("add")},type:"primary",__source:{fileName:L,lineNumber:71,columnNumber:7}},"添加角色"),0===l.length&&i.a.createElement(w.a,{status:"404",subTitle:"该剧本还没有角色喔",__source:{fileName:L,lineNumber:80,columnNumber:35}}),i.a.createElement(B,{gutter:40,style:{display:"flex",padding:20},__source:{fileName:L,lineNumber:82,columnNumber:7}},l.map((function(e){return i.a.createElement(I.a,{hoverable:!0,style:{width:350,maxHeight:450,marginRight:20,marginBottom:20},extra:i.a.createElement(m.a,{__source:{fileName:L,lineNumber:89,columnNumber:17}},i.a.createElement(b.a,{onClick:function(){y("edit")},type:"primary",__source:{fileName:L,lineNumber:90,columnNumber:19}},"修改角色"),i.a.createElement(h,{title:"确定删除这个角色?",onOk:O()(V.a.mark((function e(){var a,n;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("setsaveDeleteItem",_),console.log("role_array",l),a=l.filter((function(e){return _.role_code!==e.role_code})),n={gb_code:v.gb_code,role_array:a},e.next=6,Object(R.q)(n);case 6:200===e.sent.code&&(k.a.success("删除成功"),r());case 8:case"end":return e.stop()}}),e)}))),onCancel:function(){},__source:{fileName:L,lineNumber:98,columnNumber:19}},i.a.createElement(b.a,{onClick:function(){d(e)},status:"danger",__source:{fileName:L,lineNumber:118,columnNumber:21}},"删除角色"))),cover:i.a.createElement("div",{style:{height:300},__source:{fileName:L,lineNumber:130,columnNumber:17}},i.a.createElement("img",{style:{width:"100%",height:"100%"},alt:"dessert",src:e.role_cover,__source:{fileName:L,lineNumber:135,columnNumber:19}})),__source:{fileName:L,lineNumber:85,columnNumber:13}},i.a.createElement(z,{title:e.role_name,description:i.a.createElement(i.a.Fragment,null,e.role_brief),__source:{fileName:L,lineNumber:143,columnNumber:15}}))}))),i.a.createElement(S.a,n()({style:{display:"none"},onValuesChange:function(e,r){console.log("onValuesChange: ",e,r)},layout:"vertical",ref:a},J,{__source:{fileName:L,lineNumber:148,columnNumber:7}}),i.a.createElement(S.a.List,{field:"role_array",__source:{fileName:L,lineNumber:155,columnNumber:9}},(function(e,r){var l=r.add,a=r.remove;return i.a.createElement("div",{__source:{fileName:L,lineNumber:158,columnNumber:15}},e.map((function(e,r){return i.a.createElement("div",{key:e.key,__source:{fileName:L,lineNumber:161,columnNumber:21}},i.a.createElement(S.a.Item,{label:"角色".concat(r+1),__source:{fileName:L,lineNumber:162,columnNumber:23}},i.a.createElement(m.a,{__source:{fileName:L,lineNumber:163,columnNumber:25}},i.a.createElement(B,{__source:{fileName:L,lineNumber:164,columnNumber:27}},i.a.createElement(S.a.Item,{label:"角色名称",field:"".concat(e.field,".role_name"),rules:[{required:!0}],noStyle:!0,__source:{fileName:L,lineNumber:165,columnNumber:29}},i.a.createElement(u.a,{placeholder:"角色名称",__source:{fileName:L,lineNumber:171,columnNumber:31}}))),i.a.createElement(S.a.Item,{label:"角色简介",field:"".concat(e.field,".role_brief"),rules:[{required:!0}],noStyle:!0,__source:{fileName:L,lineNumber:175,columnNumber:27}},i.a.createElement(u.a,{placeholder:"角色简介",__source:{fileName:L,lineNumber:181,columnNumber:29}})),i.a.createElement(S.a.Item,{label:"角色备注",field:"".concat(e.field,".role_remarks"),rules:[{required:!0}],noStyle:!0,__source:{fileName:L,lineNumber:183,columnNumber:27}},i.a.createElement(u.a,{placeholder:"角色备注",__source:{fileName:L,lineNumber:189,columnNumber:29}})),i.a.createElement(S.a.Item,{label:"是否凶手",field:"".concat(e.field,".is_murderer"),rules:[{required:!0}],noStyle:!0,__source:{fileName:L,lineNumber:191,columnNumber:27}},i.a.createElement(o.a,{placeholder:"是否凶手",__source:{fileName:L,lineNumber:197,columnNumber:29}},i.a.createElement(o.a.Option,{value:"1",__source:{fileName:L,lineNumber:198,columnNumber:31}},"是"),i.a.createElement(o.a.Option,{value:"0",__source:{fileName:L,lineNumber:199,columnNumber:31}},"否"))),i.a.createElement(S.a.Item,{label:"角色封面",field:"".concat(e.field,".role_cover"),rules:[{required:!0}],noStyle:!0,__source:{fileName:L,lineNumber:202,columnNumber:27}},i.a.createElement(u.a,{placeholder:"角色封面",__source:{fileName:L,lineNumber:216,columnNumber:29}})),i.a.createElement(b.a,{icon:i.a.createElement(t.a,{__source:{fileName:L,lineNumber:236,columnNumber:35}}),shape:"circle",status:"danger",onClick:function(){return a(r)},__source:{fileName:L,lineNumber:235,columnNumber:27}}))))})),i.a.createElement(S.a.Item,{__source:{fileName:L,lineNumber:246,columnNumber:17}},i.a.createElement(b.a,{type:"primary",onClick:function(){l()},__source:{fileName:L,lineNumber:247,columnNumber:19}},"添加角色")))})),i.a.createElement(B,{style:{width:"100%"},__source:{fileName:L,lineNumber:260,columnNumber:9}},i.a.createElement(M,{span:24,__source:{fileName:L,lineNumber:261,columnNumber:11}},i.a.createElement(U,{style:{display:"flex",justifyContent:"flex-end"},__source:{fileName:L,lineNumber:262,columnNumber:13}},i.a.createElement(m.a,{__source:{fileName:L,lineNumber:263,columnNumber:15}},i.a.createElement(b.a,{onClick:O()(V.a.mark((function e(){var r;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.current){e.next=16;break}return e.prev=1,e.next=4,a.current.validate();case 4:return e.next=6,a.current.validate();case 6:return(r=e.sent).gb_code=v.gb_code,e.next=10,Object(R.q)(r);case 10:200===e.sent.code&&k.a.info("提交成功！"),e.next=16;break;case 14:e.prev=14,e.t0=e.catch(1);case 16:case"end":return e.stop()}}),e,null,[[1,14]])}))),type:"primary",__source:{fileName:L,lineNumber:264,columnNumber:17}},"提交"),i.a.createElement(b.a,{onClick:function(){a.current.resetFields()},__source:{fileName:L,lineNumber:284,columnNumber:17}},"重置")))))))}},637:function(e,r,l){}}]);