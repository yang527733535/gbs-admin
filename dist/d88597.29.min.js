(window.webpackJsonp=window.webpackJsonp||[]).push([[29,54,113,152],{187:function(e,r,t){"use strict";t.r(r);t(112);var n=t(45),a=t(5),c=t.n(a),l=(t(155),t(82)),u=(t(65),t(24)),o=t(673),m=(t(113),t(40)),i=(t(331),t(251)),s=(t(156),t(74)),b=(t(248),t(96)),f=(t(174),t(85)),_=t(56),N=t.n(_),d=t(22),p=t.n(d),g=(t(247),t(73)),h=t(35),E=t.n(h),v=t(0),y=t.n(v),O=t(111),j=t(83),S=t(167),w=t.n(S),x="/Users/mrhh/Desktop/gbs-admin/src/pages/store-game/form/index.jsx",k=g.a.Item,I={labelCol:{span:7},wrapperCol:{span:17}},C={wrapperCol:{span:17,offset:7}};r.default=function(e){var r=e.closeModalAndReqTable,t=e.clickItem,a=Object(v.useRef)(),_=Object(v.useState)([]),d=p()(_,2),h=d[0],S=d[1],A=Object(v.useState)(!0),T=p()(A,2),P=T[0],D=T[1],q=Object(v.useState)([]),F=p()(q,2),R=(F[0],F[1]),z=Object(v.useState)([]),L=p()(z,2),M=L[0],U=L[1],V=Object(v.useState)(localStorage.getItem("nowshop")),J=p()(V,2),G=J[0],W=J[1],B=Object(v.useState)([]),K=p()(B,2),Q=K[0],H=K[1],X=Object(v.useState)(!1),Y=p()(X,2),Z=Y[0],$=Y[1],ee=Object(v.useState)([]),re=p()(ee,2),te=re[0],ne=re[1],ae=Object(v.useState)(!1),ce=p()(ae,2),le=ce[0],ue=ce[1],oe=Object(v.useState)(""),me=p()(oe,2),ie=me[0],se=me[1],be=Object(v.useState)(""),fe=p()(be,2),_e=fe[0],Ne=fe[1],de=Object(v.useState)([]),pe=p()(de,2),ge=pe[0],he=pe[1],Ee=Object(v.useState)(!1),ve=p()(Ee,2),ye=ve[0],Oe=ve[1],je=Object(v.useRef)(null);Object(v.useEffect)((function(){console.log("clickItem",t)}),[]),Object(v.useEffect)((function(){Object(O.x)().then((function(e){var r,t=e.data;r=t.map((function(e){return function e(r){var t=Array.isArray(r.region_children)&&r.region_children.length>0;return{key:String(r.region_id),value:String(r.region_id),label:r.region_name,children:t?r.region_children.map((function(r){return e(r)})):[]}}(e)})),R(r)}))}),[]);var Se=function(){var e=N()(E.a.mark((function e(){var r,t;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(O.O)();case 2:r=e.sent,t=r.data,D(!1),S(t);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(v.useEffect)((function(){Se()}),[]),Object(v.useEffect)((function(){a.current.setFieldsValue({store_code:localStorage.getItem("nowshop")})}),[]);var we=Object(v.useCallback)(w()((function(e){je.current=Date.now(),$(!0),H([]);var r={gb_title:e};Object(O.p)(r).then((function(e){var r=e.data.map((function(e){return{label:y.a.createElement("div",{style:{display:"flex",alignItems:"center"},__source:{fileName:x,lineNumber:120,columnNumber:13}},y.a.createElement(f.a,{shape:"square",size:24,style:{marginLeft:6,marginRight:12},__source:{fileName:x,lineNumber:121,columnNumber:15}},y.a.createElement("img",{alt:"avatar",src:e.gb_cover,__source:{fileName:x,lineNumber:122,columnNumber:17}})),"".concat(e.gb_title)),value:e.gb_code}}));$(!1),H(r)}))}),500),[]),xe=Object(v.useCallback)(w()((function(e){je.current=Date.now(),ue(!0),H([]);var r={user_nick:e};Object(j.b)(r).then((function(e){var r=e.data.map((function(e){return{label:y.a.createElement("div",{style:{display:"flex",alignItems:"center"},__source:{fileName:x,lineNumber:145,columnNumber:13}},y.a.createElement(f.a,{size:24,style:{marginLeft:6,marginRight:12},__source:{fileName:x,lineNumber:146,columnNumber:15}},y.a.createElement("img",{alt:"avatar",src:e.user_photo,__source:{fileName:x,lineNumber:147,columnNumber:17}})),"".concat(e.user_nick)),value:e.user_account}}));ue(!1),ne(r)}))}),500),[]),ke=Object(v.useCallback)(w()((function(e){je.current=Date.now(),$(!0),H([]);var r={member_name:e};Object(j.e)(r).then((function(e){console.log("data: ",e);var r=e.data.map((function(e){return{label:y.a.createElement("div",{style:{display:"flex",alignItems:"center"},__source:{fileName:x,lineNumber:171,columnNumber:13}},y.a.createElement(f.a,{size:24,style:{marginLeft:6,marginRight:12},__source:{fileName:x,lineNumber:172,columnNumber:15}},y.a.createElement("img",{alt:"avatar",src:e.member_face,__source:{fileName:x,lineNumber:173,columnNumber:17}})),"".concat(e.member_name)),value:e.member_account}}));Oe(!1),console.log("options",r),he(r)}))}),500),[]);Object(v.useEffect)((function(){we(),ke(),xe()}),[]);var Ie=function(){var e=N()(E.a.mark((function e(){var r,t,n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={store_code:G},e.next=3,Object(O.g)(r);case 3:t=e.sent,n=t.data.store_room,U(n);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(v.useEffect)((function(){Ie()}),[G]),y.a.createElement("div",{style:{maxWidth:650},__source:{fileName:x,lineNumber:208,columnNumber:5}},y.a.createElement(g.a,c()({ref:a},I,{size:"default",onSubmit:function(e){console.log(e)},onValuesChange:function(e,r){console.log("onValuesChange: ",e,r)},scrollToFirstError:!0,__source:{fileName:x,lineNumber:209,columnNumber:7}}),y.a.createElement(k,{label:"选择店铺",field:"store_code",rules:[{required:!0,message:"请填写店铺编码"}],__source:{fileName:x,lineNumber:219,columnNumber:9}},y.a.createElement(b.a,{onChange:function(){var e=N()(E.a.mark((function e(r){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:W(r);case 1:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),loading:P,placeholder:"请选择店铺",__source:{fileName:x,lineNumber:224,columnNumber:11}},null==h?void 0:h.map((function(e){return y.a.createElement(b.a.Option,{key:e.store_code,value:e.store_code,__source:{fileName:x,lineNumber:233,columnNumber:17}},e.store_name)})))),y.a.createElement(k,{label:"选择房间",field:"room_code",rules:[{required:!0,message:"请填写店铺编码"}],__source:{fileName:x,lineNumber:240,columnNumber:9}},y.a.createElement(b.a,{placeholder:"请选择房间",__source:{fileName:x,lineNumber:245,columnNumber:11}},M.map((function(e){return y.a.createElement(b.a.Option,{key:e.room_code,value:e.room_code,__source:{fileName:x,lineNumber:248,columnNumber:17}},e.room_name)})))),y.a.createElement(k,{label:"剧本",field:"gb_code",rules:[{required:!0,message:"请选择剧本"}],__source:{fileName:x,lineNumber:256,columnNumber:9}},y.a.createElement(b.a,{onChange:function(){var e=N()(E.a.mark((function e(r){var t,n,c,l,u;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={gb_code:r,store_code:G},e.next=3,Object(O.t)(t);case 3:n=e.sent,c=n.data,l=c.gb_price,u=c.gb_price2,se(l),Ne(u),a.current.setFieldsValue({gb_price:0===c.is_leisure?c.gb_price:c.gb_price2}),console.log("data: ",c);case 10:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),style:{width:345},options:Q,placeholder:"请输入要搜索的剧本",filterOption:!1,renderFormat:function(e){return e.children.props.children[1]},notFoundContent:Z?y.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},__source:{fileName:x,lineNumber:286,columnNumber:17}},y.a.createElement(s.a,{style:{margin:12},__source:{fileName:x,lineNumber:287,columnNumber:19}})):null,showSearch:!0,onSearch:we,__source:{fileName:x,lineNumber:257,columnNumber:11}})),ie&&y.a.createElement(k,{label:"参考价格",__source:{fileName:x,lineNumber:296,columnNumber:11}},y.a.createElement("span",{__source:{fileName:x,lineNumber:297,columnNumber:13}},"工作日:¥",ie),"    ",y.a.createElement("span",{__source:{fileName:x,lineNumber:298,columnNumber:13}},"周末:¥",_e)),y.a.createElement(k,{label:"剧本价格",field:"gb_price",rules:[{required:!0,message:"请填写剧本价格"}],__source:{fileName:x,lineNumber:302,columnNumber:9}},y.a.createElement(i.a,{min:0,placeholder:"请填写剧本价格...",__source:{fileName:x,lineNumber:307,columnNumber:11}})),y.a.createElement(k,{label:"玩家人数",field:"game_people",rules:[{required:!0,message:"请填写玩家人数"}],__source:{fileName:x,lineNumber:310,columnNumber:9}},y.a.createElement(i.a,{min:2,placeholder:"请填写玩家人数...",__source:{fileName:x,lineNumber:315,columnNumber:11}})),y.a.createElement(k,{label:"主持人",field:"dm_user",rules:[{required:!0,message:"请填写主持人"}],__source:{fileName:x,lineNumber:317,columnNumber:9}},y.a.createElement(b.a,{style:{width:345},options:te,placeholder:"请选择主持人",filterOption:!1,renderFormat:function(e){return e.children.props.children[1]},notFoundContent:le?y.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},__source:{fileName:x,lineNumber:332,columnNumber:17}},y.a.createElement(s.a,{style:{margin:12},__source:{fileName:x,lineNumber:333,columnNumber:19}})):null,showSearch:!0,onSearch:xe,__source:{fileName:x,lineNumber:322,columnNumber:11}})),y.a.createElement(g.a.List,{field:"game_player",__source:{fileName:x,lineNumber:342,columnNumber:9}},(function(e,r){var t=r.add,n=r.remove;r.move;return y.a.createElement("div",{__source:{fileName:x,lineNumber:345,columnNumber:15}},e.map((function(e,r){return y.a.createElement("div",{key:e.key,__source:{fileName:x,lineNumber:348,columnNumber:21}},y.a.createElement(g.a.Item,{label:"玩家".concat(1+r),__source:{fileName:x,lineNumber:349,columnNumber:23}},y.a.createElement(l.a,{__source:{fileName:x,lineNumber:350,columnNumber:25}},y.a.createElement(g.a.Item,{field:"".concat(e.field,".player_user"),rules:[{required:!0}],noStyle:!0,__source:{fileName:x,lineNumber:351,columnNumber:27}},y.a.createElement(b.a,{style:{width:145},options:ge,placeholder:"请选择玩家",filterOption:!1,renderFormat:function(e){return e.children.props.children[1]},notFoundContent:ye?y.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},__source:{fileName:x,lineNumber:366,columnNumber:35}},y.a.createElement(s.a,{style:{margin:12},__source:{fileName:x,lineNumber:373,columnNumber:37}})):null,showSearch:!0,onSearch:ke,__source:{fileName:x,lineNumber:356,columnNumber:29}})),y.a.createElement(g.a.Item,{field:"".concat(e.field,".player_type"),rules:[{required:!0}],noStyle:!0,__source:{fileName:x,lineNumber:381,columnNumber:27}},y.a.createElement(b.a,{placeholder:"玩家类型",__source:{fileName:x,lineNumber:386,columnNumber:29}},y.a.createElement(b.a.Option,{value:"player",__source:{fileName:x,lineNumber:387,columnNumber:31}},"player"),y.a.createElement(b.a.Option,{value:"worker",__source:{fileName:x,lineNumber:388,columnNumber:31}},"worker"))),y.a.createElement(g.a.Item,{field:"".concat(e.field,".player_name"),rules:[{required:!0}],noStyle:!0,__source:{fileName:x,lineNumber:392,columnNumber:27}},y.a.createElement(m.a,{placeholder:"玩家名称",__source:{fileName:x,lineNumber:397,columnNumber:29}})),y.a.createElement(g.a.Item,{field:"".concat(e.field,".player_note"),rules:[{required:!0}],noStyle:!0,__source:{fileName:x,lineNumber:399,columnNumber:27}},y.a.createElement(m.a,{placeholder:"玩家备注",__source:{fileName:x,lineNumber:404,columnNumber:29}})),y.a.createElement(u.a,{icon:y.a.createElement(o.a,{__source:{fileName:x,lineNumber:407,columnNumber:35}}),shape:"circle",status:"danger",onClick:function(){return n(r)},__source:{fileName:x,lineNumber:406,columnNumber:27}}))))})),y.a.createElement(g.a.Item,c()({},C,{__source:{fileName:x,lineNumber:417,columnNumber:17}}),y.a.createElement(u.a,{onClick:function(){t()},__source:{fileName:x,lineNumber:418,columnNumber:19}},"添加玩家")))})),y.a.createElement(k,c()({},C,{__source:{fileName:x,lineNumber:444,columnNumber:9}}),y.a.createElement(u.a,{onClick:N()(E.a.mark((function e(){var c,l,u;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.current){e.next=26;break}return e.prev=1,e.next=4,a.current.validate();case 4:if(null!==t){e.next=12;break}return null!==(c=a.current.getFields()).game_player&&void 0!==c.game_player||(c.game_player=[]),e.next=9,Object(O.i)(c);case 9:l=e.sent,e.next=18;break;case 12:return u=a.current.getFields(),console.log("param: ",u),u.store_code=t.store_code,e.next=17,Object(O.Q)(u);case 17:l=e.sent;case 18:200===l.code&&(n.a.success("添加成功"),r()),e.next=26;break;case 21:e.prev=21,e.t0=e.catch(1),console.log(e.t0),console.log(a.current.getFieldsError()),n.a.error("校验失败，请检查字段！");case 26:case"end":return e.stop()}}),e,null,[[1,21]])}))),type:"primary",style:{marginRight:24},__source:{fileName:x,lineNumber:445,columnNumber:11}},"提交"),y.a.createElement(u.a,{onClick:function(){a.current.resetFields()},__source:{fileName:x,lineNumber:479,columnNumber:11}},"重置"))))}},188:function(e,r,t){"use strict";t.r(r);var n=t(5),a=t.n(n),c=(t(65),t(24)),l=(t(112),t(45)),u=(t(156),t(74)),o=(t(248),t(96)),m=(t(174),t(85)),i=t(56),s=t.n(i),b=t(22),f=t.n(b),_=(t(247),t(73)),N=t(35),d=t.n(N),p=t(0),g=t.n(p),h=t(111),E=t(83),v=t(167),y=t.n(v),O="/Users/mrhh/Desktop/gbs-admin/src/pages/store-game/stargameform/index.jsx",j=_.a.Item,S={labelCol:{span:7},wrapperCol:{span:17}},w={wrapperCol:{span:17,offset:7}};r.default=function(e){var r=e.closeModalAndReqTable,t=e.clickItem,n=Object(p.useRef)(),i=Object(p.useState)(!1),b=f()(i,2),N=b[0],v=b[1],x=Object(p.useState)([]),k=f()(x,2),I=k[0],C=k[1],A=Object(p.useState)(!0),T=f()(A,2),P=T[0],D=T[1],q=Object(p.useState)([]),F=f()(q,2),R=(F[0],F[1]),z=Object(p.useState)([]),L=f()(z,2),M=L[0],U=L[1],V=Object(p.useState)([]),J=f()(V,2),G=(J[0],J[1]),W=Object(p.useState)(!1),B=f()(W,2),K=(B[0],B[1]),Q=Object(p.useState)([]),H=f()(Q,2),X=H[0],Y=H[1],Z=Object(p.useState)(!1),$=f()(Z,2),ee=$[0],re=$[1],te=Object(p.useState)([]),ne=f()(te,2),ae=(ne[0],ne[1]),ce=Object(p.useState)(!1),le=f()(ce,2),ue=(le[0],le[1]),oe=Object(p.useRef)(null);Object(p.useEffect)((function(){console.log("clickItem2222",t),_e(t.store_code),n.current.setFieldsValue({store_code:t.store_code,room_code:t.room_code,dm_user:"demo"})}),[]),Object(p.useEffect)((function(){Object(h.x)().then((function(e){var r,t=e.data;r=t.map((function(e){return function e(r){var t=Array.isArray(r.region_children)&&r.region_children.length>0;return{key:String(r.region_id),value:String(r.region_id),label:r.region_name,children:t?r.region_children.map((function(r){return e(r)})):[]}}(e)})),R(r)}))}),[]);var me=function(){var e=s()(d.a.mark((function e(){var r,t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.O)();case 2:r=e.sent,t=r.data,D(!1),C(t);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(p.useEffect)((function(){me()}),[]);var ie=function(){var e=s()(d.a.mark((function e(){var r,n,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={store_code:t.store_code,room_code:t.room_code,game_code:t.game_code},e.next=3,Object(E.h)(r);case 3:n=e.sent,a=n.data,v(a);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(p.useEffect)((function(){ie()}),[]);var se=Object(p.useCallback)(y()((function(e){oe.current=Date.now(),K(!0),G([]);var r={gb_title:e};Object(h.p)(r).then((function(e){var r=e.data.map((function(e){return{label:g.a.createElement("div",{style:{display:"flex",alignItems:"center"},__source:{fileName:O,lineNumber:140,columnNumber:13}},g.a.createElement(m.a,{shape:"square",size:24,style:{marginLeft:6,marginRight:12},__source:{fileName:O,lineNumber:141,columnNumber:15}},g.a.createElement("img",{alt:"avatar",src:e.gb_cover,__source:{fileName:O,lineNumber:142,columnNumber:17}})),"".concat(e.gb_title)),value:e.gb_code}}));K(!1),G(r)}))}),500),[]),be=Object(p.useCallback)(y()((function(e){oe.current=Date.now(),re(!0),G([]);var r={user_nick:e};Object(E.b)(r).then((function(e){var r=e.data.map((function(e){return{label:g.a.createElement("div",{style:{display:"flex",alignItems:"center"},__source:{fileName:O,lineNumber:165,columnNumber:13}},g.a.createElement(m.a,{size:24,style:{marginLeft:6,marginRight:12},__source:{fileName:O,lineNumber:166,columnNumber:15}},g.a.createElement("img",{alt:"avatar",src:e.user_photo,__source:{fileName:O,lineNumber:167,columnNumber:17}})),"".concat(e.user_nick)),value:e.user_account}}));re(!1),Y(r)}))}),500),[]),fe=Object(p.useCallback)(y()((function(e){oe.current=Date.now(),K(!0),G([]);var r={member_name:e};Object(E.e)(r).then((function(e){console.log("data: ",e);var r=e.data.map((function(e){return{label:g.a.createElement("div",{style:{display:"flex",alignItems:"center"},__source:{fileName:O,lineNumber:191,columnNumber:13}},g.a.createElement(m.a,{size:24,style:{marginLeft:6,marginRight:12},__source:{fileName:O,lineNumber:192,columnNumber:15}},g.a.createElement("img",{alt:"avatar",src:e.member_face,__source:{fileName:O,lineNumber:193,columnNumber:17}})),"".concat(e.member_name)),value:e.member_account}}));ue(!1),console.log("options",r),ae(r)}))}),500),[]);Object(p.useEffect)((function(){se(),fe(),be()}),[]);var _e=function(){var e=s()(d.a.mark((function e(r){var t,n,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={store_code:r},e.next=3,Object(h.g)(t);case 3:n=e.sent,a=n.data.store_room,U(a);case 6:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}();return g.a.createElement("div",{style:{maxWidth:650},__source:{fileName:O,lineNumber:224,columnNumber:5}},g.a.createElement(_.a,a()({ref:n},S,{size:"default",onSubmit:function(e){console.log(e)},onValuesChange:function(e,r){console.log("onValuesChange: ",e,r)},scrollToFirstError:!0,__source:{fileName:O,lineNumber:225,columnNumber:7}}),g.a.createElement(j,{label:"当前店铺",field:"store_code",rules:[{required:!1,message:"请填写店铺编码"}],__source:{fileName:O,lineNumber:235,columnNumber:9}},g.a.createElement(o.a,{disabled:!0,onChange:function(){var e=s()(d.a.mark((function e(r){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:_e(r);case 1:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),loading:P,placeholder:"请选择店铺",__source:{fileName:O,lineNumber:240,columnNumber:11}},null==I?void 0:I.map((function(e){return g.a.createElement(o.a.Option,{key:e.store_code,value:e.store_code,__source:{fileName:O,lineNumber:250,columnNumber:17}},e.store_name)})))),g.a.createElement(j,{label:"房间",field:"room_code",rules:[{required:!1,message:"请填写店铺编码"}],__source:{fileName:O,lineNumber:257,columnNumber:9}},g.a.createElement(o.a,{disabled:!0,placeholder:"请选择房间",__source:{fileName:O,lineNumber:262,columnNumber:11}},M.map((function(e){return g.a.createElement(o.a.Option,{key:e.room_code,value:e.room_code,__source:{fileName:O,lineNumber:265,columnNumber:17}},e.room_name)})))),g.a.createElement(j,{label:"剧本",field:"gb_code",rules:[{required:!1,message:"请选择剧本"}],__source:{fileName:O,lineNumber:273,columnNumber:9}},g.a.createElement("span",{__source:{fileName:O,lineNumber:274,columnNumber:11}},N.gb_title)),g.a.createElement(j,{label:"主持人",field:"dm_user",rules:[{required:!0,message:"请填写主持人"}],__source:{fileName:O,lineNumber:284,columnNumber:9}},g.a.createElement(o.a,{style:{width:345},options:X,placeholder:"请选择主持人",filterOption:!1,renderFormat:function(e){return null===e?null:e.children.props.children[1]},notFoundContent:ee?g.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},__source:{fileName:O,lineNumber:302,columnNumber:17}},g.a.createElement(u.a,{style:{margin:12},__source:{fileName:O,lineNumber:303,columnNumber:19}})):null,showSearch:!0,onSearch:be,__source:{fileName:O,lineNumber:289,columnNumber:11}})),g.a.createElement(j,a()({},w,{__source:{fileName:O,lineNumber:312,columnNumber:9}}),g.a.createElement(c.a,{onClick:s()(d.a.mark((function e(){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.current){e.next=19;break}return e.prev=1,e.next=4,n.current.validate();case 4:return a=e.sent,console.log("param: ",a),a.gb_code=t.gb_code,a.dm_user=a.gb_code,a.game_code=N.game_code,e.next=11,Object(h.P)(a);case 11:200===e.sent.code&&(l.a.success("添加成功"),r()),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(1),console.log(n.current.getFieldsError()),l.a.error("校验失败，请检查字段！");case 19:case"end":return e.stop()}}),e,null,[[1,15]])}))),type:"primary",style:{marginRight:24},__source:{fileName:O,lineNumber:313,columnNumber:11}},"开始游戏"))))}},209:function(e,r,t){"use strict";t.r(r);t(672);var n=t(671),a=(t(661),t(662)),c=(t(331),t(251)),l=(t(113),t(40)),u=(t(248),t(96)),o=(t(664),t(666)),m=(t(330),t(249)),i=t(4),s=t.n(i),b=(t(669),t(670)),f=(t(112),t(45)),_=t(56),N=t.n(_),d=(t(65),t(24)),p=(t(155),t(82)),g=(t(347),t(259)),h=t(22),E=t.n(h),v=t(683),y=t.n(v),O=t(35),j=t.n(O),S=t(0),w=t.n(S),x=t(32),k=t(111),I=t(353),C=t(36),A=t(648),T=t.n(A),P=t(187),D=t(188),q="/Users/mrhh/Desktop/gbs-admin/src/pages/store-game/index.tsx";function F(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function R(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?F(Object(t),!0).forEach((function(r){s()(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):F(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}r.default=function(e){y()(e);var r=Object(C.a)(),t=Object(S.useState)(!1),i=E()(t,2),s=i[0],_=i[1],h=Object(S.useState)(!1),v=E()(h,2),O=v[0],A=v[1],F=Object(S.useState)(null),z=E()(F,2),L=z[0],M=z[1],U=Object(S.useState)(null),V=E()(U,2),J=V[0],G=V[1],W=Object(S.useState)(null),B=E()(W,2),K=B[0],Q=B[1],H=Object(S.useState)(null),X=E()(H,2),Y=X[0],Z=X[1],$=Object(S.useState)([]),ee=E()($,2),re=ee[0],te=ee[1];Object(S.useEffect)((function(){te(JSON.parse(localStorage.getItem("Allshop")).store_code)}),[]);var ne=[{title:"剧本名称",dataIndex:"gb_title"},{title:"店铺",dataIndex:"store_code",render:function(e){return JSON.parse(localStorage.getItem("SMap"))[e]}},{title:"房间",dataIndex:"room_code",render:function(e){return JSON.parse(localStorage.getItem("SMap"))[e]}},{title:"玩家人数",dataIndex:"game_people"},{title:"状态",dataIndex:"game_status",render:function(e){return w.a.createElement(p.a,{__source:{fileName:q,lineNumber:73,columnNumber:11}},w.a.createElement(g.a,{status:"default",__source:{fileName:q,lineNumber:74,columnNumber:13}}),JSON.parse(localStorage.getItem("AllMaP")).sys_game_status[e]||e)}},{title:"主持人",dataIndex:"dm_user"},{title:"开局时间",dataIndex:"start_time"},{title:r["searchTable.columns.createdTime"],dataIndex:"created_time"},{title:"更新时间",dataIndex:"updated_time"},{title:r["searchTable.columns.operations"],fixed:"right",render:function(e,r){return w.a.createElement(p.a,{__source:{fileName:q,lineNumber:101,columnNumber:9}},w.a.createElement(d.a,{onClick:function(){M(r),_(!0)},size:"mini",type:"primary",__source:{fileName:q,lineNumber:102,columnNumber:11}},"修改"),"1"===r.game_status&&w.a.createElement(d.a,{onClick:function(){M(r),A(!0)},size:"mini",type:"primary",__source:{fileName:q,lineNumber:113,columnNumber:13}},"开始游戏"),"2"===r.game_status&&w.a.createElement(b.a,{title:"确定结束游戏?",onOk:N()(j.a.mark((function e(){var t,n,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.game_code,n=r.store_code,a={game_code:t,store_code:n},console.log("param",a),e.next=5,Object(k.M)(a);case 5:200===e.sent.code&&(f.a.info({content:"ok"}),se());case 7:case"end":return e.stop()}}),e)}))),onCancel:function(){f.a.error({content:"取消"})},__source:{fileName:q,lineNumber:126,columnNumber:13}},w.a.createElement(d.a,{size:"mini",type:"primary",status:"warning",__source:{fileName:q,lineNumber:145,columnNumber:15}},"结束游戏")))}}];Object(S.useEffect)((function(){ae()}),[]);var ae=function(){var e=N()(j.a.mark((function e(){var r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.O)();case 2:r=e.sent,console.log("data: ",r);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ce=Object(x.c)((function(e){return e.searchTable})),le=ce.data,ue=ce.pagination,oe=ce.loading,me=ce.formParams,ie=Object(x.b)();function se(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=Object(k.c)({page:e,page_size:r,store_code:J,gb_code:K,game_people:Y});n.then((function(e){var r=e.data,n=e.paginator;ie({type:I.UPDATE_LIST,payload:{data:r}}),ie({type:I.UPDATE_PAGINATION,payload:{pagination:R(R({},ue),{},{current:n.page,pageSize:n.page_size,total:n.total_count})}}),ie({type:I.UPDATE_LOADING,payload:{loading:!1}}),ie({type:I.UPDATE_FORM_PARAMS,payload:{params:t}})}))}return Object(S.useEffect)((function(){se()}),[J]),Object(S.useEffect)((function(){G(localStorage.getItem("nowshop"))}),[]),w.a.createElement("div",{className:T.a.container,__source:{fileName:q,lineNumber:208,columnNumber:5}},w.a.createElement(m.a,{title:null===L?"添加组局":"修改组局",footer:null,onCancel:function(){_(!1)},unmountOnExit:!0,style:{width:900,minWidth:900},visible:s,__source:{fileName:q,lineNumber:209,columnNumber:7}},w.a.createElement(P.default,{clickItem:L,closeModalAndReqTable:function(){_(!1),se()},__source:{fileName:q,lineNumber:219,columnNumber:9}})),w.a.createElement(m.a,{title:"开始游戏",footer:null,onCancel:function(){A(!1)},unmountOnExit:!0,style:{width:900,minWidth:900},visible:O,__source:{fileName:q,lineNumber:228,columnNumber:7}},w.a.createElement(D.default,{clickItem:L,closeModalAndReqTable:function(){A(!1),se()},__source:{fileName:q,lineNumber:239,columnNumber:9}})),w.a.createElement(o.a,{style:{marginBottom:20},__source:{fileName:q,lineNumber:248,columnNumber:7}},w.a.createElement(o.a.Item,{__source:{fileName:q,lineNumber:249,columnNumber:9}},"店铺运营"),w.a.createElement(o.a.Item,{__source:{fileName:q,lineNumber:250,columnNumber:9}},"店铺组局")),w.a.createElement("div",{__source:{fileName:q,lineNumber:252,columnNumber:7}},w.a.createElement(a.a,{style:{marginBottom:20},__source:{fileName:q,lineNumber:253,columnNumber:9}},w.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"},__source:{fileName:q,lineNumber:254,columnNumber:11}},w.a.createElement(d.a,{onClick:function(){_(!0),M(null)},type:"primary",__source:{fileName:q,lineNumber:255,columnNumber:13}},"添加组局"),w.a.createElement("div",{__source:{fileName:q,lineNumber:264,columnNumber:13}},w.a.createElement(p.a,{style:{marginLeft:20},wrap:!0,__source:{fileName:q,lineNumber:265,columnNumber:15}},w.a.createElement(u.a,{value:J,onChange:function(e){G(e)},style:{width:200},placeholder:"请选择店铺",__source:{fileName:q,lineNumber:266,columnNumber:17}},re.map((function(e){return w.a.createElement(u.a.Option,{key:e.code,value:e.code,__source:{fileName:q,lineNumber:276,columnNumber:23}},e.name)}))),w.a.createElement(l.a,{value:K,onChange:function(e){Q(e)},placeholder:"请输入剧本编码",style:{width:200},__source:{fileName:q,lineNumber:283,columnNumber:17}}),w.a.createElement(c.a,{min:1,value:Y,onChange:function(e){Z(e)},placeholder:"请输入玩家人数",style:{width:200},__source:{fileName:q,lineNumber:291,columnNumber:17}}),w.a.createElement(d.a,{onClick:function(){},__source:{fileName:q,lineNumber:301,columnNumber:17}},"重置"),w.a.createElement(d.a,{onClick:function(){se()},type:"primary",__source:{fileName:q,lineNumber:302,columnNumber:17}},"搜索")))))),w.a.createElement(a.a,{bordered:!1,__source:{fileName:q,lineNumber:315,columnNumber:7}},w.a.createElement(n.a,{rowKey:"user_account",loading:oe,onChange:function(e){se(e.current,e.pageSize,me)},pagination:ue,columns:ne,scroll:{x:2e3},data:le,__source:{fileName:q,lineNumber:316,columnNumber:9}})))}},353:function(e,r,t){"use strict";t.r(r),t.d(r,"UPDATE_LIST",(function(){return n})),t.d(r,"UPDATE_LOADING",(function(){return a})),t.d(r,"UPDATE_PAGINATION",(function(){return c})),t.d(r,"UPDATE_FORM_PARAMS",(function(){return l}));var n="searchTable_update_list",a="searchTable_update_loading",c="searchTable_update_pagination",l="searchTable_update_formParams"},648:function(e,r,t){e.exports={container:"container-a393421ccd",toolbar:"toolbar-a31128d7de",operations:"operations-807e4a3204"}}}]);