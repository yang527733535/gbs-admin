(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{205:function(e,l,r){"use strict";r.r(l);r(155);var m=r(74),a=(r(156),r(82)),u=(r(65),r(24)),n=(r(112),r(45)),t=(r(697),r(698)),c=(r(335),r(254)),i=(r(695),r(694)),o=(r(711),r(714)),s=(r(336),r(256)),b=(r(253),r(96)),N=(r(113),r(40)),_=r(4),f=r.n(_),d=r(56),p=r.n(d),E=r(22),x=r.n(E),g=(r(255),r(157)),v=(r(252),r(73)),h=r(35),O=r.n(h),y=r(0),w=r.n(y),j=r(32),q=r(111),k="/Users/mrhh/Desktop/gbs-admin/src/pages/stocks-drama/form/index.tsx";function P(e,l){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(e);l&&(m=m.filter((function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable}))),r.push.apply(r,m)}return r}function S(e){for(var l=1;l<arguments.length;l++){var r=null!=arguments[l]?arguments[l]:{};l%2?P(Object(r),!0).forEach((function(l){f()(e,l,r[l])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(l){Object.defineProperty(e,l,Object.getOwnPropertyDescriptor(r,l))}))}return e}var R=v.a.Item,C=g.a.Row,D=g.a.Col;l.default=function(e){var l=e.modalType,r=void 0===l?"add":l,_=e.closeModalAndRequest,f=Object(y.useRef)(),d=Object(y.useState)(!1),E=x()(d,2),g=E[0],h=E[1],P=Object(y.useState)([]),T=x()(P,2),F=T[0],I=T[1],z=Object(y.useState)([]),A=x()(z,2),L=A[0],H=A[1],J=Object(y.useState)([]),U=x()(J,2),V=U[0],M=U[1],B=Object(y.useState)([]),W=x()(B,2),X=W[0],G=W[1],K=Object(j.c)((function(e){return e.myState})),Q=K.labelData,Y=K.clickItem;Object(y.useEffect)((function(){"edit"===r&&Z()}),[]);var Z=function(){var e=p()(O.a.mark((function e(){var l,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),e.next=3,Object(q.o)({gb_code:Y.gb_code});case 3:l=e.sent,r=l.data,h(!1),f.current.setFieldsValue(S(S({},r),{},{gb_cover:[{uid:"1",url:r.gb_cover,name:"20200717"}]}));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(y.useEffect)((function(){for(var e=0;e<Q.length;e++){var l=Q[e];"app_gb_type"===l.dict_code&&I(l.dict_label),"app_gb_level"===l.dict_code&&H(l.dict_label),"app_gb_text_tag"===l.dict_code&&M(l.dict_label),"app_gb_status"===l.dict_code&&G(l.dict_label)}}),[]),w.a.createElement(m.a,{style:{width:"100%"},loading:g,__source:{fileName:k,lineNumber:86,columnNumber:5}},w.a.createElement("div",{__source:{fileName:k,lineNumber:87,columnNumber:7}},w.a.createElement(v.a,{ref:f,onValuesChange:function(e,l){console.log("onValuesChange: ",e,l)},scrollToFirstError:!0,__source:{fileName:k,lineNumber:88,columnNumber:9}},w.a.createElement(C,{className:"grid-demo",style:{marginBottom:10},__source:{fileName:k,lineNumber:89,columnNumber:11}},w.a.createElement(D,{xs:24,sm:12,md:12,lg:8,xl:8,xxl:8,__source:{fileName:k,lineNumber:90,columnNumber:13}},w.a.createElement("div",{__source:{fileName:k,lineNumber:91,columnNumber:15}},w.a.createElement(R,{label:"剧本名称",field:"gb_title",rules:[{required:!0,message:"请填写剧本名称"}],__source:{fileName:k,lineNumber:92,columnNumber:17}},w.a.createElement(N.a,{placeholder:"请填写剧本名称...",__source:{fileName:k,lineNumber:97,columnNumber:19}})))),w.a.createElement(D,{xs:24,sm:12,md:12,lg:8,xl:8,xxl:8,__source:{fileName:k,lineNumber:101,columnNumber:13}},w.a.createElement("div",{__source:{fileName:k,lineNumber:102,columnNumber:15}},w.a.createElement(R,{label:"剧本类型",field:"gb_type",rules:[{required:!0,message:"请填写剧本类型"}],__source:{fileName:k,lineNumber:103,columnNumber:17}},w.a.createElement(b.a,{placeholder:"请选择剧本类型",__source:{fileName:k,lineNumber:108,columnNumber:19}},null==F?void 0:F.map((function(e){return w.a.createElement(b.a.Option,{key:e.label_value,value:e.label_value,__source:{fileName:k,lineNumber:111,columnNumber:25}},e.label_zh)})))))),w.a.createElement(D,{xs:24,sm:12,md:12,lg:8,xl:8,xxl:8,__source:{fileName:k,lineNumber:120,columnNumber:13}},w.a.createElement("div",{__source:{fileName:k,lineNumber:121,columnNumber:15}}," ",w.a.createElement(R,{label:"剧本难度",field:"gb_level",rules:[{required:!0,message:"请选中剧本难度"}],__source:{fileName:k,lineNumber:123,columnNumber:17}},w.a.createElement(b.a,{placeholder:"请选择剧本难度",__source:{fileName:k,lineNumber:128,columnNumber:19}},null==L?void 0:L.map((function(e){return w.a.createElement(b.a.Option,{key:e.label_value,value:e.label_value,__source:{fileName:k,lineNumber:131,columnNumber:25}},e.label_zh)}))))))),w.a.createElement(C,{__source:{fileName:k,lineNumber:141,columnNumber:11}},w.a.createElement(D,{xs:24,sm:12,md:12,lg:8,xl:8,xxl:8,__source:{fileName:k,lineNumber:142,columnNumber:13}},w.a.createElement("div",{__source:{fileName:k,lineNumber:143,columnNumber:15}},w.a.createElement(R,{label:"玩家人数",field:"gb_people",rules:[{required:!0,message:"请填写玩家说明"}],__source:{fileName:k,lineNumber:144,columnNumber:17}},w.a.createElement(s.a,{placeholder:"请填写玩家说明...",__source:{fileName:k,lineNumber:149,columnNumber:19}})))),w.a.createElement(D,{xs:24,sm:12,md:12,lg:8,xl:8,xxl:8,__source:{fileName:k,lineNumber:153,columnNumber:13}},w.a.createElement("div",{__source:{fileName:k,lineNumber:154,columnNumber:15}}," ",w.a.createElement(R,{label:"剧本状态",field:"gb_status",rules:[{required:!1,message:"请选择剧本状态"}],__source:{fileName:k,lineNumber:156,columnNumber:17}},w.a.createElement(b.a,{placeholder:"请选择剧本状态",__source:{fileName:k,lineNumber:161,columnNumber:19}},null==X?void 0:X.map((function(e){return w.a.createElement(b.a.Option,{key:e.label_value,value:e.label_value,__source:{fileName:k,lineNumber:164,columnNumber:25}},e.label_zh)})))))),w.a.createElement(D,{xs:24,sm:12,md:12,lg:8,xl:8,xxl:8,__source:{fileName:k,lineNumber:173,columnNumber:13}},w.a.createElement("div",{__source:{fileName:k,lineNumber:174,columnNumber:15}},w.a.createElement(R,{label:"玩家说明",field:"gb_people_note",rules:[{required:!0,message:"请填写玩家说明"}],__source:{fileName:k,lineNumber:175,columnNumber:17}},w.a.createElement(N.a,{placeholder:"请填写玩家说明...",__source:{fileName:k,lineNumber:180,columnNumber:19}}))))),w.a.createElement(C,{__source:{fileName:k,lineNumber:185,columnNumber:11}},w.a.createElement(D,{xs:24,sm:12,md:12,lg:8,xl:8,xxl:8,__source:{fileName:k,lineNumber:186,columnNumber:13}},w.a.createElement("div",{__source:{fileName:k,lineNumber:187,columnNumber:15}},w.a.createElement(R,{label:"剧本标签",field:"gb_text_tag_arr",rules:[{required:!0,message:"请选择剧本标签"}],__source:{fileName:k,lineNumber:188,columnNumber:17}},w.a.createElement(b.a,{mode:"multiple",allowClear:!0,placeholder:"请选择剧本标签",__source:{fileName:k,lineNumber:193,columnNumber:19}},V.map((function(e){return w.a.createElement(b.a.Option,{key:e.label_value,value:e.label_value,__source:{fileName:k,lineNumber:196,columnNumber:25}},e.label_zh)})))))),w.a.createElement(D,{xs:24,sm:12,md:12,lg:8,xl:8,xxl:8,__source:{fileName:k,lineNumber:205,columnNumber:13}},w.a.createElement("div",{__source:{fileName:k,lineNumber:206,columnNumber:15}},w.a.createElement(R,{label:"剧本时长/小时",field:"gb_hour",rules:[{type:"number",required:!0}],__source:{fileName:k,lineNumber:207,columnNumber:17}},w.a.createElement(s.a,{min:1,placeholder:"请输入参考价格",__source:{fileName:k,lineNumber:212,columnNumber:19}})))),w.a.createElement(D,{xs:24,sm:12,md:12,lg:8,xl:8,xxl:8,__source:{fileName:k,lineNumber:216,columnNumber:13}},w.a.createElement("div",{__source:{fileName:k,lineNumber:217,columnNumber:15}},w.a.createElement(R,{label:"工作日价格",field:"gb_price",rules:[{type:"number",required:!0}],__source:{fileName:k,lineNumber:218,columnNumber:17}},w.a.createElement(s.a,{min:1,placeholder:"请输入工作日价格",__source:{fileName:k,lineNumber:223,columnNumber:19}}))))),w.a.createElement(C,{__source:{fileName:k,lineNumber:228,columnNumber:11}},w.a.createElement(D,{xs:24,sm:12,md:12,lg:8,xl:8,xxl:8,__source:{fileName:k,lineNumber:229,columnNumber:13}},w.a.createElement("div",{__source:{fileName:k,lineNumber:230,columnNumber:15}},w.a.createElement(R,{label:"周末价格",field:"gb_price2",rules:[{type:"number",required:!0}],__source:{fileName:k,lineNumber:231,columnNumber:17}},w.a.createElement(s.a,{min:1,placeholder:"请输入工作日价格",__source:{fileName:k,lineNumber:236,columnNumber:19}})))),w.a.createElement(D,{xs:24,sm:12,md:12,lg:8,xl:8,xxl:8,__source:{fileName:k,lineNumber:240,columnNumber:13}},w.a.createElement("div",{__source:{fileName:k,lineNumber:241,columnNumber:15}},w.a.createElement(R,{label:"推荐星级",field:"gb_star_lev",rules:[{required:!0,type:"number"}],__source:{fileName:k,lineNumber:242,columnNumber:17}},w.a.createElement(o.a,{allowHalf:!0,__source:{fileName:k,lineNumber:252,columnNumber:19}})))),w.a.createElement(D,{xs:24,sm:12,md:12,lg:8,xl:8,xxl:8,__source:{fileName:k,lineNumber:256,columnNumber:13}},w.a.createElement("div",{__source:{fileName:k,lineNumber:257,columnNumber:15}},w.a.createElement(R,{label:"上架时间",field:"gb_add_time",rules:[{required:!1,message:"gb_add_time is required"}],__source:{fileName:k,lineNumber:258,columnNumber:17}},w.a.createElement(i.a,{showTime:!0,__source:{fileName:k,lineNumber:268,columnNumber:19}}))))),w.a.createElement(C,{__source:{fileName:k,lineNumber:273,columnNumber:11}},w.a.createElement(D,{xs:24,sm:12,md:12,lg:8,xl:8,xxl:8,__source:{fileName:k,lineNumber:274,columnNumber:13}},w.a.createElement("div",{__source:{fileName:k,lineNumber:275,columnNumber:15}},w.a.createElement(R,{label:"剧本概要",field:"gb_text_brief",rules:[{required:!0,message:"请填写剧本概要"}],__source:{fileName:k,lineNumber:276,columnNumber:17}},w.a.createElement(N.a.TextArea,{rows:5,placeholder:"请填写剧本概要...",__source:{fileName:k,lineNumber:281,columnNumber:19}})))),w.a.createElement(D,{xs:24,sm:12,md:12,lg:8,xl:8,xxl:8,__source:{fileName:k,lineNumber:285,columnNumber:13}},w.a.createElement("div",{__source:{fileName:k,lineNumber:286,columnNumber:15}},w.a.createElement(R,{label:"剧本描述",field:"gb_text_content",rules:[{required:!1,message:"请填写剧本描述"}],__source:{fileName:k,lineNumber:287,columnNumber:17}},w.a.createElement(N.a.TextArea,{rows:5,placeholder:"请填写剧本描述...",__source:{fileName:k,lineNumber:292,columnNumber:19}})))),w.a.createElement(D,{xs:24,sm:12,md:12,lg:8,xl:8,xxl:8,__source:{fileName:k,lineNumber:296,columnNumber:13}},w.a.createElement(R,{label:"版权信息",field:"gb_producer",rules:[{required:!0,message:"请填写版权信息"}],__source:{fileName:k,lineNumber:297,columnNumber:15}},w.a.createElement(N.a.TextArea,{rows:5,placeholder:"请填写版权信息...",__source:{fileName:k,lineNumber:302,columnNumber:17}})))),w.a.createElement(C,{__source:{fileName:k,lineNumber:306,columnNumber:11}},w.a.createElement(D,{xs:24,sm:12,md:12,lg:8,xl:8,xxl:8,__source:{fileName:k,lineNumber:307,columnNumber:13}},w.a.createElement(R,{label:"是否新本",field:"is_new",rules:[{required:!1,message:"是否新本"}],__source:{fileName:k,lineNumber:308,columnNumber:15}},w.a.createElement(b.a,{placeholder:"是否新本",__source:{fileName:k,lineNumber:313,columnNumber:17}},w.a.createElement(b.a.Option,{value:1,__source:{fileName:k,lineNumber:314,columnNumber:19}},"是"),w.a.createElement(b.a.Option,{value:0,__source:{fileName:k,lineNumber:315,columnNumber:19}},"否")))),w.a.createElement(D,{xs:24,sm:12,md:12,lg:8,xl:8,xxl:8,__source:{fileName:k,lineNumber:319,columnNumber:13}},w.a.createElement(R,{label:"是否热门",field:"is_hot",rules:[{required:!1,message:"是否热门"}],__source:{fileName:k,lineNumber:320,columnNumber:15}},w.a.createElement(b.a,{placeholder:"是否热门",__source:{fileName:k,lineNumber:325,columnNumber:17}},w.a.createElement(b.a.Option,{value:1,__source:{fileName:k,lineNumber:326,columnNumber:19}},"是"),w.a.createElement(b.a.Option,{value:0,__source:{fileName:k,lineNumber:327,columnNumber:19}},"否")))),w.a.createElement(D,{xs:24,sm:12,md:12,lg:8,xl:8,xxl:8,__source:{fileName:k,lineNumber:331,columnNumber:13}},w.a.createElement(R,{label:"备注说明",field:"gb_remarks",rules:[{required:!1,message:"请填写备注说明"}],__source:{fileName:k,lineNumber:332,columnNumber:15}},w.a.createElement(N.a,{placeholder:"请填写备注说明...",__source:{fileName:k,lineNumber:337,columnNumber:17}})))),w.a.createElement(C,{__source:{fileName:k,lineNumber:341,columnNumber:11}},w.a.createElement(D,{xs:24,sm:12,md:12,lg:8,xl:8,xxl:8,__source:{fileName:k,lineNumber:342,columnNumber:13}},w.a.createElement(v.a.Item,{rules:[{required:!0,message:"请上传剧本封面"}],label:"剧本封面",field:"gb_cover",triggerPropName:"fileList",__source:{fileName:k,lineNumber:343,columnNumber:15}},w.a.createElement(t.a,{limit:1,name:"gb_cover",customRequest:function(e){var l=e.onProgress,r=e.onError,m=e.onSuccess,a=e.file,u=new XMLHttpRequest;u.upload&&(u.upload.onprogress=function(e){var r;e.total>0&&(r=e.loaded/e.total*100),l(parseInt(r,10),e)}),u.onerror=function(e){r(e)},u.onload=function(){u.status<200||u.status,m(JSON.parse(u.responseText))};var n=new FormData;n.append("up_file",a),n.append("module","drama"),u.open("post","https://gbs.toptian.com/system/upload/image",!0),u.setRequestHeader("Authorization",localStorage.getItem("token")),u.send(n)},onPreview:function(e){c.a.info({title:"Preview",content:w.a.createElement("img",{src:e.url||URL.createObjectURL(e.originFile),style:{maxWidth:"100%"},__source:{fileName:k,lineNumber:385,columnNumber:25}})})},__source:{fileName:k,lineNumber:349,columnNumber:17}})))),w.a.createElement(C,{__source:{fileName:k,lineNumber:396,columnNumber:11}},w.a.createElement(D,{style:{display:"flex",alignItems:"center",justifyContent:"center"},span:24,__source:{fileName:k,lineNumber:397,columnNumber:13}},w.a.createElement("div",{__source:{fileName:k,lineNumber:401,columnNumber:15}},w.a.createElement(R,{__source:{fileName:k,lineNumber:402,columnNumber:17}},w.a.createElement(a.a,{__source:{fileName:k,lineNumber:403,columnNumber:19}}," ",w.a.createElement(u.a,{onClick:p()(O.a.mark((function e(){var l;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!f.current){e.next=22;break}return e.prev=1,e.next=4,f.current.validate();case 4:if((l=f.current.getFields()).gb_cover=l.gb_cover[0].url||l.gb_cover[0].response.data.file_url,"edit"!==r){e.next=12;break}return e.next=9,Object(q.q)(l);case 9:return 200===e.sent.code&&(n.a.success("修改成功"),_()),e.abrupt("return");case 12:return l.gb_star_lev=2*l.gb_star_lev,e.next=15,Object(q.h)(l);case 15:200===e.sent.code&&(n.a.success("添加成功"),_()),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(1),n.a.error("校验失败，请检查字段！");case 22:case"end":return e.stop()}}),e,null,[[1,19]])}))),type:"primary",__source:{fileName:k,lineNumber:405,columnNumber:21}},"提交"),w.a.createElement(u.a,{onClick:function(){f.current.resetFields()},__source:{fileName:k,lineNumber:437,columnNumber:21}},"重置")))))))))}}}]);