(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{159:function(e,r,l){"use strict";l.r(r);l(154);var a=l(74),m=(l(153),l(82)),u=(l(64),l(24)),n=(l(110),l(45)),t=l(65),c=l.n(t),o=(l(639),l(640)),i=(l(317),l(237)),s=(l(236),l(95)),N=(l(111),l(39)),b=l(22),_=l.n(b),d=(l(238),l(155)),f=(l(235),l(73)),p=l(44),E=l.n(p),g=l(0),x=l.n(g),v=l(234),h="/Users/mrhh/Desktop/gbs-admin/src/pages/stocks-drama/DramaDetail/roleDetail/AddRoleDetailForm/index.tsx",w=f.a.Item,k=d.a.Row,y=d.a.Col;r.default=function(e){var r=e.clickItem,l=e.modalType,t=e.getInitFormData,b=e.saveEditItem,d=e.closeModal,p=e.role_array,I=Object(g.useRef)(),O=Object(g.useState)(""),q=_()(O,2),F=q[0],R=q[1];return Object(g.useEffect)((function(){"edit"===l&&(R(b.role_cover),I.current.setFieldsValue(b))}),[]),x.a.createElement(a.a,{style:{width:"100%"},__source:{fileName:h,lineNumber:43,columnNumber:5}},x.a.createElement("div",{__source:{fileName:h,lineNumber:44,columnNumber:7}},x.a.createElement(f.a,{ref:I,onValuesChange:function(e,r){console.log("onValuesChange: ",e,r)},scrollToFirstError:!0,__source:{fileName:h,lineNumber:45,columnNumber:9}},x.a.createElement(k,{className:"grid-demo",style:{marginBottom:10},__source:{fileName:h,lineNumber:46,columnNumber:11}},x.a.createElement(y,{xs:24,sm:24,md:24,lg:24,xl:24,xxl:24,__source:{fileName:h,lineNumber:47,columnNumber:13}},x.a.createElement("div",{__source:{fileName:h,lineNumber:48,columnNumber:15}},x.a.createElement(w,{label:"角色名称",field:"role_name",rules:[{required:!0,message:"请填写角色名称"}],__source:{fileName:h,lineNumber:49,columnNumber:17}},x.a.createElement(N.a,{placeholder:"请填写角色名称...",__source:{fileName:h,lineNumber:54,columnNumber:19}})))),x.a.createElement(y,{xs:24,sm:24,md:24,lg:24,xl:24,xxl:24,__source:{fileName:h,lineNumber:58,columnNumber:13}},x.a.createElement("div",{__source:{fileName:h,lineNumber:59,columnNumber:15}},x.a.createElement(w,{label:"角色简介",field:"role_brief",rules:[{required:!0,message:"请填写角色简介"}],__source:{fileName:h,lineNumber:60,columnNumber:17}},x.a.createElement(N.a,{placeholder:"请填写角色简介...",__source:{fileName:h,lineNumber:65,columnNumber:19}}))))),x.a.createElement(k,{__source:{fileName:h,lineNumber:70,columnNumber:11}},x.a.createElement(y,{xs:24,sm:24,md:24,lg:24,xl:24,xxl:24,__source:{fileName:h,lineNumber:71,columnNumber:13}},x.a.createElement("div",{__source:{fileName:h,lineNumber:72,columnNumber:15}},x.a.createElement(w,{label:"是否凶手",field:"is_murderer",rules:[{required:!1,message:"请选择是否凶手"}],__source:{fileName:h,lineNumber:73,columnNumber:17}},x.a.createElement(s.a,{placeholder:"请选择是否凶手",__source:{fileName:h,lineNumber:78,columnNumber:19}},x.a.createElement(s.a.Option,{value:"1",__source:{fileName:h,lineNumber:79,columnNumber:21}},"是"),x.a.createElement(s.a.Option,{value:"0",__source:{fileName:h,lineNumber:80,columnNumber:21}},"否"))))),x.a.createElement(y,{xs:24,sm:24,md:24,lg:24,xl:24,xxl:24,__source:{fileName:h,lineNumber:85,columnNumber:13}},x.a.createElement("div",{__source:{fileName:h,lineNumber:86,columnNumber:15}},x.a.createElement(w,{label:"角色备注",field:"role_remarks",rules:[{required:!1,message:"请填写角色备注"}],__source:{fileName:h,lineNumber:87,columnNumber:17}},x.a.createElement(N.a,{placeholder:"请填写角色备注...",__source:{fileName:h,lineNumber:92,columnNumber:19}}))))),x.a.createElement(k,{__source:{fileName:h,lineNumber:97,columnNumber:11}},x.a.createElement(y,{xs:24,sm:24,md:24,lg:24,xl:24,xxl:24,__source:{fileName:h,lineNumber:98,columnNumber:13}},x.a.createElement(f.a.Item,{rules:[{required:!0,message:"请上传角色封面"}],label:"角色封面",field:"role_cover",triggerPropName:"fileList",__source:{fileName:h,lineNumber:99,columnNumber:15}},x.a.createElement(o.a,{limit:1,renderUploadList:function(){return null},name:"role_cover",customRequest:function(e){var r=e.onProgress,l=e.onError,a=e.onSuccess,m=e.file,u=new XMLHttpRequest;u.upload&&(u.upload.onprogress=function(e){var l;e.total>0&&(l=e.loaded/e.total*100),r(parseInt(l,10),e)}),u.onerror=function(e){l(e)},u.onload=function(){u.status<200||u.status;var e=JSON.parse(u.responseText);R(e.data.file_url),a(e)};var n=new FormData;n.append("up_file",m),n.append("module","drama"),u.open("post","https://gbs.toptian.com/system/upload/image",!0),u.setRequestHeader("Authorization",localStorage.getItem("token")),u.send(n)},onPreview:function(e){i.a.info({title:"Preview",content:x.a.createElement("img",{src:e.url||URL.createObjectURL(e.originFile),style:{maxWidth:"100%"},__source:{fileName:h,lineNumber:143,columnNumber:25}})})},__source:{fileName:h,lineNumber:105,columnNumber:17}})))),""===F?null:x.a.createElement(k,{__source:{fileName:h,lineNumber:155,columnNumber:13}},x.a.createElement(f.a.Item,{label:"封面图片",__source:{fileName:h,lineNumber:156,columnNumber:15}},x.a.createElement("img",{style:{width:212,height:300},src:F,alt:"",__source:{fileName:h,lineNumber:157,columnNumber:17}}))),x.a.createElement(k,{__source:{fileName:h,lineNumber:162,columnNumber:11}},x.a.createElement(y,{style:{display:"flex",alignItems:"center",justifyContent:"center"},__source:{fileName:h,lineNumber:163,columnNumber:13}},x.a.createElement("div",{__source:{fileName:h,lineNumber:164,columnNumber:15}},x.a.createElement(w,{__source:{fileName:h,lineNumber:165,columnNumber:17}},x.a.createElement(m.a,{__source:{fileName:h,lineNumber:166,columnNumber:19}},x.a.createElement(u.a,{onClick:c()(E.a.mark((function e(){var a,m,u,c;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!I.current){e.next=30;break}return e.prev=1,e.next=4,I.current.validate();case 4:if((a=I.current.getFields()).role_cover=F,console.log("param",a),m=p.map((function(e){return e.role_code===a.role_code?a:e})),"add"!==l){e.next=17;break}return p.push(a),(u={}).role_array=p,u.gb_code=r.gb_code,e.next=15,Object(v.w)(u);case 15:200===e.sent.code&&(n.a.success("添加成功"),t(),d());case 17:if("edit"!==l){e.next=25;break}return(c={}).role_array=m,c.gb_code=r.gb_code,e.next=23,Object(v.w)(c);case 23:200===e.sent.code&&(n.a.success("修改成功"),t(),d());case 25:e.next=30;break;case 27:e.prev=27,e.t0=e.catch(1),n.a.error("校验失败，请检查字段！");case 30:case"end":return e.stop()}}),e,null,[[1,27]])}))),type:"primary",__source:{fileName:h,lineNumber:167,columnNumber:21}},"提交"),x.a.createElement(u.a,{onClick:function(){I.current.resetFields()},__source:{fileName:h,lineNumber:217,columnNumber:21}},"重置")))))))))}}}]);