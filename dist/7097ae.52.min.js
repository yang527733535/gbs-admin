(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{188:function(e,r,n){"use strict";n.r(r);n(112);var t=n(40),a=n(5),l=n.n(a),c=(n(156),n(82)),u=(n(65),n(24)),o=n(687),m=(n(113),n(41)),i=(n(336),n(256)),s=(n(155),n(74)),b=(n(253),n(96)),f=(n(175),n(85)),N=n(56),_=n.n(N),d=n(22),p=n.n(d),g=(n(252),n(73)),h=n(35),v=n.n(h),y=n(0),E=n.n(y),O=n(167),j=n.n(O),w=n(111),k=n(83),S="/Users/mrhh/Desktop/gbs-admin/src/pages/store-game/form/index.jsx",x=g.a.Item,C={labelCol:{span:7},wrapperCol:{span:17}},I={wrapperCol:{span:17,offset:7}};r.default=function(e){var r=e.closeModalAndReqTable,n=e.clickItem,a=Object(y.useRef)(),N=Object(y.useState)([]),d=p()(N,2),h=d[0],O=d[1],q=Object(y.useState)(!0),F=p()(q,2),D=F[0],P=F[1],R=Object(y.useState)([]),V=p()(R,2),z=(V[0],V[1]),L=Object(y.useState)([]),A=p()(L,2),H=A[0],M=A[1],J=Object(y.useState)(localStorage.getItem("nowshop")),T=p()(J,2),W=T[0],B=T[1],Q=Object(y.useState)([]),U=p()(Q,2),G=U[0],K=U[1],X=Object(y.useState)(!1),Y=p()(X,2),Z=Y[0],$=Y[1],ee=Object(y.useState)([]),re=p()(ee,2),ne=re[0],te=re[1],ae=Object(y.useState)(!1),le=p()(ae,2),ce=le[0],ue=le[1],oe=Object(y.useState)(""),me=p()(oe,2),ie=me[0],se=me[1],be=Object(y.useState)(""),fe=p()(be,2),Ne=fe[0],_e=fe[1],de=Object(y.useState)([]),pe=p()(de,2),ge=pe[0],he=pe[1],ve=Object(y.useState)(!1),ye=p()(ve,2),Ee=ye[0],Oe=ye[1],je=Object(y.useRef)(null);Object(y.useEffect)((function(){Object(w.y)().then((function(e){var r,n=e.data;r=n.map((function(e){return function e(r){var n=Array.isArray(r.region_children)&&r.region_children.length>0;return{key:String(r.region_id),value:String(r.region_id),label:r.region_name,children:n?r.region_children.map((function(r){return e(r)})):[]}}(e)})),z(r)}))}),[]);var we=function(){var e=_()(v.a.mark((function e(){var r,n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(w.Q)();case 2:r=e.sent,n=r.data,P(!1),O(n);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(y.useEffect)((function(){we()}),[]),Object(y.useEffect)((function(){a.current.setFieldsValue({store_code:localStorage.getItem("nowshop")})}),[]);var ke=Object(y.useCallback)(j()((function(e){je.current=Date.now(),$(!0),K([]);var r={gb_title:e};Object(w.q)(r).then((function(e){var r=e.data.map((function(e){return{label:E.a.createElement("div",{style:{display:"flex",alignItems:"center"},__source:{fileName:S,lineNumber:117,columnNumber:13}},E.a.createElement(f.a,{shape:"square",size:24,style:{marginLeft:6,marginRight:12},__source:{fileName:S,lineNumber:118,columnNumber:15}},E.a.createElement("img",{alt:"avatar",src:e.gb_cover,__source:{fileName:S,lineNumber:119,columnNumber:17}})),"".concat(e.gb_title)),value:e.gb_code}}));$(!1),K(r)}))}),500),[]),Se=Object(y.useCallback)(j()((function(e){je.current=Date.now(),ue(!0),K([]);var r={user_nick:e};Object(k.c)(r).then((function(e){var r=e.data.map((function(e){return{label:E.a.createElement("div",{style:{display:"flex",alignItems:"center"},__source:{fileName:S,lineNumber:142,columnNumber:13}},E.a.createElement(f.a,{size:24,style:{marginLeft:6,marginRight:12},__source:{fileName:S,lineNumber:143,columnNumber:15}},E.a.createElement("img",{alt:"avatar",src:e.user_photo,__source:{fileName:S,lineNumber:144,columnNumber:17}})),"".concat(e.user_nick)),value:e.user_account}}));ue(!1),te(r)}))}),500),[]),xe=Object(y.useCallback)(j()((function(e){je.current=Date.now(),$(!0),K([]);var r={member_name:e};Object(k.f)(r).then((function(e){console.log("data: ",e);var r=e.data.map((function(e){return{label:E.a.createElement("div",{style:{display:"flex",alignItems:"center"},__source:{fileName:S,lineNumber:168,columnNumber:13}},E.a.createElement(f.a,{size:24,style:{marginLeft:6,marginRight:12},__source:{fileName:S,lineNumber:169,columnNumber:15}},E.a.createElement("img",{alt:"avatar",src:e.member_face,__source:{fileName:S,lineNumber:170,columnNumber:17}})),"".concat(e.member_name)),value:e.member_account}}));Oe(!1),console.log("options",r),he(r)}))}),500),[]);Object(y.useEffect)((function(){ke(),xe(),Se()}),[]);var Ce=function(){var e=_()(v.a.mark((function e(){var r,n,t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={store_code:W},e.next=3,Object(w.g)(r);case 3:n=e.sent,t=n.data.store_room,M(t);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(y.useEffect)((function(){Ce()}),[W]),E.a.createElement("div",{style:{maxWidth:650},__source:{fileName:S,lineNumber:205,columnNumber:5}},E.a.createElement(g.a,l()({ref:a},C,{size:"default",onSubmit:function(e){console.log(e)},onValuesChange:function(e,r){console.log("onValuesChange: ",e,r)},scrollToFirstError:!0,__source:{fileName:S,lineNumber:206,columnNumber:7}}),E.a.createElement(x,{label:"选择店铺",field:"store_code",rules:[{required:!0,message:"请填写店铺编码"}],__source:{fileName:S,lineNumber:216,columnNumber:9}},E.a.createElement(b.a,{onChange:function(){var e=_()(v.a.mark((function e(r){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:B(r);case 1:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),loading:D,placeholder:"请选择店铺",__source:{fileName:S,lineNumber:221,columnNumber:11}},null==h?void 0:h.map((function(e){return E.a.createElement(b.a.Option,{key:e.store_code,value:e.store_code,__source:{fileName:S,lineNumber:230,columnNumber:17}},e.store_name)})))),E.a.createElement(x,{label:"选择房间",field:"room_code",rules:[{required:!0,message:"请填写店铺编码"}],__source:{fileName:S,lineNumber:237,columnNumber:9}},E.a.createElement(b.a,{placeholder:"请选择房间",__source:{fileName:S,lineNumber:242,columnNumber:11}},H.map((function(e){return E.a.createElement(b.a.Option,{key:e.room_code,value:e.room_code,__source:{fileName:S,lineNumber:245,columnNumber:17}},e.room_name)})))),E.a.createElement(x,{label:"剧本",field:"gb_code",rules:[{required:!0,message:"请选择剧本"}],__source:{fileName:S,lineNumber:253,columnNumber:9}},E.a.createElement(b.a,{onChange:function(){var e=_()(v.a.mark((function e(r){var n,t,l,c,u;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={gb_code:r,store_code:W},e.next=3,Object(w.u)(n);case 3:t=e.sent,l=t.data,c=l.gb_price,u=l.gb_price2,se(c),_e(u),a.current.setFieldsValue({gb_price:0===l.is_leisure?l.gb_price:l.gb_price2}),console.log("data: ",l);case 10:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),style:{width:345},options:G,placeholder:"请输入要搜索的剧本",filterOption:!1,renderFormat:function(e){return e.children.props.children[1]},notFoundContent:Z?E.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},__source:{fileName:S,lineNumber:283,columnNumber:17}},E.a.createElement(s.a,{style:{margin:12},__source:{fileName:S,lineNumber:284,columnNumber:19}})):null,showSearch:!0,onSearch:ke,__source:{fileName:S,lineNumber:254,columnNumber:11}})),ie&&E.a.createElement(x,{label:"参考价格",__source:{fileName:S,lineNumber:293,columnNumber:11}},E.a.createElement("span",{__source:{fileName:S,lineNumber:294,columnNumber:13}},"工作日:¥",ie),"    ",E.a.createElement("span",{__source:{fileName:S,lineNumber:295,columnNumber:13}},"周末:¥",Ne)),E.a.createElement(x,{label:"剧本价格",field:"gb_price",rules:[{required:!0,message:"请填写剧本价格"}],__source:{fileName:S,lineNumber:299,columnNumber:9}},E.a.createElement(i.a,{min:0,placeholder:"请填写剧本价格...",__source:{fileName:S,lineNumber:304,columnNumber:11}})),E.a.createElement(x,{label:"玩家人数",field:"game_people",rules:[{required:!0,message:"请填写玩家人数"}],__source:{fileName:S,lineNumber:307,columnNumber:9}},E.a.createElement(i.a,{min:1,placeholder:"请填写玩家人数...",__source:{fileName:S,lineNumber:312,columnNumber:11}})),E.a.createElement(x,{label:"主持人",field:"dm_user",rules:[{required:!0,message:"请填写主持人"}],__source:{fileName:S,lineNumber:314,columnNumber:9}},E.a.createElement(b.a,{style:{width:345},options:ne,placeholder:"请选择主持人",filterOption:!1,renderFormat:function(e){return e.children.props.children[1]},notFoundContent:ce?E.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},__source:{fileName:S,lineNumber:329,columnNumber:17}},E.a.createElement(s.a,{style:{margin:12},__source:{fileName:S,lineNumber:330,columnNumber:19}})):null,showSearch:!0,onSearch:Se,__source:{fileName:S,lineNumber:319,columnNumber:11}})),E.a.createElement(g.a.List,{field:"game_player",__source:{fileName:S,lineNumber:339,columnNumber:9}},(function(e,r){var n=r.add,t=r.remove;r.move;return E.a.createElement("div",{__source:{fileName:S,lineNumber:342,columnNumber:15}},e.map((function(e,r){return E.a.createElement("div",{key:e.key,__source:{fileName:S,lineNumber:345,columnNumber:21}},E.a.createElement(g.a.Item,{label:"玩家".concat(1+r),__source:{fileName:S,lineNumber:346,columnNumber:23}},E.a.createElement(c.a,{__source:{fileName:S,lineNumber:347,columnNumber:25}},E.a.createElement(g.a.Item,{field:"".concat(e.field,".player_user"),rules:[{required:!0}],noStyle:!0,__source:{fileName:S,lineNumber:348,columnNumber:27}},E.a.createElement(b.a,{style:{width:145},options:ge,placeholder:"请选择玩家",filterOption:!1,renderFormat:function(e){return e.children.props.children[1]},notFoundContent:Ee?E.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},__source:{fileName:S,lineNumber:363,columnNumber:35}},E.a.createElement(s.a,{style:{margin:12},__source:{fileName:S,lineNumber:370,columnNumber:37}})):null,showSearch:!0,onSearch:xe,__source:{fileName:S,lineNumber:353,columnNumber:29}})),E.a.createElement(g.a.Item,{field:"".concat(e.field,".player_type"),rules:[{required:!0}],noStyle:!0,__source:{fileName:S,lineNumber:378,columnNumber:27}},E.a.createElement(b.a,{placeholder:"玩家类型",__source:{fileName:S,lineNumber:383,columnNumber:29}},E.a.createElement(b.a.Option,{value:"player",__source:{fileName:S,lineNumber:384,columnNumber:31}},"player"),E.a.createElement(b.a.Option,{value:"worker",__source:{fileName:S,lineNumber:385,columnNumber:31}},"worker"))),E.a.createElement(g.a.Item,{field:"".concat(e.field,".player_name"),rules:[{required:!0}],noStyle:!0,__source:{fileName:S,lineNumber:389,columnNumber:27}},E.a.createElement(m.a,{placeholder:"玩家名称",__source:{fileName:S,lineNumber:394,columnNumber:29}})),E.a.createElement(g.a.Item,{field:"".concat(e.field,".player_note"),rules:[{required:!0}],noStyle:!0,__source:{fileName:S,lineNumber:396,columnNumber:27}},E.a.createElement(m.a,{placeholder:"玩家备注",__source:{fileName:S,lineNumber:401,columnNumber:29}})),E.a.createElement(u.a,{icon:E.a.createElement(o.a,{__source:{fileName:S,lineNumber:404,columnNumber:35}}),shape:"circle",status:"danger",onClick:function(){return t(r)},__source:{fileName:S,lineNumber:403,columnNumber:27}}))))})),E.a.createElement(g.a.Item,l()({},I,{__source:{fileName:S,lineNumber:414,columnNumber:17}}),E.a.createElement(u.a,{onClick:function(){n()},__source:{fileName:S,lineNumber:415,columnNumber:19}},"添加玩家")))})),E.a.createElement(x,l()({},I,{__source:{fileName:S,lineNumber:441,columnNumber:9}}),E.a.createElement(u.a,{onClick:_()(v.a.mark((function e(){var l,c,u;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.current){e.next=26;break}return e.prev=1,e.next=4,a.current.validate();case 4:if(null!==n){e.next=12;break}return null!==(l=a.current.getFields()).game_player&&void 0!==l.game_player||(l.game_player=[]),e.next=9,Object(w.i)(l);case 9:c=e.sent,e.next=18;break;case 12:return u=a.current.getFields(),console.log("param: ",u),u.store_code=n.store_code,e.next=17,Object(w.S)(u);case 17:c=e.sent;case 18:200===c.code&&(t.a.success("添加成功"),r()),e.next=26;break;case 21:e.prev=21,e.t0=e.catch(1),console.log(e.t0),console.log(a.current.getFieldsError()),t.a.error("校验失败，请检查字段！");case 26:case"end":return e.stop()}}),e,null,[[1,21]])}))),type:"primary",style:{marginRight:24},__source:{fileName:S,lineNumber:442,columnNumber:11}},"提交"),E.a.createElement(u.a,{onClick:function(){a.current.resetFields()},__source:{fileName:S,lineNumber:476,columnNumber:11}},"重置"))))}},687:function(e,r,n){"use strict";var t=n(5),a=n.n(t),l=n(4),c=n.n(l),u=n(0),o=n.n(u),m=n(6);function i(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function s(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?i(Object(n),!0).forEach((function(r){c()(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}function b(e,r){var n=Object(u.useContext)(m.a).prefixCls,t=e.spin,l=e.className,c=s(s({ref:r},e),{},{className:"".concat(l?l+" ":"").concat(n,"-icon ").concat(n,"-icon-delete")});return t&&(c.className="".concat(c.className," ").concat(n,"-icon-loading")),delete c.spin,delete c.isIcon,o.a.createElement("svg",a()({fill:"none",stroke:"currentColor",strokeWidth:"4",viewBox:"0 0 48 48",width:"1em",height:"1em"},c),o.a.createElement("path",{d:"M5 11h5.5m0 0v29a1 1 0 0 0 1 1h25a1 1 0 0 0 1-1V11m-27 0H16m21.5 0H43m-5.5 0H32m-16 0V7h16v4m-16 0h16M20 18v15m8-15v15"}))}var f=o.a.forwardRef(b);f.defaultProps={isIcon:!0},f.displayName="IconDelete",r.a=f}}]);